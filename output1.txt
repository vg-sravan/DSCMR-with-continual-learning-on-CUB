PyTorch Version:  1.5.0
Torchvision Version:  0.6.0a0+82fd1c8
Datasets creating.........
split_boundaries: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200]
{'1': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], '2': [11, 12, 13, 14, 15, 16, 17, 18, 19, 20], '3': [21, 22, 23, 24, 25, 26, 27, 28, 29, 30], '4': [31, 32, 33, 34, 35, 36, 37, 38, 39, 40], '5': [41, 42, 43, 44, 45, 46, 47, 48, 49, 50], '6': [51, 52, 53, 54, 55, 56, 57, 58, 59, 60], '7': [61, 62, 63, 64, 65, 66, 67, 68, 69, 70], '8': [71, 72, 73, 74, 75, 76, 77, 78, 79, 80], '9': [81, 82, 83, 84, 85, 86, 87, 88, 89, 90], '10': [91, 92, 93, 94, 95, 96, 97, 98, 99, 100], '11': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110], '12': [111, 112, 113, 114, 115, 116, 117, 118, 119, 120], '13': [121, 122, 123, 124, 125, 126, 127, 128, 129, 130], '14': [131, 132, 133, 134, 135, 136, 137, 138, 139, 140], '15': [141, 142, 143, 144, 145, 146, 147, 148, 149, 150], '16': [151, 152, 153, 154, 155, 156, 157, 158, 159, 160], '17': [161, 162, 163, 164, 165, 166, 167, 168, 169, 170], '18': [171, 172, 173, 174, 175, 176, 177, 178, 179, 180], '19': [181, 182, 183, 184, 185, 186, 187, 188, 189, 190], '20': [191, 192, 193, 194, 195, 196, 197, 198, 199, 200]}
Datasets created.........
Getting parameters............
Got parameters................
Creating Model....... and setting up
Created Model.......and setup
..........................Training is beginning..............................
Selected dataset for training is 1..........
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Training for dataset 1 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.02522935779816514 and Accuracy for txts = 0.0 
train Loss: 0.0428 Img2Txt: 0.2643  Txt2Img: 0.1870
test
Accuracy for imgs = 0.11320754716981132 and Accuracy for txts = 0.3584905660377358 
test Loss: 0.0394 Img2Txt: 0.2911  Txt2Img: 0.2082

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.05045871559633028 and Accuracy for txts = 0.16972477064220184 
train Loss: 0.0377 Img2Txt: 0.4249  Txt2Img: 0.3217
test
Accuracy for imgs = 0.4150943396226415 and Accuracy for txts = 0.49056603773584906 
test Loss: 0.0352 Img2Txt: 0.4731  Txt2Img: 0.3582

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.26146788990825687 and Accuracy for txts = 0.3532110091743119 
train Loss: 0.0345 Img2Txt: 0.4761  Txt2Img: 0.4959
test
Accuracy for imgs = 0.4245283018867924 and Accuracy for txts = 0.5377358490566038 
test Loss: 0.0334 Img2Txt: 0.5356  Txt2Img: 0.5007

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.35091743119266056 and Accuracy for txts = 0.4357798165137615 
train Loss: 0.0327 Img2Txt: 0.5144  Txt2Img: 0.5580
test
Accuracy for imgs = 0.4528301886792453 and Accuracy for txts = 0.5377358490566038 
test Loss: 0.0319 Img2Txt: 0.5652  Txt2Img: 0.5638

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.4174311926605505 and Accuracy for txts = 0.48623853211009177 
train Loss: 0.0310 Img2Txt: 0.5381  Txt2Img: 0.5869
test
Accuracy for imgs = 0.49056603773584906 and Accuracy for txts = 0.6037735849056604 
test Loss: 0.0307 Img2Txt: 0.5990  Txt2Img: 0.6107

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.5068807339449541 and Accuracy for txts = 0.5389908256880734 
train Loss: 0.0297 Img2Txt: 0.5713  Txt2Img: 0.6175
test
Accuracy for imgs = 0.6037735849056604 and Accuracy for txts = 0.6226415094339622 
test Loss: 0.0298 Img2Txt: 0.6186  Txt2Img: 0.6381

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.5596330275229358 and Accuracy for txts = 0.6032110091743119 
train Loss: 0.0283 Img2Txt: 0.5991  Txt2Img: 0.6379
test
Accuracy for imgs = 0.6792452830188679 and Accuracy for txts = 0.6415094339622641 
test Loss: 0.0292 Img2Txt: 0.6440  Txt2Img: 0.6631

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.6605504587155964 and Accuracy for txts = 0.6215596330275229 
train Loss: 0.0270 Img2Txt: 0.6432  Txt2Img: 0.6615
test
Accuracy for imgs = 0.6981132075471698 and Accuracy for txts = 0.6886792452830188 
test Loss: 0.0285 Img2Txt: 0.6783  Txt2Img: 0.6880

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.7201834862385321 and Accuracy for txts = 0.6307339449541285 
train Loss: 0.0258 Img2Txt: 0.6601  Txt2Img: 0.6857
test
Accuracy for imgs = 0.7264150943396226 and Accuracy for txts = 0.7452830188679245 
test Loss: 0.0280 Img2Txt: 0.6873  Txt2Img: 0.6958

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.7798165137614679 and Accuracy for txts = 0.6697247706422018 
train Loss: 0.0248 Img2Txt: 0.6821  Txt2Img: 0.6973
test
Accuracy for imgs = 0.7452830188679245 and Accuracy for txts = 0.7358490566037735 
test Loss: 0.0277 Img2Txt: 0.7190  Txt2Img: 0.7125

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8394495412844037 and Accuracy for txts = 0.6857798165137615 
train Loss: 0.0238 Img2Txt: 0.6996  Txt2Img: 0.7211
test
Accuracy for imgs = 0.7452830188679245 and Accuracy for txts = 0.7830188679245282 
test Loss: 0.0270 Img2Txt: 0.7202  Txt2Img: 0.7275

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9013761467889909 and Accuracy for txts = 0.7155963302752294 
train Loss: 0.0229 Img2Txt: 0.7088  Txt2Img: 0.7287
test
Accuracy for imgs = 0.7264150943396226 and Accuracy for txts = 0.7641509433962264 
test Loss: 0.0269 Img2Txt: 0.7303  Txt2Img: 0.7262

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.8944954128440368 and Accuracy for txts = 0.7201834862385321 
train Loss: 0.0222 Img2Txt: 0.7030  Txt2Img: 0.7371
test
Accuracy for imgs = 0.7358490566037735 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0263 Img2Txt: 0.7288  Txt2Img: 0.7424

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9334862385321101 and Accuracy for txts = 0.7362385321100918 
train Loss: 0.0211 Img2Txt: 0.7167  Txt2Img: 0.7256
test
Accuracy for imgs = 0.7264150943396226 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0260 Img2Txt: 0.7391  Txt2Img: 0.7423

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.926605504587156 and Accuracy for txts = 0.731651376146789 
train Loss: 0.0208 Img2Txt: 0.7167  Txt2Img: 0.7435
test
Accuracy for imgs = 0.7358490566037735 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0256 Img2Txt: 0.7407  Txt2Img: 0.7500

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9495412844036698 and Accuracy for txts = 0.761467889908257 
train Loss: 0.0201 Img2Txt: 0.7232  Txt2Img: 0.7502
test
Accuracy for imgs = 0.7264150943396226 and Accuracy for txts = 0.820754716981132 
test Loss: 0.0259 Img2Txt: 0.7552  Txt2Img: 0.7620

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.963302752293578 and Accuracy for txts = 0.7545871559633028 
train Loss: 0.0195 Img2Txt: 0.7306  Txt2Img: 0.7552
test
Accuracy for imgs = 0.7358490566037735 and Accuracy for txts = 0.820754716981132 
test Loss: 0.0252 Img2Txt: 0.7518  Txt2Img: 0.7629

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9701834862385321 and Accuracy for txts = 0.7798165137614679 
train Loss: 0.0188 Img2Txt: 0.7521  Txt2Img: 0.7557
test
Accuracy for imgs = 0.7452830188679245 and Accuracy for txts = 0.830188679245283 
test Loss: 0.0245 Img2Txt: 0.7683  Txt2Img: 0.7618

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9793577981651377 and Accuracy for txts = 0.7660550458715597 
train Loss: 0.0183 Img2Txt: 0.7251  Txt2Img: 0.7488
test
Accuracy for imgs = 0.7547169811320754 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0244 Img2Txt: 0.7603  Txt2Img: 0.7598

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.993119266055046 and Accuracy for txts = 0.7798165137614679 
train Loss: 0.0181 Img2Txt: 0.7456  Txt2Img: 0.7711
test
Accuracy for imgs = 0.7735849056603773 and Accuracy for txts = 0.8113207547169811 
test Loss: 0.0248 Img2Txt: 0.7747  Txt2Img: 0.7779

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9839449541284404 and Accuracy for txts = 0.7729357798165138 
train Loss: 0.0173 Img2Txt: 0.7362  Txt2Img: 0.7648
test
Accuracy for imgs = 0.7641509433962264 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0238 Img2Txt: 0.7628  Txt2Img: 0.7639

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9839449541284404 and Accuracy for txts = 0.7912844036697249 
train Loss: 0.0167 Img2Txt: 0.7434  Txt2Img: 0.7536
test
Accuracy for imgs = 0.7735849056603773 and Accuracy for txts = 0.8113207547169811 
test Loss: 0.0238 Img2Txt: 0.7649  Txt2Img: 0.7685

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9908256880733946 and Accuracy for txts = 0.786697247706422 
train Loss: 0.0165 Img2Txt: 0.7604  Txt2Img: 0.7720
test
Accuracy for imgs = 0.830188679245283 and Accuracy for txts = 0.8113207547169811 
test Loss: 0.0228 Img2Txt: 0.7818  Txt2Img: 0.7755

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9977064220183487 and Accuracy for txts = 0.8004587155963303 
train Loss: 0.0159 Img2Txt: 0.7657  Txt2Img: 0.7762
test
Accuracy for imgs = 0.7830188679245282 and Accuracy for txts = 0.820754716981132 
test Loss: 0.0239 Img2Txt: 0.7802  Txt2Img: 0.7788

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9954128440366973 and Accuracy for txts = 0.7889908256880734 
train Loss: 0.0157 Img2Txt: 0.7460  Txt2Img: 0.7683
test
Accuracy for imgs = 0.7830188679245282 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0234 Img2Txt: 0.7749  Txt2Img: 0.7743

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.993119266055046 and Accuracy for txts = 0.8096330275229359 
train Loss: 0.0152 Img2Txt: 0.7570  Txt2Img: 0.7706
test
Accuracy for imgs = 0.820754716981132 and Accuracy for txts = 0.820754716981132 
test Loss: 0.0224 Img2Txt: 0.7844  Txt2Img: 0.7796

Epoch 27/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.8027522935779817 
train Loss: 0.0157 Img2Txt: 0.7491  Txt2Img: 0.7713
test
Accuracy for imgs = 0.7735849056603773 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0237 Img2Txt: 0.7725  Txt2Img: 0.7821

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9977064220183487 and Accuracy for txts = 0.8142201834862386 
train Loss: 0.0147 Img2Txt: 0.7471  Txt2Img: 0.7748
test
Accuracy for imgs = 0.7924528301886792 and Accuracy for txts = 0.8396226415094339 
test Loss: 0.0229 Img2Txt: 0.7695  Txt2Img: 0.7834

Epoch 29/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.8096330275229359 
train Loss: 0.0147 Img2Txt: 0.7661  Txt2Img: 0.7747
test
Accuracy for imgs = 0.820754716981132 and Accuracy for txts = 0.8018867924528301 
test Loss: 0.0219 Img2Txt: 0.7860  Txt2Img: 0.7829

Epoch 30/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.8165137614678899 
train Loss: 0.0146 Img2Txt: 0.7516  Txt2Img: 0.7776
test
Accuracy for imgs = 0.8018867924528301 and Accuracy for txts = 0.820754716981132 
test Loss: 0.0230 Img2Txt: 0.7788  Txt2Img: 0.7872

Training complete in 16m 57s
Best average mAP: 0.784450
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.7788  Txt2Img: 0.7872
Testing Done...............
Selected dataset for training is 2..........
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Training for dataset 2 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.07843137254901962 and Accuracy for txts = 0.01525054466230937 
train Loss: 0.0408 Img2Txt: 0.3457  Txt2Img: 0.3619
test
Accuracy for imgs = 0.34513274336283184 and Accuracy for txts = 0.48672566371681414 
test Loss: 0.0328 Img2Txt: 0.3502  Txt2Img: 0.3851

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.2570806100217865 and Accuracy for txts = 0.37472766884531594 
train Loss: 0.0326 Img2Txt: 0.4562  Txt2Img: 0.5011
test
Accuracy for imgs = 0.5221238938053098 and Accuracy for txts = 0.6991150442477876 
test Loss: 0.0287 Img2Txt: 0.4755  Txt2Img: 0.5479

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.35511982570806105 and Accuracy for txts = 0.6862745098039217 
train Loss: 0.0295 Img2Txt: 0.5366  Txt2Img: 0.5838
test
Accuracy for imgs = 0.5752212389380531 and Accuracy for txts = 0.7964601769911505 
test Loss: 0.0263 Img2Txt: 0.5493  Txt2Img: 0.6109

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.4444444444444445 and Accuracy for txts = 0.7843137254901962 
train Loss: 0.0273 Img2Txt: 0.6073  Txt2Img: 0.6629
test
Accuracy for imgs = 0.6017699115044248 and Accuracy for txts = 0.8849557522123894 
test Loss: 0.0246 Img2Txt: 0.6003  Txt2Img: 0.6696

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5555555555555556 and Accuracy for txts = 0.8496732026143792 
train Loss: 0.0250 Img2Txt: 0.6343  Txt2Img: 0.6805
test
Accuracy for imgs = 0.6194690265486725 and Accuracy for txts = 0.9292035398230089 
test Loss: 0.0236 Img2Txt: 0.6412  Txt2Img: 0.7113

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.6143790849673203 and Accuracy for txts = 0.8932461873638345 
train Loss: 0.0231 Img2Txt: 0.6732  Txt2Img: 0.7295
test
Accuracy for imgs = 0.6460176991150443 and Accuracy for txts = 0.9380530973451328 
test Loss: 0.0222 Img2Txt: 0.6733  Txt2Img: 0.7546

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.6775599128540306 and Accuracy for txts = 0.9215686274509804 
train Loss: 0.0215 Img2Txt: 0.6845  Txt2Img: 0.7469
test
Accuracy for imgs = 0.6725663716814159 and Accuracy for txts = 0.9469026548672567 
test Loss: 0.0216 Img2Txt: 0.7032  Txt2Img: 0.7836

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.7211328976034859 and Accuracy for txts = 0.9389978213507626 
train Loss: 0.0199 Img2Txt: 0.6904  Txt2Img: 0.7657
test
Accuracy for imgs = 0.6725663716814159 and Accuracy for txts = 0.9469026548672567 
test Loss: 0.0202 Img2Txt: 0.7174  Txt2Img: 0.8119

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.7755991285403051 and Accuracy for txts = 0.9411764705882354 
train Loss: 0.0186 Img2Txt: 0.7302  Txt2Img: 0.7790
test
Accuracy for imgs = 0.7079646017699115 and Accuracy for txts = 0.9469026548672567 
test Loss: 0.0202 Img2Txt: 0.7371  Txt2Img: 0.8246

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.832244008714597 and Accuracy for txts = 0.954248366013072 
train Loss: 0.0175 Img2Txt: 0.7546  Txt2Img: 0.7897
test
Accuracy for imgs = 0.7433628318584071 and Accuracy for txts = 0.9557522123893805 
test Loss: 0.0193 Img2Txt: 0.7673  Txt2Img: 0.8429

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8627450980392157 and Accuracy for txts = 0.9586056644880175 
train Loss: 0.0166 Img2Txt: 0.7546  Txt2Img: 0.8088
test
Accuracy for imgs = 0.7168141592920354 and Accuracy for txts = 0.9646017699115044 
test Loss: 0.0197 Img2Txt: 0.7676  Txt2Img: 0.8443

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9128540305010894 and Accuracy for txts = 0.9586056644880175 
train Loss: 0.0160 Img2Txt: 0.7897  Txt2Img: 0.8281
test
Accuracy for imgs = 0.7699115044247787 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0191 Img2Txt: 0.7981  Txt2Img: 0.8654

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9215686274509804 and Accuracy for txts = 0.9607843137254903 
train Loss: 0.0153 Img2Txt: 0.7869  Txt2Img: 0.8056
test
Accuracy for imgs = 0.7699115044247787 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0201 Img2Txt: 0.7971  Txt2Img: 0.8520

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9520697167755993 and Accuracy for txts = 0.9651416122004358 
train Loss: 0.0148 Img2Txt: 0.7898  Txt2Img: 0.8299
test
Accuracy for imgs = 0.7964601769911505 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0197 Img2Txt: 0.8023  Txt2Img: 0.8783

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9520697167755993 and Accuracy for txts = 0.9673202614379086 
train Loss: 0.0144 Img2Txt: 0.8077  Txt2Img: 0.8449
test
Accuracy for imgs = 0.8141592920353982 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0192 Img2Txt: 0.8403  Txt2Img: 0.8775

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9782135076252724 and Accuracy for txts = 0.9651416122004358 
train Loss: 0.0137 Img2Txt: 0.7898  Txt2Img: 0.8257
test
Accuracy for imgs = 0.8141592920353982 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0192 Img2Txt: 0.8242  Txt2Img: 0.8643

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9869281045751634 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0133 Img2Txt: 0.8261  Txt2Img: 0.8707
test
Accuracy for imgs = 0.8053097345132744 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0187 Img2Txt: 0.8439  Txt2Img: 0.8996

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9869281045751634 and Accuracy for txts = 0.9673202614379086 
train Loss: 0.0125 Img2Txt: 0.8106  Txt2Img: 0.8606
test
Accuracy for imgs = 0.8141592920353982 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0191 Img2Txt: 0.8545  Txt2Img: 0.8905

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9869281045751634 and Accuracy for txts = 0.9694989106753814 
train Loss: 0.0125 Img2Txt: 0.8129  Txt2Img: 0.8625
test
Accuracy for imgs = 0.831858407079646 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0191 Img2Txt: 0.8516  Txt2Img: 0.8930

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.991285403050109 and Accuracy for txts = 0.9694989106753814 
train Loss: 0.0120 Img2Txt: 0.8353  Txt2Img: 0.8850
test
Accuracy for imgs = 0.831858407079646 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0182 Img2Txt: 0.8472  Txt2Img: 0.9072

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.991285403050109 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0119 Img2Txt: 0.8399  Txt2Img: 0.8807
test
Accuracy for imgs = 0.8230088495575221 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0193 Img2Txt: 0.8519  Txt2Img: 0.8991

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9956427015250545 and Accuracy for txts = 0.9651416122004358 
train Loss: 0.0121 Img2Txt: 0.8124  Txt2Img: 0.8634
test
Accuracy for imgs = 0.8230088495575221 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0187 Img2Txt: 0.8356  Txt2Img: 0.8949

Epoch 23/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0113 Img2Txt: 0.8091  Txt2Img: 0.8885
test
Accuracy for imgs = 0.8495575221238938 and Accuracy for txts = 0.9911504424778761 
test Loss: 0.0178 Img2Txt: 0.8463  Txt2Img: 0.9162

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9978213507625273 and Accuracy for txts = 0.9694989106753814 
train Loss: 0.0113 Img2Txt: 0.8155  Txt2Img: 0.8486
test
Accuracy for imgs = 0.831858407079646 and Accuracy for txts = 0.9734513274336283 
test Loss: 0.0184 Img2Txt: 0.8564  Txt2Img: 0.8979

Epoch 25/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0109 Img2Txt: 0.8103  Txt2Img: 0.8576
test
Accuracy for imgs = 0.8495575221238938 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0178 Img2Txt: 0.8500  Txt2Img: 0.9123

Epoch 26/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0104 Img2Txt: 0.8275  Txt2Img: 0.8681
test
Accuracy for imgs = 0.8495575221238938 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0170 Img2Txt: 0.8657  Txt2Img: 0.9180

Epoch 27/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9694989106753814 
train Loss: 0.0103 Img2Txt: 0.8210  Txt2Img: 0.8638
test
Accuracy for imgs = 0.8407079646017699 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0188 Img2Txt: 0.8619  Txt2Img: 0.9035

Epoch 28/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9738562091503269 
train Loss: 0.0103 Img2Txt: 0.8331  Txt2Img: 0.8904
test
Accuracy for imgs = 0.8495575221238938 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0179 Img2Txt: 0.8632  Txt2Img: 0.9119

Epoch 29/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9716775599128541 
train Loss: 0.0103 Img2Txt: 0.8141  Txt2Img: 0.8675
test
Accuracy for imgs = 0.831858407079646 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0172 Img2Txt: 0.8576  Txt2Img: 0.9206

Epoch 30/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.9694989106753814 
train Loss: 0.0101 Img2Txt: 0.8233  Txt2Img: 0.8633
test
Accuracy for imgs = 0.8584070796460177 and Accuracy for txts = 0.9823008849557522 
test Loss: 0.0174 Img2Txt: 0.8536  Txt2Img: 0.9092

Training complete in 18m 19s
Best average mAP: 0.891835
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.4274  Txt2Img: 0.4076
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.8536  Txt2Img: 0.9092
Testing Done...............
Selected dataset for training is 3..........
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Training for dataset 3 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.09615384615384616 and Accuracy for txts = 0.0811965811965812 
train Loss: 0.0377 Img2Txt: 0.2675  Txt2Img: 0.2476
test
Accuracy for imgs = 0.3247863247863248 and Accuracy for txts = 0.3076923076923077 
test Loss: 0.0322 Img2Txt: 0.2840  Txt2Img: 0.2803

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.22222222222222224 and Accuracy for txts = 0.18162393162393164 
train Loss: 0.0328 Img2Txt: 0.3670  Txt2Img: 0.3303
test
Accuracy for imgs = 0.3418803418803419 and Accuracy for txts = 0.47008547008547014 
test Loss: 0.0302 Img2Txt: 0.3729  Txt2Img: 0.3640

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.326923076923077 and Accuracy for txts = 0.35683760683760685 
train Loss: 0.0310 Img2Txt: 0.4134  Txt2Img: 0.4275
test
Accuracy for imgs = 0.46153846153846156 and Accuracy for txts = 0.5811965811965812 
test Loss: 0.0286 Img2Txt: 0.4562  Txt2Img: 0.4605

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.4444444444444445 and Accuracy for txts = 0.4572649572649573 
train Loss: 0.0294 Img2Txt: 0.4614  Txt2Img: 0.4871
test
Accuracy for imgs = 0.5811965811965812 and Accuracy for txts = 0.6068376068376069 
test Loss: 0.0272 Img2Txt: 0.5096  Txt2Img: 0.5334

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5726495726495727 and Accuracy for txts = 0.48931623931623935 
train Loss: 0.0278 Img2Txt: 0.5047  Txt2Img: 0.5381
test
Accuracy for imgs = 0.5982905982905984 and Accuracy for txts = 0.6581196581196582 
test Loss: 0.0262 Img2Txt: 0.5524  Txt2Img: 0.5655

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.6581196581196582 and Accuracy for txts = 0.5213675213675214 
train Loss: 0.0265 Img2Txt: 0.5370  Txt2Img: 0.5590
test
Accuracy for imgs = 0.6495726495726496 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0254 Img2Txt: 0.5755  Txt2Img: 0.5846

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.702991452991453 and Accuracy for txts = 0.5448717948717949 
train Loss: 0.0252 Img2Txt: 0.5515  Txt2Img: 0.5686
test
Accuracy for imgs = 0.6410256410256411 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0250 Img2Txt: 0.5934  Txt2Img: 0.6016

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.7841880341880343 and Accuracy for txts = 0.5641025641025642 
train Loss: 0.0240 Img2Txt: 0.5690  Txt2Img: 0.5839
test
Accuracy for imgs = 0.6752136752136753 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0248 Img2Txt: 0.5976  Txt2Img: 0.6098

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.8034188034188035 and Accuracy for txts = 0.5811965811965812 
train Loss: 0.0230 Img2Txt: 0.5792  Txt2Img: 0.5918
test
Accuracy for imgs = 0.6752136752136753 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0241 Img2Txt: 0.6182  Txt2Img: 0.6191

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.8290598290598291 and Accuracy for txts = 0.5982905982905984 
train Loss: 0.0222 Img2Txt: 0.5919  Txt2Img: 0.5985
test
Accuracy for imgs = 0.7008547008547009 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0240 Img2Txt: 0.6279  Txt2Img: 0.6271

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8931623931623932 and Accuracy for txts = 0.6132478632478633 
train Loss: 0.0214 Img2Txt: 0.5980  Txt2Img: 0.6062
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0237 Img2Txt: 0.6303  Txt2Img: 0.6279

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9145299145299146 and Accuracy for txts = 0.638888888888889 
train Loss: 0.0207 Img2Txt: 0.6145  Txt2Img: 0.6273
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0234 Img2Txt: 0.6433  Txt2Img: 0.6419

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9316239316239318 and Accuracy for txts = 0.6517094017094017 
train Loss: 0.0198 Img2Txt: 0.6202  Txt2Img: 0.6214
test
Accuracy for imgs = 0.6923076923076924 and Accuracy for txts = 0.6495726495726496 
test Loss: 0.0229 Img2Txt: 0.6450  Txt2Img: 0.6338

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9380341880341881 and Accuracy for txts = 0.6602564102564104 
train Loss: 0.0196 Img2Txt: 0.6204  Txt2Img: 0.6143
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6581196581196582 
test Loss: 0.0231 Img2Txt: 0.6470  Txt2Img: 0.6421

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9401709401709403 and Accuracy for txts = 0.6602564102564104 
train Loss: 0.0189 Img2Txt: 0.6424  Txt2Img: 0.6339
test
Accuracy for imgs = 0.7264957264957266 and Accuracy for txts = 0.6581196581196582 
test Loss: 0.0225 Img2Txt: 0.6546  Txt2Img: 0.6445

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9722222222222223 and Accuracy for txts = 0.6730769230769231 
train Loss: 0.0188 Img2Txt: 0.6208  Txt2Img: 0.6266
test
Accuracy for imgs = 0.7008547008547009 and Accuracy for txts = 0.6581196581196582 
test Loss: 0.0236 Img2Txt: 0.6389  Txt2Img: 0.6432

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9764957264957266 and Accuracy for txts = 0.6752136752136753 
train Loss: 0.0179 Img2Txt: 0.6352  Txt2Img: 0.6331
test
Accuracy for imgs = 0.6923076923076924 and Accuracy for txts = 0.6581196581196582 
test Loss: 0.0226 Img2Txt: 0.6581  Txt2Img: 0.6462

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9871794871794872 and Accuracy for txts = 0.6752136752136753 
train Loss: 0.0177 Img2Txt: 0.6285  Txt2Img: 0.6393
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6666666666666667 
test Loss: 0.0230 Img2Txt: 0.6506  Txt2Img: 0.6483

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.982905982905983 and Accuracy for txts = 0.6752136752136753 
train Loss: 0.0170 Img2Txt: 0.6310  Txt2Img: 0.6397
test
Accuracy for imgs = 0.7350427350427351 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0221 Img2Txt: 0.6586  Txt2Img: 0.6485

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9935897435897437 and Accuracy for txts = 0.6773504273504274 
train Loss: 0.0170 Img2Txt: 0.6185  Txt2Img: 0.6310
test
Accuracy for imgs = 0.7008547008547009 and Accuracy for txts = 0.6666666666666667 
test Loss: 0.0231 Img2Txt: 0.6380  Txt2Img: 0.6474

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9957264957264959 and Accuracy for txts = 0.6794871794871795 
train Loss: 0.0166 Img2Txt: 0.6308  Txt2Img: 0.6355
test
Accuracy for imgs = 0.7264957264957266 and Accuracy for txts = 0.6666666666666667 
test Loss: 0.0223 Img2Txt: 0.6588  Txt2Img: 0.6535

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9957264957264959 and Accuracy for txts = 0.6794871794871795 
train Loss: 0.0166 Img2Txt: 0.6214  Txt2Img: 0.6291
test
Accuracy for imgs = 0.6923076923076924 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0226 Img2Txt: 0.6513  Txt2Img: 0.6455

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9935897435897437 and Accuracy for txts = 0.6816239316239316 
train Loss: 0.0160 Img2Txt: 0.6305  Txt2Img: 0.6329
test
Accuracy for imgs = 0.7264957264957266 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0224 Img2Txt: 0.6705  Txt2Img: 0.6553

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9957264957264959 and Accuracy for txts = 0.6901709401709403 
train Loss: 0.0159 Img2Txt: 0.6437  Txt2Img: 0.6504
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0219 Img2Txt: 0.6596  Txt2Img: 0.6633

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.997863247863248 and Accuracy for txts = 0.6944444444444445 
train Loss: 0.0155 Img2Txt: 0.6389  Txt2Img: 0.6404
test
Accuracy for imgs = 0.6837606837606838 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0221 Img2Txt: 0.6654  Txt2Img: 0.6536

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.997863247863248 and Accuracy for txts = 0.7008547008547009 
train Loss: 0.0153 Img2Txt: 0.6247  Txt2Img: 0.6374
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6752136752136753 
test Loss: 0.0219 Img2Txt: 0.6503  Txt2Img: 0.6590

Epoch 27/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7094017094017094 
train Loss: 0.0150 Img2Txt: 0.6513  Txt2Img: 0.6531
test
Accuracy for imgs = 0.7264957264957266 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0218 Img2Txt: 0.6689  Txt2Img: 0.6688

Epoch 28/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7072649572649573 
train Loss: 0.0147 Img2Txt: 0.6185  Txt2Img: 0.6324
test
Accuracy for imgs = 0.6923076923076924 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0220 Img2Txt: 0.6437  Txt2Img: 0.6482

Epoch 29/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7094017094017094 
train Loss: 0.0149 Img2Txt: 0.6488  Txt2Img: 0.6497
test
Accuracy for imgs = 0.7094017094017094 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0216 Img2Txt: 0.6697  Txt2Img: 0.6634

Epoch 30/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7094017094017094 
train Loss: 0.0145 Img2Txt: 0.6405  Txt2Img: 0.6530
test
Accuracy for imgs = 0.7008547008547009 and Accuracy for txts = 0.6666666666666667 
test Loss: 0.0215 Img2Txt: 0.6541  Txt2Img: 0.6576

Training complete in 18m 47s
Best average mAP: 0.668868
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.4862  Txt2Img: 0.4829
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.6381  Txt2Img: 0.6718
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.6541  Txt2Img: 0.6576
Testing Done...............
Selected dataset for training is 4..........
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Training for dataset 4 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.08936170212765958 and Accuracy for txts = 0.01702127659574468 
train Loss: 0.0374 Img2Txt: 0.1984  Txt2Img: 0.2005
test
Accuracy for imgs = 0.20168067226890757 and Accuracy for txts = 0.20168067226890757 
test Loss: 0.0325 Img2Txt: 0.2262  Txt2Img: 0.2105

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.2 and Accuracy for txts = 0.19148936170212766 
train Loss: 0.0331 Img2Txt: 0.2601  Txt2Img: 0.2576
test
Accuracy for imgs = 0.29411764705882354 and Accuracy for txts = 0.40336134453781514 
test Loss: 0.0309 Img2Txt: 0.2891  Txt2Img: 0.2702

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.30851063829787234 and Accuracy for txts = 0.3893617021276596 
train Loss: 0.0313 Img2Txt: 0.3475  Txt2Img: 0.3283
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.4789915966386554 
test Loss: 0.0295 Img2Txt: 0.3575  Txt2Img: 0.3411

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.4340425531914894 and Accuracy for txts = 0.48723404255319147 
train Loss: 0.0298 Img2Txt: 0.3764  Txt2Img: 0.3760
test
Accuracy for imgs = 0.42016806722689076 and Accuracy for txts = 0.5294117647058824 
test Loss: 0.0284 Img2Txt: 0.4070  Txt2Img: 0.3927

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5234042553191489 and Accuracy for txts = 0.5680851063829787 
train Loss: 0.0284 Img2Txt: 0.4056  Txt2Img: 0.4157
test
Accuracy for imgs = 0.47058823529411764 and Accuracy for txts = 0.5882352941176471 
test Loss: 0.0279 Img2Txt: 0.4371  Txt2Img: 0.4348

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.6 and Accuracy for txts = 0.6021276595744681 
train Loss: 0.0270 Img2Txt: 0.4228  Txt2Img: 0.4305
test
Accuracy for imgs = 0.48739495798319327 and Accuracy for txts = 0.5882352941176471 
test Loss: 0.0277 Img2Txt: 0.4662  Txt2Img: 0.4631

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.6829787234042554 and Accuracy for txts = 0.6276595744680851 
train Loss: 0.0257 Img2Txt: 0.4410  Txt2Img: 0.4501
test
Accuracy for imgs = 0.49579831932773105 and Accuracy for txts = 0.5966386554621849 
test Loss: 0.0272 Img2Txt: 0.4855  Txt2Img: 0.4797

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.7340425531914894 and Accuracy for txts = 0.6382978723404256 
train Loss: 0.0247 Img2Txt: 0.4597  Txt2Img: 0.4695
test
Accuracy for imgs = 0.5294117647058824 and Accuracy for txts = 0.6218487394957983 
test Loss: 0.0270 Img2Txt: 0.5023  Txt2Img: 0.4943

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.8021276595744681 and Accuracy for txts = 0.6510638297872341 
train Loss: 0.0235 Img2Txt: 0.4810  Txt2Img: 0.5125
test
Accuracy for imgs = 0.5714285714285714 and Accuracy for txts = 0.6302521008403361 
test Loss: 0.0268 Img2Txt: 0.5138  Txt2Img: 0.5207

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.8212765957446808 and Accuracy for txts = 0.6638297872340425 
train Loss: 0.0228 Img2Txt: 0.4983  Txt2Img: 0.5146
test
Accuracy for imgs = 0.5798319327731092 and Accuracy for txts = 0.6386554621848739 
test Loss: 0.0265 Img2Txt: 0.5267  Txt2Img: 0.5135

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8829787234042553 and Accuracy for txts = 0.6787234042553192 
train Loss: 0.0217 Img2Txt: 0.5001  Txt2Img: 0.5053
test
Accuracy for imgs = 0.5882352941176471 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0259 Img2Txt: 0.5394  Txt2Img: 0.5254

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9 and Accuracy for txts = 0.6893617021276596 
train Loss: 0.0210 Img2Txt: 0.5160  Txt2Img: 0.5250
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0260 Img2Txt: 0.5442  Txt2Img: 0.5321

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9340425531914893 and Accuracy for txts = 0.6872340425531915 
train Loss: 0.0202 Img2Txt: 0.5216  Txt2Img: 0.5314
test
Accuracy for imgs = 0.5966386554621849 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0256 Img2Txt: 0.5494  Txt2Img: 0.5340

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9361702127659575 and Accuracy for txts = 0.6957446808510639 
train Loss: 0.0195 Img2Txt: 0.5240  Txt2Img: 0.5299
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0258 Img2Txt: 0.5507  Txt2Img: 0.5387

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9553191489361702 and Accuracy for txts = 0.6957446808510639 
train Loss: 0.0190 Img2Txt: 0.5091  Txt2Img: 0.5268
test
Accuracy for imgs = 0.6134453781512604 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0253 Img2Txt: 0.5386  Txt2Img: 0.5379

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9617021276595745 and Accuracy for txts = 0.7042553191489361 
train Loss: 0.0186 Img2Txt: 0.5276  Txt2Img: 0.5459
test
Accuracy for imgs = 0.5798319327731092 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0257 Img2Txt: 0.5512  Txt2Img: 0.5510

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9702127659574469 and Accuracy for txts = 0.7127659574468085 
train Loss: 0.0179 Img2Txt: 0.5358  Txt2Img: 0.5653
test
Accuracy for imgs = 0.6302521008403361 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0246 Img2Txt: 0.5528  Txt2Img: 0.5652

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9787234042553191 and Accuracy for txts = 0.7212765957446808 
train Loss: 0.0175 Img2Txt: 0.5061  Txt2Img: 0.5319
test
Accuracy for imgs = 0.5882352941176471 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0256 Img2Txt: 0.5472  Txt2Img: 0.5521

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9851063829787234 and Accuracy for txts = 0.7297872340425532 
train Loss: 0.0173 Img2Txt: 0.4887  Txt2Img: 0.5439
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0243 Img2Txt: 0.5353  Txt2Img: 0.5606

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9787234042553191 and Accuracy for txts = 0.7340425531914894 
train Loss: 0.0173 Img2Txt: 0.5063  Txt2Img: 0.5274
test
Accuracy for imgs = 0.5630252100840336 and Accuracy for txts = 0.7058823529411764 
test Loss: 0.0243 Img2Txt: 0.5353  Txt2Img: 0.5461

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9808510638297873 and Accuracy for txts = 0.7468085106382979 
train Loss: 0.0172 Img2Txt: 0.5431  Txt2Img: 0.5534
test
Accuracy for imgs = 0.6218487394957983 and Accuracy for txts = 0.6974789915966386 
test Loss: 0.0245 Img2Txt: 0.5776  Txt2Img: 0.5798

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9914893617021276 and Accuracy for txts = 0.7489361702127659 
train Loss: 0.0160 Img2Txt: 0.5218  Txt2Img: 0.5406
test
Accuracy for imgs = 0.5714285714285714 and Accuracy for txts = 0.7142857142857143 
test Loss: 0.0242 Img2Txt: 0.5523  Txt2Img: 0.5679

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9914893617021276 and Accuracy for txts = 0.7510638297872341 
train Loss: 0.0159 Img2Txt: 0.5554  Txt2Img: 0.5799
test
Accuracy for imgs = 0.6134453781512604 and Accuracy for txts = 0.7142857142857143 
test Loss: 0.0243 Img2Txt: 0.5840  Txt2Img: 0.5831

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.997872340425532 and Accuracy for txts = 0.7553191489361702 
train Loss: 0.0154 Img2Txt: 0.5191  Txt2Img: 0.5486
test
Accuracy for imgs = 0.6302521008403361 and Accuracy for txts = 0.7142857142857143 
test Loss: 0.0233 Img2Txt: 0.5638  Txt2Img: 0.5783

Epoch 25/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7617021276595745 
train Loss: 0.0155 Img2Txt: 0.5389  Txt2Img: 0.5570
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.7058823529411764 
test Loss: 0.0246 Img2Txt: 0.5706  Txt2Img: 0.5831

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.997872340425532 and Accuracy for txts = 0.7659574468085106 
train Loss: 0.0149 Img2Txt: 0.5261  Txt2Img: 0.5589
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.7142857142857143 
test Loss: 0.0230 Img2Txt: 0.5698  Txt2Img: 0.5872

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9957446808510638 and Accuracy for txts = 0.7702127659574468 
train Loss: 0.0148 Img2Txt: 0.5305  Txt2Img: 0.5387
test
Accuracy for imgs = 0.5798319327731092 and Accuracy for txts = 0.7226890756302521 
test Loss: 0.0240 Img2Txt: 0.5575  Txt2Img: 0.5723

Epoch 28/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.774468085106383 
train Loss: 0.0146 Img2Txt: 0.5562  Txt2Img: 0.5770
test
Accuracy for imgs = 0.6134453781512604 and Accuracy for txts = 0.7226890756302521 
test Loss: 0.0230 Img2Txt: 0.5888  Txt2Img: 0.5955

Epoch 29/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7872340425531915 
train Loss: 0.0142 Img2Txt: 0.5199  Txt2Img: 0.5515
test
Accuracy for imgs = 0.5882352941176471 and Accuracy for txts = 0.7563025210084033 
test Loss: 0.0242 Img2Txt: 0.5473  Txt2Img: 0.5638

Epoch 30/30
--------------------
train
Accuracy for imgs = 1.0 and Accuracy for txts = 0.7872340425531915 
train Loss: 0.0143 Img2Txt: 0.5585  Txt2Img: 0.5915
test
Accuracy for imgs = 0.5882352941176471 and Accuracy for txts = 0.7478991596638656 
test Loss: 0.0229 Img2Txt: 0.5710  Txt2Img: 0.5765

Training complete in 18m 58s
Best average mAP: 0.592111
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2817  Txt2Img: 0.2471
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.3984  Txt2Img: 0.3708
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3414  Txt2Img: 0.3341
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.5710  Txt2Img: 0.5765
Testing Done...............
Selected dataset for training is 5..........
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Training for dataset 5 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.06054279749478079 and Accuracy for txts = 0.0939457202505219 
train Loss: 0.0370 Img2Txt: 0.3567  Txt2Img: 0.3096
test
Accuracy for imgs = 0.35 and Accuracy for txts = 0.4083333333333333 
test Loss: 0.0305 Img2Txt: 0.3989  Txt2Img: 0.3313

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.3089770354906054 and Accuracy for txts = 0.4237995824634655 
train Loss: 0.0305 Img2Txt: 0.4937  Txt2Img: 0.4461
test
Accuracy for imgs = 0.5 and Accuracy for txts = 0.6833333333333333 
test Loss: 0.0264 Img2Txt: 0.5230  Txt2Img: 0.4684

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.47181628392484337 and Accuracy for txts = 0.6638830897703548 
train Loss: 0.0270 Img2Txt: 0.6119  Txt2Img: 0.6141
test
Accuracy for imgs = 0.625 and Accuracy for txts = 0.7916666666666666 
test Loss: 0.0239 Img2Txt: 0.6331  Txt2Img: 0.6345

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.6012526096033403 and Accuracy for txts = 0.8079331941544884 
train Loss: 0.0242 Img2Txt: 0.6830  Txt2Img: 0.6811
test
Accuracy for imgs = 0.725 and Accuracy for txts = 0.85 
test Loss: 0.0227 Img2Txt: 0.7128  Txt2Img: 0.7365

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.707724425887265 and Accuracy for txts = 0.8643006263048015 
train Loss: 0.0218 Img2Txt: 0.7612  Txt2Img: 0.7769
test
Accuracy for imgs = 0.7833333333333333 and Accuracy for txts = 0.9083333333333333 
test Loss: 0.0213 Img2Txt: 0.7905  Txt2Img: 0.8060

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.7682672233820459 and Accuracy for txts = 0.9060542797494779 
train Loss: 0.0198 Img2Txt: 0.7930  Txt2Img: 0.8275
test
Accuracy for imgs = 0.8166666666666667 and Accuracy for txts = 0.9416666666666667 
test Loss: 0.0210 Img2Txt: 0.8274  Txt2Img: 0.8504

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.8392484342379958 and Accuracy for txts = 0.9227557411273486 
train Loss: 0.0179 Img2Txt: 0.8308  Txt2Img: 0.8612
test
Accuracy for imgs = 0.8666666666666667 and Accuracy for txts = 0.9666666666666667 
test Loss: 0.0187 Img2Txt: 0.8662  Txt2Img: 0.8989

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.8935281837160751 and Accuracy for txts = 0.9311064718162838 
train Loss: 0.0163 Img2Txt: 0.8280  Txt2Img: 0.8761
test
Accuracy for imgs = 0.8666666666666667 and Accuracy for txts = 0.9666666666666667 
test Loss: 0.0185 Img2Txt: 0.8666  Txt2Img: 0.9047

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.9373695198329853 and Accuracy for txts = 0.9394572025052191 
train Loss: 0.0153 Img2Txt: 0.8508  Txt2Img: 0.8962
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 0.975 
test Loss: 0.0186 Img2Txt: 0.8794  Txt2Img: 0.9192

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.9227557411273486 and Accuracy for txts = 0.9436325678496867 
train Loss: 0.0145 Img2Txt: 0.8602  Txt2Img: 0.9068
test
Accuracy for imgs = 0.875 and Accuracy for txts = 0.975 
test Loss: 0.0181 Img2Txt: 0.8862  Txt2Img: 0.9267

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.9665970772442588 and Accuracy for txts = 0.9457202505219205 
train Loss: 0.0135 Img2Txt: 0.8516  Txt2Img: 0.9057
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 0.975 
test Loss: 0.0172 Img2Txt: 0.8986  Txt2Img: 0.9361

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9728601252609602 and Accuracy for txts = 0.9519832985386221 
train Loss: 0.0130 Img2Txt: 0.8568  Txt2Img: 0.9121
test
Accuracy for imgs = 0.8833333333333333 and Accuracy for txts = 0.975 
test Loss: 0.0174 Img2Txt: 0.8933  Txt2Img: 0.9387

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9791231732776617 and Accuracy for txts = 0.9519832985386221 
train Loss: 0.0125 Img2Txt: 0.8613  Txt2Img: 0.9031
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 0.9833333333333333 
test Loss: 0.0169 Img2Txt: 0.9024  Txt2Img: 0.9379

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9812108559498955 and Accuracy for txts = 0.9582463465553235 
train Loss: 0.0122 Img2Txt: 0.8929  Txt2Img: 0.9356
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 0.9916666666666667 
test Loss: 0.0174 Img2Txt: 0.9061  Txt2Img: 0.9484

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9937369519832985 and Accuracy for txts = 0.9582463465553235 
train Loss: 0.0119 Img2Txt: 0.7955  Txt2Img: 0.8886
test
Accuracy for imgs = 0.8166666666666667 and Accuracy for txts = 0.9916666666666667 
test Loss: 0.0177 Img2Txt: 0.8325  Txt2Img: 0.9205

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9853862212943632 and Accuracy for txts = 0.9603340292275573 
train Loss: 0.0126 Img2Txt: 0.8845  Txt2Img: 0.9380
test
Accuracy for imgs = 0.9166666666666666 and Accuracy for txts = 1.0 
test Loss: 0.0177 Img2Txt: 0.9165  Txt2Img: 0.9601

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9937369519832985 and Accuracy for txts = 0.9582463465553235 
train Loss: 0.0111 Img2Txt: 0.8560  Txt2Img: 0.9168
test
Accuracy for imgs = 0.9 and Accuracy for txts = 1.0 
test Loss: 0.0158 Img2Txt: 0.9034  Txt2Img: 0.9478

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9958246346555323 and Accuracy for txts = 0.9624217118997911 
train Loss: 0.0114 Img2Txt: 0.8709  Txt2Img: 0.9346
test
Accuracy for imgs = 0.9083333333333333 and Accuracy for txts = 1.0 
test Loss: 0.0173 Img2Txt: 0.9116  Txt2Img: 0.9584

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9603340292275573 
train Loss: 0.0106 Img2Txt: 0.8728  Txt2Img: 0.9269
test
Accuracy for imgs = 0.9 and Accuracy for txts = 1.0 
test Loss: 0.0159 Img2Txt: 0.8984  Txt2Img: 0.9548

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9937369519832985 and Accuracy for txts = 0.9603340292275573 
train Loss: 0.0113 Img2Txt: 0.8729  Txt2Img: 0.9317
test
Accuracy for imgs = 0.9333333333333333 and Accuracy for txts = 1.0 
test Loss: 0.0159 Img2Txt: 0.9208  Txt2Img: 0.9599

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9603340292275573 
train Loss: 0.0105 Img2Txt: 0.8673  Txt2Img: 0.9294
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 1.0 
test Loss: 0.0164 Img2Txt: 0.8941  Txt2Img: 0.9557

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9979123173277661 and Accuracy for txts = 0.964509394572025 
train Loss: 0.0106 Img2Txt: 0.8752  Txt2Img: 0.9340
test
Accuracy for imgs = 0.9166666666666666 and Accuracy for txts = 0.9833333333333333 
test Loss: 0.0159 Img2Txt: 0.9196  Txt2Img: 0.9602

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.964509394572025 
train Loss: 0.0097 Img2Txt: 0.8792  Txt2Img: 0.9364
test
Accuracy for imgs = 0.9 and Accuracy for txts = 1.0 
test Loss: 0.0149 Img2Txt: 0.9181  Txt2Img: 0.9648

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9665970772442588 
train Loss: 0.0102 Img2Txt: 0.8530  Txt2Img: 0.9288
test
Accuracy for imgs = 0.9 and Accuracy for txts = 0.9833333333333333 
test Loss: 0.0164 Img2Txt: 0.8978  Txt2Img: 0.9464

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9979123173277661 and Accuracy for txts = 0.964509394572025 
train Loss: 0.0100 Img2Txt: 0.8893  Txt2Img: 0.9536
test
Accuracy for imgs = 0.9083333333333333 and Accuracy for txts = 1.0 
test Loss: 0.0150 Img2Txt: 0.9192  Txt2Img: 0.9630

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9979123173277661 and Accuracy for txts = 0.9665970772442588 
train Loss: 0.0097 Img2Txt: 0.8510  Txt2Img: 0.9203
test
Accuracy for imgs = 0.8583333333333333 and Accuracy for txts = 0.9916666666666667 
test Loss: 0.0166 Img2Txt: 0.8712  Txt2Img: 0.9456

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.964509394572025 
train Loss: 0.0095 Img2Txt: 0.8752  Txt2Img: 0.9405
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 1.0 
test Loss: 0.0150 Img2Txt: 0.9119  Txt2Img: 0.9623

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9686847599164926 
train Loss: 0.0097 Img2Txt: 0.8543  Txt2Img: 0.9321
test
Accuracy for imgs = 0.8916666666666666 and Accuracy for txts = 0.9833333333333333 
test Loss: 0.0166 Img2Txt: 0.8930  Txt2Img: 0.9567

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9665970772442588 
train Loss: 0.0087 Img2Txt: 0.8755  Txt2Img: 0.9421
test
Accuracy for imgs = 0.8833333333333333 and Accuracy for txts = 0.9916666666666667 
test Loss: 0.0145 Img2Txt: 0.8989  Txt2Img: 0.9492

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9999999999999999 and Accuracy for txts = 0.9686847599164926 
train Loss: 0.0103 Img2Txt: 0.8886  Txt2Img: 0.9397
test
Accuracy for imgs = 0.9333333333333333 and Accuracy for txts = 0.9916666666666667 
test Loss: 0.0157 Img2Txt: 0.9299  Txt2Img: 0.9627

Training complete in 18m 53s
Best average mAP: 0.946325
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.3303  Txt2Img: 0.3028
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.4100  Txt2Img: 0.3418
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3732  Txt2Img: 0.3292
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.3555  Txt2Img: 0.3658
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.9299  Txt2Img: 0.9627
Testing Done...............
Selected dataset for training is 6..........
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Training for dataset 6 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.05230125523012552 and Accuracy for txts = 0.0020920502092050207 
train Loss: 0.0390 Img2Txt: 0.3696  Txt2Img: 0.3813
test
Accuracy for imgs = 0.15126050420168066 and Accuracy for txts = 0.2857142857142857 
test Loss: 0.0318 Img2Txt: 0.4141  Txt2Img: 0.3868

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.17573221757322174 and Accuracy for txts = 0.35564853556485354 
train Loss: 0.0304 Img2Txt: 0.4161  Txt2Img: 0.3724
test
Accuracy for imgs = 0.3445378151260504 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0283 Img2Txt: 0.4510  Txt2Img: 0.3712

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.3075313807531381 and Accuracy for txts = 0.6736401673640167 
train Loss: 0.0277 Img2Txt: 0.5411  Txt2Img: 0.4577
test
Accuracy for imgs = 0.4453781512605042 and Accuracy for txts = 0.8067226890756303 
test Loss: 0.0263 Img2Txt: 0.5543  Txt2Img: 0.4730

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.4539748953974895 and Accuracy for txts = 0.7949790794979079 
train Loss: 0.0254 Img2Txt: 0.5670  Txt2Img: 0.5395
test
Accuracy for imgs = 0.48739495798319327 and Accuracy for txts = 0.8067226890756303 
test Loss: 0.0247 Img2Txt: 0.5801  Txt2Img: 0.5221

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5606694560669455 and Accuracy for txts = 0.8451882845188283 
train Loss: 0.0232 Img2Txt: 0.6160  Txt2Img: 0.6199
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.8403361344537815 
test Loss: 0.0239 Img2Txt: 0.6391  Txt2Img: 0.6160

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.606694560669456 and Accuracy for txts = 0.8493723849372384 
train Loss: 0.0217 Img2Txt: 0.6736  Txt2Img: 0.7054
test
Accuracy for imgs = 0.6386554621848739 and Accuracy for txts = 0.8403361344537815 
test Loss: 0.0225 Img2Txt: 0.6818  Txt2Img: 0.7103

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.702928870292887 and Accuracy for txts = 0.8640167364016735 
train Loss: 0.0203 Img2Txt: 0.7063  Txt2Img: 0.7563
test
Accuracy for imgs = 0.6890756302521008 and Accuracy for txts = 0.8487394957983193 
test Loss: 0.0220 Img2Txt: 0.7202  Txt2Img: 0.7602

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.7615062761506276 and Accuracy for txts = 0.8556485355648534 
train Loss: 0.0189 Img2Txt: 0.7293  Txt2Img: 0.7663
test
Accuracy for imgs = 0.7142857142857143 and Accuracy for txts = 0.8571428571428571 
test Loss: 0.0217 Img2Txt: 0.7551  Txt2Img: 0.8071

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.807531380753138 and Accuracy for txts = 0.8744769874476986 
train Loss: 0.0179 Img2Txt: 0.7437  Txt2Img: 0.7939
test
Accuracy for imgs = 0.7563025210084033 and Accuracy for txts = 0.8571428571428571 
test Loss: 0.0210 Img2Txt: 0.7669  Txt2Img: 0.8028

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.8430962343096233 and Accuracy for txts = 0.8744769874476986 
train Loss: 0.0171 Img2Txt: 0.7709  Txt2Img: 0.8095
test
Accuracy for imgs = 0.7394957983193277 and Accuracy for txts = 0.8571428571428571 
test Loss: 0.0205 Img2Txt: 0.7842  Txt2Img: 0.8281

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8744769874476986 and Accuracy for txts = 0.8807531380753137 
train Loss: 0.0159 Img2Txt: 0.7730  Txt2Img: 0.8119
test
Accuracy for imgs = 0.7815126050420168 and Accuracy for txts = 0.8571428571428571 
test Loss: 0.0199 Img2Txt: 0.8029  Txt2Img: 0.8339

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.901673640167364 and Accuracy for txts = 0.8933054393305438 
train Loss: 0.0151 Img2Txt: 0.7737  Txt2Img: 0.8317
test
Accuracy for imgs = 0.8235294117647058 and Accuracy for txts = 0.8655462184873949 
test Loss: 0.0197 Img2Txt: 0.8152  Txt2Img: 0.8448

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9330543933054393 and Accuracy for txts = 0.8849372384937237 
train Loss: 0.0144 Img2Txt: 0.7797  Txt2Img: 0.8138
test
Accuracy for imgs = 0.8067226890756303 and Accuracy for txts = 0.8655462184873949 
test Loss: 0.0198 Img2Txt: 0.8139  Txt2Img: 0.8422

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9351464435146443 and Accuracy for txts = 0.899581589958159 
train Loss: 0.0140 Img2Txt: 0.7901  Txt2Img: 0.8324
test
Accuracy for imgs = 0.7899159663865546 and Accuracy for txts = 0.8739495798319328 
test Loss: 0.0194 Img2Txt: 0.7979  Txt2Img: 0.8447

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9497907949790794 and Accuracy for txts = 0.8953974895397488 
train Loss: 0.0135 Img2Txt: 0.7786  Txt2Img: 0.8330
test
Accuracy for imgs = 0.7983193277310924 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0201 Img2Txt: 0.8011  Txt2Img: 0.8493

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9665271966527196 and Accuracy for txts = 0.9121338912133891 
train Loss: 0.0128 Img2Txt: 0.7810  Txt2Img: 0.8235
test
Accuracy for imgs = 0.7983193277310924 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0191 Img2Txt: 0.8049  Txt2Img: 0.8510

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9623430962343096 and Accuracy for txts = 0.9142259414225941 
train Loss: 0.0124 Img2Txt: 0.8104  Txt2Img: 0.8481
test
Accuracy for imgs = 0.8487394957983193 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0193 Img2Txt: 0.8415  Txt2Img: 0.8618

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9644351464435146 and Accuracy for txts = 0.9121338912133891 
train Loss: 0.0121 Img2Txt: 0.7690  Txt2Img: 0.8215
test
Accuracy for imgs = 0.8235294117647058 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0190 Img2Txt: 0.8158  Txt2Img: 0.8498

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9686192468619246 and Accuracy for txts = 0.9163179916317991 
train Loss: 0.0125 Img2Txt: 0.8047  Txt2Img: 0.8176
test
Accuracy for imgs = 0.8319327731092436 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0184 Img2Txt: 0.8155  Txt2Img: 0.8476

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9644351464435146 and Accuracy for txts = 0.9142259414225941 
train Loss: 0.0122 Img2Txt: 0.8166  Txt2Img: 0.8515
test
Accuracy for imgs = 0.8487394957983193 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0197 Img2Txt: 0.8228  Txt2Img: 0.8544

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9832635983263598 and Accuracy for txts = 0.9205020920502092 
train Loss: 0.0113 Img2Txt: 0.7729  Txt2Img: 0.8264
test
Accuracy for imgs = 0.7983193277310924 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0187 Img2Txt: 0.7966  Txt2Img: 0.8421

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9958158995815899 and Accuracy for txts = 0.918410041841004 
train Loss: 0.0119 Img2Txt: 0.7793  Txt2Img: 0.8160
test
Accuracy for imgs = 0.8487394957983193 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0178 Img2Txt: 0.8221  Txt2Img: 0.8473

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9853556485355648 and Accuracy for txts = 0.9309623430962343 
train Loss: 0.0113 Img2Txt: 0.7997  Txt2Img: 0.8275
test
Accuracy for imgs = 0.8487394957983193 and Accuracy for txts = 0.8907563025210083 
test Loss: 0.0187 Img2Txt: 0.8258  Txt2Img: 0.8592

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9916317991631798 and Accuracy for txts = 0.9309623430962343 
train Loss: 0.0111 Img2Txt: 0.7827  Txt2Img: 0.8219
test
Accuracy for imgs = 0.8235294117647058 and Accuracy for txts = 0.8907563025210083 
test Loss: 0.0183 Img2Txt: 0.7959  Txt2Img: 0.8517

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9874476987447698 and Accuracy for txts = 0.9309623430962343 
train Loss: 0.0108 Img2Txt: 0.7805  Txt2Img: 0.8226
test
Accuracy for imgs = 0.8487394957983193 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0180 Img2Txt: 0.8191  Txt2Img: 0.8555

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9895397489539748 and Accuracy for txts = 0.9330543933054393 
train Loss: 0.0110 Img2Txt: 0.8046  Txt2Img: 0.8440
test
Accuracy for imgs = 0.8319327731092436 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0174 Img2Txt: 0.8268  Txt2Img: 0.8618

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9937238493723849 and Accuracy for txts = 0.9330543933054393 
train Loss: 0.0105 Img2Txt: 0.7724  Txt2Img: 0.8231
test
Accuracy for imgs = 0.8319327731092436 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0172 Img2Txt: 0.8131  Txt2Img: 0.8419

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9916317991631798 and Accuracy for txts = 0.9351464435146443 
train Loss: 0.0108 Img2Txt: 0.8027  Txt2Img: 0.8298
test
Accuracy for imgs = 0.8235294117647058 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0181 Img2Txt: 0.8165  Txt2Img: 0.8515

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9958158995815899 and Accuracy for txts = 0.9351464435146443 
train Loss: 0.0100 Img2Txt: 0.7900  Txt2Img: 0.8460
test
Accuracy for imgs = 0.8403361344537815 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0178 Img2Txt: 0.8178  Txt2Img: 0.8540

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9979079497907949 and Accuracy for txts = 0.9330543933054393 
train Loss: 0.0103 Img2Txt: 0.7912  Txt2Img: 0.8139
test
Accuracy for imgs = 0.8067226890756303 and Accuracy for txts = 0.8823529411764706 
test Loss: 0.0172 Img2Txt: 0.7985  Txt2Img: 0.8511

Training complete in 18m 58s
Best average mAP: 0.851667
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2539  Txt2Img: 0.2142
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.3929  Txt2Img: 0.3910
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3217  Txt2Img: 0.3368
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2902  Txt2Img: 0.2429
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.5200  Txt2Img: 0.5021
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.7985  Txt2Img: 0.8511
Testing Done...............
Selected dataset for training is 7..........
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Training for dataset 7 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.0425531914893617 and Accuracy for txts = 0.03404255319148936 
train Loss: 0.0375 Img2Txt: 0.1763  Txt2Img: 0.1762
test
Accuracy for imgs = 0.10256410256410257 and Accuracy for txts = 0.25641025641025644 
test Loss: 0.0332 Img2Txt: 0.2056  Txt2Img: 0.1773

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.1574468085106383 and Accuracy for txts = 0.3170212765957447 
train Loss: 0.0324 Img2Txt: 0.1832  Txt2Img: 0.1835
test
Accuracy for imgs = 0.2136752136752137 and Accuracy for txts = 0.47008547008547014 
test Loss: 0.0311 Img2Txt: 0.2117  Txt2Img: 0.2091

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.2765957446808511 and Accuracy for txts = 0.44255319148936173 
train Loss: 0.0305 Img2Txt: 0.2375  Txt2Img: 0.2749
test
Accuracy for imgs = 0.33333333333333337 and Accuracy for txts = 0.5470085470085471 
test Loss: 0.0294 Img2Txt: 0.2945  Txt2Img: 0.3015

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.3574468085106383 and Accuracy for txts = 0.4702127659574468 
train Loss: 0.0289 Img2Txt: 0.2937  Txt2Img: 0.3374
test
Accuracy for imgs = 0.4273504273504274 and Accuracy for txts = 0.5811965811965812 
test Loss: 0.0281 Img2Txt: 0.3455  Txt2Img: 0.3924

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.425531914893617 and Accuracy for txts = 0.48936170212765956 
train Loss: 0.0274 Img2Txt: 0.3432  Txt2Img: 0.3978
test
Accuracy for imgs = 0.46153846153846156 and Accuracy for txts = 0.5897435897435898 
test Loss: 0.0273 Img2Txt: 0.3794  Txt2Img: 0.4454

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.48936170212765956 and Accuracy for txts = 0.5234042553191489 
train Loss: 0.0264 Img2Txt: 0.3740  Txt2Img: 0.4332
test
Accuracy for imgs = 0.4786324786324787 and Accuracy for txts = 0.5726495726495727 
test Loss: 0.0271 Img2Txt: 0.4158  Txt2Img: 0.4837

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.5872340425531914 and Accuracy for txts = 0.5170212765957447 
train Loss: 0.0256 Img2Txt: 0.3561  Txt2Img: 0.4541
test
Accuracy for imgs = 0.4957264957264958 and Accuracy for txts = 0.6153846153846154 
test Loss: 0.0268 Img2Txt: 0.4063  Txt2Img: 0.5086

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.6319148936170212 and Accuracy for txts = 0.5617021276595745 
train Loss: 0.0250 Img2Txt: 0.4259  Txt2Img: 0.4993
test
Accuracy for imgs = 0.5042735042735044 and Accuracy for txts = 0.6410256410256411 
test Loss: 0.0267 Img2Txt: 0.4460  Txt2Img: 0.5156

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.6574468085106383 and Accuracy for txts = 0.5765957446808511 
train Loss: 0.0242 Img2Txt: 0.4320  Txt2Img: 0.5020
test
Accuracy for imgs = 0.5213675213675214 and Accuracy for txts = 0.6666666666666667 
test Loss: 0.0265 Img2Txt: 0.4413  Txt2Img: 0.5233

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.7085106382978723 and Accuracy for txts = 0.597872340425532 
train Loss: 0.0234 Img2Txt: 0.4486  Txt2Img: 0.5031
test
Accuracy for imgs = 0.5299145299145299 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0262 Img2Txt: 0.4567  Txt2Img: 0.5358

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.7595744680851064 and Accuracy for txts = 0.6148936170212767 
train Loss: 0.0228 Img2Txt: 0.4665  Txt2Img: 0.5302
test
Accuracy for imgs = 0.5470085470085471 and Accuracy for txts = 0.6923076923076924 
test Loss: 0.0259 Img2Txt: 0.4751  Txt2Img: 0.5446

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.7914893617021277 and Accuracy for txts = 0.6234042553191489 
train Loss: 0.0220 Img2Txt: 0.4865  Txt2Img: 0.5432
test
Accuracy for imgs = 0.5555555555555556 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0256 Img2Txt: 0.4773  Txt2Img: 0.5448

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.8191489361702128 and Accuracy for txts = 0.6234042553191489 
train Loss: 0.0214 Img2Txt: 0.4875  Txt2Img: 0.5133
test
Accuracy for imgs = 0.5982905982905984 and Accuracy for txts = 0.6837606837606838 
test Loss: 0.0254 Img2Txt: 0.5051  Txt2Img: 0.5513

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.8404255319148937 and Accuracy for txts = 0.6404255319148936 
train Loss: 0.0208 Img2Txt: 0.5261  Txt2Img: 0.5436
test
Accuracy for imgs = 0.5897435897435898 and Accuracy for txts = 0.6923076923076924 
test Loss: 0.0253 Img2Txt: 0.5281  Txt2Img: 0.5719

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.8680851063829788 and Accuracy for txts = 0.6553191489361703 
train Loss: 0.0201 Img2Txt: 0.5222  Txt2Img: 0.5362
test
Accuracy for imgs = 0.5811965811965812 and Accuracy for txts = 0.6923076923076924 
test Loss: 0.0255 Img2Txt: 0.5220  Txt2Img: 0.5609

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.902127659574468 and Accuracy for txts = 0.6617021276595745 
train Loss: 0.0195 Img2Txt: 0.5276  Txt2Img: 0.5325
test
Accuracy for imgs = 0.623931623931624 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0254 Img2Txt: 0.5476  Txt2Img: 0.5809

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9297872340425533 and Accuracy for txts = 0.6829787234042554 
train Loss: 0.0189 Img2Txt: 0.5241  Txt2Img: 0.5458
test
Accuracy for imgs = 0.5982905982905984 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0254 Img2Txt: 0.5440  Txt2Img: 0.5658

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9297872340425533 and Accuracy for txts = 0.6893617021276596 
train Loss: 0.0184 Img2Txt: 0.5371  Txt2Img: 0.5631
test
Accuracy for imgs = 0.6324786324786326 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0247 Img2Txt: 0.5527  Txt2Img: 0.5849

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9468085106382979 and Accuracy for txts = 0.6808510638297872 
train Loss: 0.0181 Img2Txt: 0.5195  Txt2Img: 0.5492
test
Accuracy for imgs = 0.5982905982905984 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0249 Img2Txt: 0.5487  Txt2Img: 0.5787

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9574468085106383 and Accuracy for txts = 0.6978723404255319 
train Loss: 0.0178 Img2Txt: 0.5325  Txt2Img: 0.5578
test
Accuracy for imgs = 0.5897435897435898 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0250 Img2Txt: 0.5528  Txt2Img: 0.5839

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9659574468085107 and Accuracy for txts = 0.6893617021276596 
train Loss: 0.0172 Img2Txt: 0.5477  Txt2Img: 0.5508
test
Accuracy for imgs = 0.6581196581196582 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0246 Img2Txt: 0.5642  Txt2Img: 0.5844

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9638297872340426 and Accuracy for txts = 0.7063829787234043 
train Loss: 0.0167 Img2Txt: 0.5417  Txt2Img: 0.5701
test
Accuracy for imgs = 0.5811965811965812 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0245 Img2Txt: 0.5675  Txt2Img: 0.5854

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9765957446808511 and Accuracy for txts = 0.7042553191489361 
train Loss: 0.0164 Img2Txt: 0.5422  Txt2Img: 0.5751
test
Accuracy for imgs = 0.623931623931624 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0235 Img2Txt: 0.5755  Txt2Img: 0.5875

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9787234042553191 and Accuracy for txts = 0.7127659574468085 
train Loss: 0.0161 Img2Txt: 0.5329  Txt2Img: 0.5645
test
Accuracy for imgs = 0.6068376068376069 and Accuracy for txts = 0.6923076923076924 
test Loss: 0.0249 Img2Txt: 0.5461  Txt2Img: 0.5845

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9787234042553191 and Accuracy for txts = 0.723404255319149 
train Loss: 0.0160 Img2Txt: 0.5459  Txt2Img: 0.5678
test
Accuracy for imgs = 0.6068376068376069 and Accuracy for txts = 0.7008547008547009 
test Loss: 0.0249 Img2Txt: 0.5536  Txt2Img: 0.5948

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9829787234042553 and Accuracy for txts = 0.725531914893617 
train Loss: 0.0156 Img2Txt: 0.5378  Txt2Img: 0.5606
test
Accuracy for imgs = 0.5982905982905984 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0242 Img2Txt: 0.5681  Txt2Img: 0.6032

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9829787234042553 and Accuracy for txts = 0.7361702127659575 
train Loss: 0.0154 Img2Txt: 0.5435  Txt2Img: 0.5585
test
Accuracy for imgs = 0.6324786324786326 and Accuracy for txts = 0.6923076923076924 
test Loss: 0.0237 Img2Txt: 0.5692  Txt2Img: 0.5948

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9851063829787234 and Accuracy for txts = 0.7382978723404255 
train Loss: 0.0152 Img2Txt: 0.5268  Txt2Img: 0.5568
test
Accuracy for imgs = 0.5811965811965812 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0231 Img2Txt: 0.5672  Txt2Img: 0.5767

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9893617021276596 and Accuracy for txts = 0.7404255319148936 
train Loss: 0.0149 Img2Txt: 0.5320  Txt2Img: 0.5541
test
Accuracy for imgs = 0.5726495726495727 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0243 Img2Txt: 0.5612  Txt2Img: 0.5656

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9872340425531915 and Accuracy for txts = 0.7468085106382979 
train Loss: 0.0148 Img2Txt: 0.5479  Txt2Img: 0.5793
test
Accuracy for imgs = 0.6410256410256411 and Accuracy for txts = 0.7094017094017094 
test Loss: 0.0233 Img2Txt: 0.5805  Txt2Img: 0.6050

Training complete in 18m 34s
Best average mAP: 0.592795
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.3039  Txt2Img: 0.2632
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.3517  Txt2Img: 0.3165
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2931  Txt2Img: 0.2659
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2472  Txt2Img: 0.2408
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.4102  Txt2Img: 0.3601
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.7106  Txt2Img: 0.6853
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.5805  Txt2Img: 0.6050
Testing Done...............
Selected dataset for training is 8..........
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Training for dataset 8 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.09224318658280922 and Accuracy for txts = 0.07547169811320756 
train Loss: 0.0358 Img2Txt: 0.2471  Txt2Img: 0.2356
test
Accuracy for imgs = 0.2857142857142857 and Accuracy for txts = 0.3445378151260504 
test Loss: 0.0313 Img2Txt: 0.2977  Txt2Img: 0.2632

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.2536687631027254 and Accuracy for txts = 0.28511530398322854 
train Loss: 0.0313 Img2Txt: 0.3331  Txt2Img: 0.2893
test
Accuracy for imgs = 0.38655462184873945 and Accuracy for txts = 0.5966386554621849 
test Loss: 0.0285 Img2Txt: 0.3693  Txt2Img: 0.3034

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.36058700209643607 and Accuracy for txts = 0.49056603773584906 
train Loss: 0.0290 Img2Txt: 0.3887  Txt2Img: 0.3430
test
Accuracy for imgs = 0.5042016806722689 and Accuracy for txts = 0.6554621848739496 
test Loss: 0.0268 Img2Txt: 0.4316  Txt2Img: 0.3636

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.48218029350104824 and Accuracy for txts = 0.6016771488469602 
train Loss: 0.0269 Img2Txt: 0.4545  Txt2Img: 0.4420
test
Accuracy for imgs = 0.5462184873949579 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0256 Img2Txt: 0.4760  Txt2Img: 0.4424

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5471698113207547 and Accuracy for txts = 0.6708595387840671 
train Loss: 0.0252 Img2Txt: 0.5091  Txt2Img: 0.4993
test
Accuracy for imgs = 0.6050420168067226 and Accuracy for txts = 0.7310924369747899 
test Loss: 0.0252 Img2Txt: 0.5288  Txt2Img: 0.5169

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.6100628930817611 and Accuracy for txts = 0.7064989517819706 
train Loss: 0.0239 Img2Txt: 0.5595  Txt2Img: 0.5390
test
Accuracy for imgs = 0.6134453781512604 and Accuracy for txts = 0.7310924369747899 
test Loss: 0.0249 Img2Txt: 0.5891  Txt2Img: 0.5874

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.6729559748427674 and Accuracy for txts = 0.7442348008385745 
train Loss: 0.0227 Img2Txt: 0.5917  Txt2Img: 0.6073
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7731092436974789 
test Loss: 0.0240 Img2Txt: 0.6220  Txt2Img: 0.6205

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.729559748427673 and Accuracy for txts = 0.769392033542977 
train Loss: 0.0214 Img2Txt: 0.6110  Txt2Img: 0.6292
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7647058823529411 
test Loss: 0.0240 Img2Txt: 0.6312  Txt2Img: 0.6425

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.7924528301886793 and Accuracy for txts = 0.7756813417190777 
train Loss: 0.0204 Img2Txt: 0.6233  Txt2Img: 0.6261
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7731092436974789 
test Loss: 0.0232 Img2Txt: 0.6464  Txt2Img: 0.6569

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.8176100628930818 and Accuracy for txts = 0.8071278825995808 
train Loss: 0.0195 Img2Txt: 0.6142  Txt2Img: 0.6192
test
Accuracy for imgs = 0.6974789915966386 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0234 Img2Txt: 0.6435  Txt2Img: 0.6647

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8511530398322852 and Accuracy for txts = 0.8050314465408805 
train Loss: 0.0186 Img2Txt: 0.6387  Txt2Img: 0.6256
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0232 Img2Txt: 0.6492  Txt2Img: 0.6804

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.8784067085953879 and Accuracy for txts = 0.8238993710691824 
train Loss: 0.0178 Img2Txt: 0.6222  Txt2Img: 0.6271
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0229 Img2Txt: 0.6450  Txt2Img: 0.6720

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9245283018867925 and Accuracy for txts = 0.8322851153039833 
train Loss: 0.0169 Img2Txt: 0.6215  Txt2Img: 0.6540
test
Accuracy for imgs = 0.6638655462184874 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0219 Img2Txt: 0.6477  Txt2Img: 0.6858

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9308176100628931 and Accuracy for txts = 0.8385744234800839 
train Loss: 0.0167 Img2Txt: 0.6254  Txt2Img: 0.6439
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0228 Img2Txt: 0.6565  Txt2Img: 0.6887

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9329140461215933 and Accuracy for txts = 0.8448637316561846 
train Loss: 0.0158 Img2Txt: 0.6182  Txt2Img: 0.6448
test
Accuracy for imgs = 0.6890756302521008 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0221 Img2Txt: 0.6637  Txt2Img: 0.7012

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9538784067085955 and Accuracy for txts = 0.8469601677148847 
train Loss: 0.0153 Img2Txt: 0.6381  Txt2Img: 0.6601
test
Accuracy for imgs = 0.6638655462184874 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0225 Img2Txt: 0.6563  Txt2Img: 0.6887

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9580712788259959 and Accuracy for txts = 0.859538784067086 
train Loss: 0.0148 Img2Txt: 0.6234  Txt2Img: 0.6702
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0214 Img2Txt: 0.6664  Txt2Img: 0.7013

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9706498951781971 and Accuracy for txts = 0.8574423480083858 
train Loss: 0.0145 Img2Txt: 0.6480  Txt2Img: 0.6724
test
Accuracy for imgs = 0.6974789915966386 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0225 Img2Txt: 0.6613  Txt2Img: 0.7051

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9664570230607967 and Accuracy for txts = 0.8637316561844864 
train Loss: 0.0140 Img2Txt: 0.6383  Txt2Img: 0.6662
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0214 Img2Txt: 0.6573  Txt2Img: 0.6937

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.979035639412998 and Accuracy for txts = 0.859538784067086 
train Loss: 0.0141 Img2Txt: 0.6317  Txt2Img: 0.6511
test
Accuracy for imgs = 0.7058823529411764 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0216 Img2Txt: 0.6769  Txt2Img: 0.7104

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9748427672955975 and Accuracy for txts = 0.8700209643605871 
train Loss: 0.0133 Img2Txt: 0.6420  Txt2Img: 0.6778
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0210 Img2Txt: 0.6608  Txt2Img: 0.7056

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9769392033542977 and Accuracy for txts = 0.8763102725366877 
train Loss: 0.0134 Img2Txt: 0.6544  Txt2Img: 0.6815
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0217 Img2Txt: 0.6655  Txt2Img: 0.7057

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9874213836477987 and Accuracy for txts = 0.8867924528301887 
train Loss: 0.0127 Img2Txt: 0.6374  Txt2Img: 0.6733
test
Accuracy for imgs = 0.6974789915966386 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0210 Img2Txt: 0.6626  Txt2Img: 0.6947

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9874213836477987 and Accuracy for txts = 0.8846960167714886 
train Loss: 0.0125 Img2Txt: 0.6332  Txt2Img: 0.6737
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0208 Img2Txt: 0.6778  Txt2Img: 0.7192

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9832285115303984 and Accuracy for txts = 0.888888888888889 
train Loss: 0.0124 Img2Txt: 0.6274  Txt2Img: 0.6637
test
Accuracy for imgs = 0.6722689075630252 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0212 Img2Txt: 0.6551  Txt2Img: 0.6980

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9916142557651992 and Accuracy for txts = 0.888888888888889 
train Loss: 0.0123 Img2Txt: 0.6382  Txt2Img: 0.6724
test
Accuracy for imgs = 0.6638655462184874 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0215 Img2Txt: 0.6724  Txt2Img: 0.7105

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9853249475890986 and Accuracy for txts = 0.8972746331236898 
train Loss: 0.0122 Img2Txt: 0.6298  Txt2Img: 0.6823
test
Accuracy for imgs = 0.7058823529411764 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0202 Img2Txt: 0.6690  Txt2Img: 0.6956

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9853249475890986 and Accuracy for txts = 0.8951781970649896 
train Loss: 0.0128 Img2Txt: 0.6423  Txt2Img: 0.6928
test
Accuracy for imgs = 0.7142857142857143 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0211 Img2Txt: 0.6791  Txt2Img: 0.7221

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9916142557651992 and Accuracy for txts = 0.8972746331236898 
train Loss: 0.0115 Img2Txt: 0.6239  Txt2Img: 0.6567
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0205 Img2Txt: 0.6449  Txt2Img: 0.6989

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9916142557651992 and Accuracy for txts = 0.8972746331236898 
train Loss: 0.0117 Img2Txt: 0.6448  Txt2Img: 0.6994
test
Accuracy for imgs = 0.680672268907563 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0206 Img2Txt: 0.6848  Txt2Img: 0.7194

Training complete in 18m 56s
Best average mAP: 0.702108
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.3274  Txt2Img: 0.3049
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2777  Txt2Img: 0.2725
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2776  Txt2Img: 0.2159
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2473  Txt2Img: 0.2362
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.3775  Txt2Img: 0.3676
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.4223  Txt2Img: 0.4151
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.3997  Txt2Img: 0.4006
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.6848  Txt2Img: 0.7194
Testing Done...............
Selected dataset for training is 9..........
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Training for dataset 9 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.059196617336152224 and Accuracy for txts = 0.03382663847780127 
train Loss: 0.0383 Img2Txt: 0.2539  Txt2Img: 0.2033
test
Accuracy for imgs = 0.11764705882352941 and Accuracy for txts = 0.1764705882352941 
test Loss: 0.0330 Img2Txt: 0.2647  Txt2Img: 0.2087

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.17970401691331925 and Accuracy for txts = 0.24735729386892177 
train Loss: 0.0322 Img2Txt: 0.2760  Txt2Img: 0.2325
test
Accuracy for imgs = 0.2689075630252101 and Accuracy for txts = 0.5714285714285714 
test Loss: 0.0291 Img2Txt: 0.2710  Txt2Img: 0.2334

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.3044397463002114 and Accuracy for txts = 0.613107822410148 
train Loss: 0.0291 Img2Txt: 0.3990  Txt2Img: 0.3128
test
Accuracy for imgs = 0.47058823529411764 and Accuracy for txts = 0.7394957983193277 
test Loss: 0.0262 Img2Txt: 0.4042  Txt2Img: 0.3206

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.40591966173361527 and Accuracy for txts = 0.7484143763213531 
train Loss: 0.0265 Img2Txt: 0.5017  Txt2Img: 0.4689
test
Accuracy for imgs = 0.5714285714285714 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0240 Img2Txt: 0.5308  Txt2Img: 0.5075

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.5243128964059197 and Accuracy for txts = 0.8054968287526427 
train Loss: 0.0241 Img2Txt: 0.6190  Txt2Img: 0.5910
test
Accuracy for imgs = 0.7142857142857143 and Accuracy for txts = 0.8403361344537815 
test Loss: 0.0227 Img2Txt: 0.6637  Txt2Img: 0.6283

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.6405919661733616 and Accuracy for txts = 0.8520084566596194 
train Loss: 0.0221 Img2Txt: 0.6983  Txt2Img: 0.6830
test
Accuracy for imgs = 0.7983193277310924 and Accuracy for txts = 0.8655462184873949 
test Loss: 0.0213 Img2Txt: 0.7436  Txt2Img: 0.7157

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.718816067653277 and Accuracy for txts = 0.8858350951374208 
train Loss: 0.0205 Img2Txt: 0.7527  Txt2Img: 0.7265
test
Accuracy for imgs = 0.8235294117647058 and Accuracy for txts = 0.8991596638655461 
test Loss: 0.0204 Img2Txt: 0.7874  Txt2Img: 0.7524

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.7695560253699789 and Accuracy for txts = 0.9090909090909092 
train Loss: 0.0191 Img2Txt: 0.7768  Txt2Img: 0.7728
test
Accuracy for imgs = 0.8403361344537815 and Accuracy for txts = 0.8991596638655461 
test Loss: 0.0194 Img2Txt: 0.8165  Txt2Img: 0.8009

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.8287526427061311 and Accuracy for txts = 0.9133192389006343 
train Loss: 0.0179 Img2Txt: 0.8039  Txt2Img: 0.7828
test
Accuracy for imgs = 0.8655462184873949 and Accuracy for txts = 0.907563025210084 
test Loss: 0.0189 Img2Txt: 0.8330  Txt2Img: 0.8174

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.8668076109936576 and Accuracy for txts = 0.9217758985200846 
train Loss: 0.0169 Img2Txt: 0.8131  Txt2Img: 0.7962
test
Accuracy for imgs = 0.8739495798319328 and Accuracy for txts = 0.907563025210084 
test Loss: 0.0184 Img2Txt: 0.8375  Txt2Img: 0.8178

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.8752642706131079 and Accuracy for txts = 0.9260042283298098 
train Loss: 0.0160 Img2Txt: 0.8249  Txt2Img: 0.8288
test
Accuracy for imgs = 0.8991596638655461 and Accuracy for txts = 0.8907563025210083 
test Loss: 0.0186 Img2Txt: 0.8554  Txt2Img: 0.8428

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.9069767441860466 and Accuracy for txts = 0.9281183932346724 
train Loss: 0.0152 Img2Txt: 0.8507  Txt2Img: 0.8359
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.907563025210084 
test Loss: 0.0177 Img2Txt: 0.8660  Txt2Img: 0.8562

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.9217758985200846 and Accuracy for txts = 0.9344608879492601 
train Loss: 0.0143 Img2Txt: 0.8561  Txt2Img: 0.8554
test
Accuracy for imgs = 0.9159663865546218 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0174 Img2Txt: 0.8662  Txt2Img: 0.8603

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.9365750528541227 and Accuracy for txts = 0.9344608879492601 
train Loss: 0.0136 Img2Txt: 0.8471  Txt2Img: 0.8374
test
Accuracy for imgs = 0.8991596638655461 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0174 Img2Txt: 0.8691  Txt2Img: 0.8697

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.9513742071881607 and Accuracy for txts = 0.9323467230443975 
train Loss: 0.0134 Img2Txt: 0.8420  Txt2Img: 0.8511
test
Accuracy for imgs = 0.9159663865546218 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0175 Img2Txt: 0.8728  Txt2Img: 0.8711

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.9534883720930233 and Accuracy for txts = 0.9386892177589853 
train Loss: 0.0130 Img2Txt: 0.8642  Txt2Img: 0.8663
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0167 Img2Txt: 0.8658  Txt2Img: 0.8781

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9640591966173362 and Accuracy for txts = 0.9408033826638478 
train Loss: 0.0126 Img2Txt: 0.8611  Txt2Img: 0.8771
test
Accuracy for imgs = 0.9243697478991596 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0170 Img2Txt: 0.8902  Txt2Img: 0.8914

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.9682875264270614 and Accuracy for txts = 0.9429175475687104 
train Loss: 0.0118 Img2Txt: 0.8688  Txt2Img: 0.8777
test
Accuracy for imgs = 0.9243697478991596 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0163 Img2Txt: 0.8870  Txt2Img: 0.8954

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9830866807610994 and Accuracy for txts = 0.9429175475687104 
train Loss: 0.0116 Img2Txt: 0.8701  Txt2Img: 0.8700
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0171 Img2Txt: 0.8905  Txt2Img: 0.8945

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9661733615221988 and Accuracy for txts = 0.945031712473573 
train Loss: 0.0114 Img2Txt: 0.8779  Txt2Img: 0.8913
test
Accuracy for imgs = 0.8991596638655461 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0162 Img2Txt: 0.8833  Txt2Img: 0.8924

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9830866807610994 and Accuracy for txts = 0.9429175475687104 
train Loss: 0.0117 Img2Txt: 0.8490  Txt2Img: 0.8808
test
Accuracy for imgs = 0.9159663865546218 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0169 Img2Txt: 0.8885  Txt2Img: 0.8981

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9830866807610994 and Accuracy for txts = 0.9471458773784356 
train Loss: 0.0111 Img2Txt: 0.8550  Txt2Img: 0.8843
test
Accuracy for imgs = 0.8739495798319328 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0160 Img2Txt: 0.8731  Txt2Img: 0.8925

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9936575052854123 and Accuracy for txts = 0.945031712473573 
train Loss: 0.0114 Img2Txt: 0.8653  Txt2Img: 0.8963
test
Accuracy for imgs = 0.9495798319327731 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0157 Img2Txt: 0.9017  Txt2Img: 0.9078

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9915433403805497 and Accuracy for txts = 0.9471458773784356 
train Loss: 0.0105 Img2Txt: 0.8796  Txt2Img: 0.8922
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0167 Img2Txt: 0.8965  Txt2Img: 0.8959

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.985200845665962 and Accuracy for txts = 0.945031712473573 
train Loss: 0.0108 Img2Txt: 0.8756  Txt2Img: 0.9000
test
Accuracy for imgs = 0.9159663865546218 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0157 Img2Txt: 0.8906  Txt2Img: 0.9049

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9936575052854123 and Accuracy for txts = 0.945031712473573 
train Loss: 0.0105 Img2Txt: 0.8656  Txt2Img: 0.8911
test
Accuracy for imgs = 0.9243697478991596 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0163 Img2Txt: 0.8939  Txt2Img: 0.9028

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9936575052854123 and Accuracy for txts = 0.9513742071881607 
train Loss: 0.0100 Img2Txt: 0.8771  Txt2Img: 0.9003
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0153 Img2Txt: 0.8879  Txt2Img: 0.9058

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9957716701902749 and Accuracy for txts = 0.9513742071881607 
train Loss: 0.0108 Img2Txt: 0.8727  Txt2Img: 0.8961
test
Accuracy for imgs = 0.907563025210084 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0160 Img2Txt: 0.8836  Txt2Img: 0.8982

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9978858350951375 and Accuracy for txts = 0.9471458773784356 
train Loss: 0.0103 Img2Txt: 0.8932  Txt2Img: 0.9020
test
Accuracy for imgs = 0.9411764705882353 and Accuracy for txts = 0.9159663865546218 
test Loss: 0.0157 Img2Txt: 0.9122  Txt2Img: 0.9064

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9957716701902749 and Accuracy for txts = 0.9492600422832982 
train Loss: 0.0099 Img2Txt: 0.8613  Txt2Img: 0.8987
test
Accuracy for imgs = 0.8991596638655461 and Accuracy for txts = 0.9243697478991596 
test Loss: 0.0155 Img2Txt: 0.8824  Txt2Img: 0.9100

Training complete in 18m 46s
Best average mAP: 0.909299
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.3130  Txt2Img: 0.2101
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.3251  Txt2Img: 0.2977
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2321  Txt2Img: 0.2055
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1693  Txt2Img: 0.1519
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.4343  Txt2Img: 0.3523
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.4048  Txt2Img: 0.3769
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.3145  Txt2Img: 0.2956
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.4109  Txt2Img: 0.3854
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.8824  Txt2Img: 0.9100
Testing Done...............
Selected dataset for training is 10..........
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Training for dataset 10 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.0711297071129707 and Accuracy for txts = 0.1527196652719665 
train Loss: 0.0351 Img2Txt: 0.2749  Txt2Img: 0.2366
test
Accuracy for imgs = 0.2 and Accuracy for txts = 0.525 
test Loss: 0.0300 Img2Txt: 0.3070  Txt2Img: 0.2531

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.202928870292887 and Accuracy for txts = 0.502092050209205 
train Loss: 0.0297 Img2Txt: 0.3464  Txt2Img: 0.3300
test
Accuracy for imgs = 0.2916666666666667 and Accuracy for txts = 0.65 
test Loss: 0.0271 Img2Txt: 0.3638  Txt2Img: 0.3317

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.2845188284518828 and Accuracy for txts = 0.6527196652719665 
train Loss: 0.0270 Img2Txt: 0.4237  Txt2Img: 0.4208
test
Accuracy for imgs = 0.39166666666666666 and Accuracy for txts = 0.7 
test Loss: 0.0256 Img2Txt: 0.4633  Txt2Img: 0.4359

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.3849372384937238 and Accuracy for txts = 0.6841004184100418 
train Loss: 0.0252 Img2Txt: 0.4950  Txt2Img: 0.5151
test
Accuracy for imgs = 0.5083333333333333 and Accuracy for txts = 0.7333333333333333 
test Loss: 0.0241 Img2Txt: 0.5375  Txt2Img: 0.5097

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.4644351464435146 and Accuracy for txts = 0.7196652719665272 
train Loss: 0.0236 Img2Txt: 0.5762  Txt2Img: 0.5741
test
Accuracy for imgs = 0.6083333333333333 and Accuracy for txts = 0.7583333333333333 
test Loss: 0.0233 Img2Txt: 0.6129  Txt2Img: 0.5567

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.5606694560669455 and Accuracy for txts = 0.7280334728033472 
train Loss: 0.0223 Img2Txt: 0.6256  Txt2Img: 0.5872
test
Accuracy for imgs = 0.6166666666666667 and Accuracy for txts = 0.7583333333333333 
test Loss: 0.0230 Img2Txt: 0.6415  Txt2Img: 0.5988

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.6192468619246861 and Accuracy for txts = 0.7468619246861924 
train Loss: 0.0212 Img2Txt: 0.6306  Txt2Img: 0.6032
test
Accuracy for imgs = 0.6166666666666667 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0233 Img2Txt: 0.6655  Txt2Img: 0.6091

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.6652719665271966 and Accuracy for txts = 0.7761506276150627 
train Loss: 0.0201 Img2Txt: 0.6694  Txt2Img: 0.6281
test
Accuracy for imgs = 0.6333333333333333 and Accuracy for txts = 0.825 
test Loss: 0.0223 Img2Txt: 0.6764  Txt2Img: 0.6322

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.7175732217573221 and Accuracy for txts = 0.7845188284518828 
train Loss: 0.0192 Img2Txt: 0.6750  Txt2Img: 0.6174
test
Accuracy for imgs = 0.6416666666666666 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0219 Img2Txt: 0.6950  Txt2Img: 0.6380

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.7343096234309623 and Accuracy for txts = 0.8158995815899581 
train Loss: 0.0183 Img2Txt: 0.6841  Txt2Img: 0.6468
test
Accuracy for imgs = 0.65 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0216 Img2Txt: 0.6945  Txt2Img: 0.6563

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.7866108786610878 and Accuracy for txts = 0.8200836820083681 
train Loss: 0.0177 Img2Txt: 0.6940  Txt2Img: 0.6626
test
Accuracy for imgs = 0.65 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0211 Img2Txt: 0.7040  Txt2Img: 0.6749

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.7866108786610878 and Accuracy for txts = 0.8493723849372384 
train Loss: 0.0168 Img2Txt: 0.6982  Txt2Img: 0.6860
test
Accuracy for imgs = 0.675 and Accuracy for txts = 0.85 
test Loss: 0.0208 Img2Txt: 0.7209  Txt2Img: 0.6944

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.8200836820083681 and Accuracy for txts = 0.8682008368200836 
train Loss: 0.0162 Img2Txt: 0.7144  Txt2Img: 0.6920
test
Accuracy for imgs = 0.675 and Accuracy for txts = 0.8583333333333333 
test Loss: 0.0210 Img2Txt: 0.7226  Txt2Img: 0.7000

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.8284518828451882 and Accuracy for txts = 0.8828451882845187 
train Loss: 0.0157 Img2Txt: 0.7059  Txt2Img: 0.7149
test
Accuracy for imgs = 0.6916666666666667 and Accuracy for txts = 0.875 
test Loss: 0.0207 Img2Txt: 0.7161  Txt2Img: 0.7108

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.8535564853556484 and Accuracy for txts = 0.8786610878661087 
train Loss: 0.0150 Img2Txt: 0.7069  Txt2Img: 0.7105
test
Accuracy for imgs = 0.6833333333333333 and Accuracy for txts = 0.9 
test Loss: 0.0198 Img2Txt: 0.7289  Txt2Img: 0.7202

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.8702928870292886 and Accuracy for txts = 0.8891213389121339 
train Loss: 0.0145 Img2Txt: 0.7143  Txt2Img: 0.7226
test
Accuracy for imgs = 0.7333333333333333 and Accuracy for txts = 0.8916666666666666 
test Loss: 0.0196 Img2Txt: 0.7408  Txt2Img: 0.7401

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.8807531380753137 and Accuracy for txts = 0.8891213389121339 
train Loss: 0.0147 Img2Txt: 0.7260  Txt2Img: 0.7445
test
Accuracy for imgs = 0.7083333333333334 and Accuracy for txts = 0.9083333333333333 
test Loss: 0.0200 Img2Txt: 0.7365  Txt2Img: 0.7520

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.8849372384937237 and Accuracy for txts = 0.8933054393305438 
train Loss: 0.0137 Img2Txt: 0.7323  Txt2Img: 0.7422
test
Accuracy for imgs = 0.6916666666666667 and Accuracy for txts = 0.9 
test Loss: 0.0191 Img2Txt: 0.7335  Txt2Img: 0.7375

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9121338912133891 and Accuracy for txts = 0.8974895397489538 
train Loss: 0.0139 Img2Txt: 0.7359  Txt2Img: 0.7386
test
Accuracy for imgs = 0.75 and Accuracy for txts = 0.9166666666666666 
test Loss: 0.0196 Img2Txt: 0.7500  Txt2Img: 0.7619

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9121338912133891 and Accuracy for txts = 0.8912133891213389 
train Loss: 0.0131 Img2Txt: 0.7406  Txt2Img: 0.7687
test
Accuracy for imgs = 0.7583333333333333 and Accuracy for txts = 0.9249999999999999 
test Loss: 0.0183 Img2Txt: 0.7549  Txt2Img: 0.7741

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9142259414225941 and Accuracy for txts = 0.899581589958159 
train Loss: 0.0131 Img2Txt: 0.7484  Txt2Img: 0.7772
test
Accuracy for imgs = 0.7666666666666666 and Accuracy for txts = 0.9249999999999999 
test Loss: 0.0190 Img2Txt: 0.7511  Txt2Img: 0.7772

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9288702928870292 and Accuracy for txts = 0.903765690376569 
train Loss: 0.0125 Img2Txt: 0.7153  Txt2Img: 0.7629
test
Accuracy for imgs = 0.7583333333333333 and Accuracy for txts = 0.9333333333333333 
test Loss: 0.0178 Img2Txt: 0.7410  Txt2Img: 0.7704

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9309623430962343 and Accuracy for txts = 0.903765690376569 
train Loss: 0.0130 Img2Txt: 0.7332  Txt2Img: 0.7785
test
Accuracy for imgs = 0.75 and Accuracy for txts = 0.9249999999999999 
test Loss: 0.0190 Img2Txt: 0.7497  Txt2Img: 0.7803

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9435146443514644 and Accuracy for txts = 0.907949790794979 
train Loss: 0.0119 Img2Txt: 0.7425  Txt2Img: 0.7617
test
Accuracy for imgs = 0.7833333333333333 and Accuracy for txts = 0.9333333333333333 
test Loss: 0.0181 Img2Txt: 0.7622  Txt2Img: 0.7889

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9435146443514644 and Accuracy for txts = 0.905857740585774 
train Loss: 0.0117 Img2Txt: 0.7408  Txt2Img: 0.7834
test
Accuracy for imgs = 0.775 and Accuracy for txts = 0.9333333333333333 
test Loss: 0.0177 Img2Txt: 0.7651  Txt2Img: 0.7856

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9602510460251045 and Accuracy for txts = 0.9142259414225941 
train Loss: 0.0113 Img2Txt: 0.7573  Txt2Img: 0.7761
test
Accuracy for imgs = 0.7833333333333333 and Accuracy for txts = 0.9416666666666667 
test Loss: 0.0179 Img2Txt: 0.7689  Txt2Img: 0.7911

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9602510460251045 and Accuracy for txts = 0.9121338912133891 
train Loss: 0.0114 Img2Txt: 0.7487  Txt2Img: 0.7885
test
Accuracy for imgs = 0.7833333333333333 and Accuracy for txts = 0.9333333333333333 
test Loss: 0.0178 Img2Txt: 0.7592  Txt2Img: 0.7900

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9560669456066945 and Accuracy for txts = 0.9100418410041841 
train Loss: 0.0111 Img2Txt: 0.7544  Txt2Img: 0.7894
test
Accuracy for imgs = 0.7833333333333333 and Accuracy for txts = 0.9416666666666667 
test Loss: 0.0179 Img2Txt: 0.7722  Txt2Img: 0.7948

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9602510460251045 and Accuracy for txts = 0.918410041841004 
train Loss: 0.0110 Img2Txt: 0.7684  Txt2Img: 0.8148
test
Accuracy for imgs = 0.8 and Accuracy for txts = 0.9416666666666667 
test Loss: 0.0174 Img2Txt: 0.7873  Txt2Img: 0.8000

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9602510460251045 and Accuracy for txts = 0.9163179916317991 
train Loss: 0.0107 Img2Txt: 0.7434  Txt2Img: 0.7745
test
Accuracy for imgs = 0.75 and Accuracy for txts = 0.9416666666666667 
test Loss: 0.0178 Img2Txt: 0.7430  Txt2Img: 0.7724

Training complete in 19m 19s
Best average mAP: 0.793604
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2040  Txt2Img: 0.1778
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2819  Txt2Img: 0.2646
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3024  Txt2Img: 0.2855
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1953  Txt2Img: 0.2104
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2903  Txt2Img: 0.2821
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.3128  Txt2Img: 0.2516
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2225  Txt2Img: 0.1932
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2889  Txt2Img: 0.2367
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.5303  Txt2Img: 0.5166
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.7430  Txt2Img: 0.7724
Testing Done...............
Selected dataset for training is 11..........
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Training for dataset 11 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.0650759219088937 and Accuracy for txts = 0.08026030368763558 
train Loss: 0.0380 Img2Txt: 0.2964  Txt2Img: 0.2558
test
Accuracy for imgs = 0.12068965517241378 and Accuracy for txts = 0.3620689655172414 
test Loss: 0.0327 Img2Txt: 0.3093  Txt2Img: 0.2615

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.12147505422993493 and Accuracy for txts = 0.3210412147505423 
train Loss: 0.0322 Img2Txt: 0.3158  Txt2Img: 0.2635
test
Accuracy for imgs = 0.2672413793103448 and Accuracy for txts = 0.7068965517241379 
test Loss: 0.0288 Img2Txt: 0.3403  Txt2Img: 0.2964

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.22342733188720174 and Accuracy for txts = 0.6637744034707158 
train Loss: 0.0295 Img2Txt: 0.4399  Txt2Img: 0.4038
test
Accuracy for imgs = 0.4396551724137931 and Accuracy for txts = 0.7586206896551724 
test Loss: 0.0257 Img2Txt: 0.4761  Txt2Img: 0.4291

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.3752711496746204 and Accuracy for txts = 0.7462039045553146 
train Loss: 0.0267 Img2Txt: 0.5563  Txt2Img: 0.5182
test
Accuracy for imgs = 0.5775862068965517 and Accuracy for txts = 0.8103448275862069 
test Loss: 0.0243 Img2Txt: 0.5817  Txt2Img: 0.5425

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.46203904555314534 and Accuracy for txts = 0.7700650759219089 
train Loss: 0.0248 Img2Txt: 0.6122  Txt2Img: 0.6016
test
Accuracy for imgs = 0.6206896551724138 and Accuracy for txts = 0.8620689655172413 
test Loss: 0.0226 Img2Txt: 0.6573  Txt2Img: 0.6337

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.5314533622559653 and Accuracy for txts = 0.8177874186550976 
train Loss: 0.0234 Img2Txt: 0.6496  Txt2Img: 0.6319
test
Accuracy for imgs = 0.6982758620689655 and Accuracy for txts = 0.8706896551724138 
test Loss: 0.0219 Img2Txt: 0.6834  Txt2Img: 0.6805

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.6095444685466378 and Accuracy for txts = 0.8351409978308026 
train Loss: 0.0218 Img2Txt: 0.7012  Txt2Img: 0.6721
test
Accuracy for imgs = 0.6637931034482758 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0220 Img2Txt: 0.7231  Txt2Img: 0.7082

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.648590021691974 and Accuracy for txts = 0.8481561822125814 
train Loss: 0.0211 Img2Txt: 0.7075  Txt2Img: 0.6999
test
Accuracy for imgs = 0.7586206896551724 and Accuracy for txts = 0.9051724137931034 
test Loss: 0.0210 Img2Txt: 0.7402  Txt2Img: 0.7299

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.6876355748373102 and Accuracy for txts = 0.8741865509761388 
train Loss: 0.0199 Img2Txt: 0.7375  Txt2Img: 0.7219
test
Accuracy for imgs = 0.7413793103448276 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0208 Img2Txt: 0.7687  Txt2Img: 0.7555

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.7245119305856833 and Accuracy for txts = 0.8741865509761388 
train Loss: 0.0189 Img2Txt: 0.7501  Txt2Img: 0.7422
test
Accuracy for imgs = 0.75 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0205 Img2Txt: 0.7776  Txt2Img: 0.7657

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.7700650759219089 and Accuracy for txts = 0.8937093275488069 
train Loss: 0.0183 Img2Txt: 0.7544  Txt2Img: 0.7328
test
Accuracy for imgs = 0.7672413793103449 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0206 Img2Txt: 0.7892  Txt2Img: 0.7824

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.7874186550976139 and Accuracy for txts = 0.8893709327548808 
train Loss: 0.0175 Img2Txt: 0.7440  Txt2Img: 0.7273
test
Accuracy for imgs = 0.7931034482758621 and Accuracy for txts = 0.8620689655172413 
test Loss: 0.0198 Img2Txt: 0.7923  Txt2Img: 0.7802

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.8308026030368764 and Accuracy for txts = 0.8915401301518439 
train Loss: 0.0168 Img2Txt: 0.7769  Txt2Img: 0.7753
test
Accuracy for imgs = 0.7758620689655172 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0198 Img2Txt: 0.7967  Txt2Img: 0.7947

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.8394793926247289 and Accuracy for txts = 0.8915401301518439 
train Loss: 0.0164 Img2Txt: 0.7652  Txt2Img: 0.7570
test
Accuracy for imgs = 0.8275862068965517 and Accuracy for txts = 0.8706896551724138 
test Loss: 0.0204 Img2Txt: 0.7975  Txt2Img: 0.7776

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.8611713665943601 and Accuracy for txts = 0.9023861171366595 
train Loss: 0.0157 Img2Txt: 0.7674  Txt2Img: 0.7638
test
Accuracy for imgs = 0.8103448275862069 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0198 Img2Txt: 0.8025  Txt2Img: 0.7741

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.8980477223427332 and Accuracy for txts = 0.8980477223427332 
train Loss: 0.0156 Img2Txt: 0.7668  Txt2Img: 0.7653
test
Accuracy for imgs = 0.7844827586206896 and Accuracy for txts = 0.853448275862069 
test Loss: 0.0198 Img2Txt: 0.8095  Txt2Img: 0.7900

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.9067245119305857 and Accuracy for txts = 0.9067245119305857 
train Loss: 0.0149 Img2Txt: 0.7841  Txt2Img: 0.7757
test
Accuracy for imgs = 0.8103448275862069 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0199 Img2Txt: 0.8077  Txt2Img: 0.7843

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.928416485900217 and Accuracy for txts = 0.913232104121475 
train Loss: 0.0144 Img2Txt: 0.7583  Txt2Img: 0.7419
test
Accuracy for imgs = 0.7758620689655172 and Accuracy for txts = 0.853448275862069 
test Loss: 0.0202 Img2Txt: 0.7966  Txt2Img: 0.7735

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.9197396963123644 and Accuracy for txts = 0.9045553145336226 
train Loss: 0.0143 Img2Txt: 0.7644  Txt2Img: 0.7572
test
Accuracy for imgs = 0.7672413793103449 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0194 Img2Txt: 0.7967  Txt2Img: 0.7865

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.9175704989154013 and Accuracy for txts = 0.911062906724512 
train Loss: 0.0140 Img2Txt: 0.7713  Txt2Img: 0.7541
test
Accuracy for imgs = 0.7931034482758621 and Accuracy for txts = 0.8620689655172413 
test Loss: 0.0198 Img2Txt: 0.7974  Txt2Img: 0.7784

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.9501084598698482 and Accuracy for txts = 0.9219088937093276 
train Loss: 0.0131 Img2Txt: 0.7844  Txt2Img: 0.7687
test
Accuracy for imgs = 0.8017241379310345 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0203 Img2Txt: 0.8075  Txt2Img: 0.7882

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.9522776572668114 and Accuracy for txts = 0.9175704989154013 
train Loss: 0.0131 Img2Txt: 0.7804  Txt2Img: 0.7516
test
Accuracy for imgs = 0.7758620689655172 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0187 Img2Txt: 0.8019  Txt2Img: 0.7796

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.9544468546637744 and Accuracy for txts = 0.9219088937093276 
train Loss: 0.0129 Img2Txt: 0.7879  Txt2Img: 0.7685
test
Accuracy for imgs = 0.8103448275862069 and Accuracy for txts = 0.896551724137931 
test Loss: 0.0205 Img2Txt: 0.8167  Txt2Img: 0.7924

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.9609544468546638 and Accuracy for txts = 0.9327548806941431 
train Loss: 0.0122 Img2Txt: 0.7820  Txt2Img: 0.7702
test
Accuracy for imgs = 0.7931034482758621 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0186 Img2Txt: 0.8056  Txt2Img: 0.7854

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.9652928416485901 and Accuracy for txts = 0.9240780911062907 
train Loss: 0.0122 Img2Txt: 0.7911  Txt2Img: 0.7899
test
Accuracy for imgs = 0.7758620689655172 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0187 Img2Txt: 0.8073  Txt2Img: 0.7998

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.9761388286334056 and Accuracy for txts = 0.9327548806941431 
train Loss: 0.0121 Img2Txt: 0.7493  Txt2Img: 0.7288
test
Accuracy for imgs = 0.7844827586206896 and Accuracy for txts = 0.896551724137931 
test Loss: 0.0187 Img2Txt: 0.7967  Txt2Img: 0.7831

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.9804772234273319 and Accuracy for txts = 0.9392624728850326 
train Loss: 0.0115 Img2Txt: 0.7691  Txt2Img: 0.7710
test
Accuracy for imgs = 0.8017241379310345 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0187 Img2Txt: 0.8172  Txt2Img: 0.7940

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.9804772234273319 and Accuracy for txts = 0.9327548806941431 
train Loss: 0.0115 Img2Txt: 0.7744  Txt2Img: 0.7698
test
Accuracy for imgs = 0.7931034482758621 and Accuracy for txts = 0.8879310344827586 
test Loss: 0.0185 Img2Txt: 0.8090  Txt2Img: 0.7924

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.9783080260303688 and Accuracy for txts = 0.9370932754880694 
train Loss: 0.0112 Img2Txt: 0.7755  Txt2Img: 0.7706
test
Accuracy for imgs = 0.7844827586206896 and Accuracy for txts = 0.896551724137931 
test Loss: 0.0185 Img2Txt: 0.8057  Txt2Img: 0.7823

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.9783080260303688 and Accuracy for txts = 0.9392624728850326 
train Loss: 0.0115 Img2Txt: 0.7824  Txt2Img: 0.7680
test
Accuracy for imgs = 0.8103448275862069 and Accuracy for txts = 0.8793103448275862 
test Loss: 0.0181 Img2Txt: 0.8186  Txt2Img: 0.7946

Training complete in 18m 19s
Best average mAP: 0.806580
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2815  Txt2Img: 0.2657
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2520  Txt2Img: 0.2575
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3928  Txt2Img: 0.3480
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2074  Txt2Img: 0.2039
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.3458  Txt2Img: 0.2973
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.3685  Txt2Img: 0.3218
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2202  Txt2Img: 0.2121
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2528  Txt2Img: 0.2110
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.4269  Txt2Img: 0.3779
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.4965  Txt2Img: 0.4991
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.8186  Txt2Img: 0.7946
Testing Done...............
Selected dataset for training is 12..........
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Training for dataset 12 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.08742004264392324 and Accuracy for txts = 0.07462686567164178 
train Loss: 0.0371 Img2Txt: 0.1564  Txt2Img: 0.1496
test
Accuracy for imgs = 0.15254237288135594 and Accuracy for txts = 0.2288135593220339 
test Loss: 0.0331 Img2Txt: 0.1623  Txt2Img: 0.1449

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.15778251599147122 and Accuracy for txts = 0.17057569296375266 
train Loss: 0.0334 Img2Txt: 0.1665  Txt2Img: 0.1569
test
Accuracy for imgs = 0.15254237288135594 and Accuracy for txts = 0.3813559322033898 
test Loss: 0.0316 Img2Txt: 0.1714  Txt2Img: 0.1638

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.19829424307036247 and Accuracy for txts = 0.27505330490405117 
train Loss: 0.0318 Img2Txt: 0.1667  Txt2Img: 0.1664
test
Accuracy for imgs = 0.16101694915254236 and Accuracy for txts = 0.4152542372881356 
test Loss: 0.0309 Img2Txt: 0.1872  Txt2Img: 0.1817

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.23667377398720682 and Accuracy for txts = 0.35607675906183367 
train Loss: 0.0308 Img2Txt: 0.1887  Txt2Img: 0.1760
test
Accuracy for imgs = 0.1864406779661017 and Accuracy for txts = 0.4406779661016949 
test Loss: 0.0302 Img2Txt: 0.2042  Txt2Img: 0.2042

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.30703624733475476 and Accuracy for txts = 0.4093816631130064 
train Loss: 0.0299 Img2Txt: 0.1835  Txt2Img: 0.1973
test
Accuracy for imgs = 0.211864406779661 and Accuracy for txts = 0.4576271186440678 
test Loss: 0.0297 Img2Txt: 0.2199  Txt2Img: 0.2160

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.3582089552238806 and Accuracy for txts = 0.47121535181236673 
train Loss: 0.0290 Img2Txt: 0.2066  Txt2Img: 0.2080
test
Accuracy for imgs = 0.2711864406779661 and Accuracy for txts = 0.4661016949152542 
test Loss: 0.0293 Img2Txt: 0.2392  Txt2Img: 0.2316

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.39872068230277186 and Accuracy for txts = 0.488272921108742 
train Loss: 0.0285 Img2Txt: 0.2190  Txt2Img: 0.2303
test
Accuracy for imgs = 0.3305084745762712 and Accuracy for txts = 0.4745762711864407 
test Loss: 0.0288 Img2Txt: 0.2516  Txt2Img: 0.2526

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.44562899786780386 and Accuracy for txts = 0.5074626865671642 
train Loss: 0.0276 Img2Txt: 0.2352  Txt2Img: 0.2346
test
Accuracy for imgs = 0.3305084745762712 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0287 Img2Txt: 0.2588  Txt2Img: 0.2676

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.47547974413646055 and Accuracy for txts = 0.5394456289978677 
train Loss: 0.0269 Img2Txt: 0.2326  Txt2Img: 0.2631
test
Accuracy for imgs = 0.3813559322033898 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0283 Img2Txt: 0.2608  Txt2Img: 0.2756

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.5223880597014925 and Accuracy for txts = 0.5565031982942431 
train Loss: 0.0263 Img2Txt: 0.2534  Txt2Img: 0.2533
test
Accuracy for imgs = 0.4067796610169492 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0280 Img2Txt: 0.2784  Txt2Img: 0.2948

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.5501066098081023 and Accuracy for txts = 0.579957356076759 
train Loss: 0.0257 Img2Txt: 0.2547  Txt2Img: 0.2593
test
Accuracy for imgs = 0.4152542372881356 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0278 Img2Txt: 0.2844  Txt2Img: 0.3001

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.5778251599147122 and Accuracy for txts = 0.5927505330490405 
train Loss: 0.0252 Img2Txt: 0.2491  Txt2Img: 0.2813
test
Accuracy for imgs = 0.4576271186440678 and Accuracy for txts = 0.5084745762711864 
test Loss: 0.0276 Img2Txt: 0.3005  Txt2Img: 0.3127

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.6162046908315565 and Accuracy for txts = 0.6076759061833689 
train Loss: 0.0245 Img2Txt: 0.2917  Txt2Img: 0.3138
test
Accuracy for imgs = 0.4915254237288136 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0273 Img2Txt: 0.3212  Txt2Img: 0.3312

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.6481876332622601 and Accuracy for txts = 0.6183368869936035 
train Loss: 0.0240 Img2Txt: 0.2857  Txt2Img: 0.2867
test
Accuracy for imgs = 0.4745762711864407 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0272 Img2Txt: 0.3337  Txt2Img: 0.3386

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.6801705756929637 and Accuracy for txts = 0.6226012793176973 
train Loss: 0.0234 Img2Txt: 0.2993  Txt2Img: 0.3175
test
Accuracy for imgs = 0.4915254237288136 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0269 Img2Txt: 0.3458  Txt2Img: 0.3578

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.7185501066098081 and Accuracy for txts = 0.6332622601279317 
train Loss: 0.0228 Img2Txt: 0.3007  Txt2Img: 0.3144
test
Accuracy for imgs = 0.4661016949152542 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0269 Img2Txt: 0.3560  Txt2Img: 0.3578

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.7377398720682302 and Accuracy for txts = 0.6311300639658849 
train Loss: 0.0224 Img2Txt: 0.3151  Txt2Img: 0.3521
test
Accuracy for imgs = 0.5254237288135594 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0267 Img2Txt: 0.3667  Txt2Img: 0.3673

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.7718550106609808 and Accuracy for txts = 0.6417910447761194 
train Loss: 0.0218 Img2Txt: 0.3146  Txt2Img: 0.3468
test
Accuracy for imgs = 0.5169491525423728 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0266 Img2Txt: 0.3714  Txt2Img: 0.3835

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.7718550106609808 and Accuracy for txts = 0.6545842217484008 
train Loss: 0.0214 Img2Txt: 0.2903  Txt2Img: 0.3298
test
Accuracy for imgs = 0.4915254237288136 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0267 Img2Txt: 0.3589  Txt2Img: 0.3623

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.7761194029850746 and Accuracy for txts = 0.6567164179104478 
train Loss: 0.0210 Img2Txt: 0.3019  Txt2Img: 0.3307
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0265 Img2Txt: 0.3678  Txt2Img: 0.3821

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.8059701492537313 and Accuracy for txts = 0.6716417910447761 
train Loss: 0.0207 Img2Txt: 0.3081  Txt2Img: 0.3434
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0265 Img2Txt: 0.3656  Txt2Img: 0.3832

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.7889125799573561 and Accuracy for txts = 0.6759061833688699 
train Loss: 0.0204 Img2Txt: 0.3100  Txt2Img: 0.3702
test
Accuracy for imgs = 0.5254237288135594 and Accuracy for txts = 0.5169491525423728 
test Loss: 0.0264 Img2Txt: 0.3774  Txt2Img: 0.4022

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.8059701492537313 and Accuracy for txts = 0.6844349680170576 
train Loss: 0.0201 Img2Txt: 0.3411  Txt2Img: 0.3659
test
Accuracy for imgs = 0.5 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0265 Img2Txt: 0.3749  Txt2Img: 0.3858

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.8294243070362474 and Accuracy for txts = 0.6823027718550106 
train Loss: 0.0195 Img2Txt: 0.3162  Txt2Img: 0.3449
test
Accuracy for imgs = 0.4915254237288136 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0264 Img2Txt: 0.3676  Txt2Img: 0.3854

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.8336886993603412 and Accuracy for txts = 0.6886993603411514 
train Loss: 0.0193 Img2Txt: 0.3198  Txt2Img: 0.3576
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0265 Img2Txt: 0.3737  Txt2Img: 0.3863

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.8507462686567164 and Accuracy for txts = 0.6865671641791045 
train Loss: 0.0191 Img2Txt: 0.2985  Txt2Img: 0.3483
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0264 Img2Txt: 0.3543  Txt2Img: 0.3940

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.8507462686567164 and Accuracy for txts = 0.6993603411513859 
train Loss: 0.0189 Img2Txt: 0.3232  Txt2Img: 0.3688
test
Accuracy for imgs = 0.5677966101694916 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0263 Img2Txt: 0.3689  Txt2Img: 0.4080

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.8614072494669509 and Accuracy for txts = 0.7036247334754797 
train Loss: 0.0186 Img2Txt: 0.3135  Txt2Img: 0.3393
test
Accuracy for imgs = 0.5169491525423728 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0262 Img2Txt: 0.3734  Txt2Img: 0.4049

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.8678038379530917 and Accuracy for txts = 0.7100213219616205 
train Loss: 0.0183 Img2Txt: 0.3237  Txt2Img: 0.3753
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.5254237288135594 
test Loss: 0.0266 Img2Txt: 0.3606  Txt2Img: 0.4018

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.8742004264392323 and Accuracy for txts = 0.7078891257995735 
train Loss: 0.0180 Img2Txt: 0.3297  Txt2Img: 0.3591
test
Accuracy for imgs = 0.559322033898305 and Accuracy for txts = 0.5423728813559322 
test Loss: 0.0260 Img2Txt: 0.3869  Txt2Img: 0.4176

Training complete in 18m 51s
Best average mAP: 0.402256
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2213  Txt2Img: 0.1782
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2254  Txt2Img: 0.1937
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3043  Txt2Img: 0.2433
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2092  Txt2Img: 0.1833
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.3294  Txt2Img: 0.2810
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.3051  Txt2Img: 0.2713
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2396  Txt2Img: 0.2379
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2179  Txt2Img: 0.1753
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.3091  Txt2Img: 0.2812
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.3650  Txt2Img: 0.3276
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.5656  Txt2Img: 0.5598
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.3869  Txt2Img: 0.4176
Testing Done...............
Selected dataset for training is 13..........
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Training for dataset 13 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.08176100628930819 and Accuracy for txts = 0.12368972746331237 
train Loss: 0.0352 Img2Txt: 0.1552  Txt2Img: 0.1459
test
Accuracy for imgs = 0.075 and Accuracy for txts = 0.15 
test Loss: 0.0333 Img2Txt: 0.1557  Txt2Img: 0.1586

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.15932914046121593 and Accuracy for txts = 0.13626834381551364 
train Loss: 0.0328 Img2Txt: 0.1482  Txt2Img: 0.1408
test
Accuracy for imgs = 0.058333333333333334 and Accuracy for txts = 0.24166666666666667 
test Loss: 0.0321 Img2Txt: 0.1582  Txt2Img: 0.1474

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.22012578616352202 and Accuracy for txts = 0.20964360587002098 
train Loss: 0.0318 Img2Txt: 0.1519  Txt2Img: 0.1641
test
Accuracy for imgs = 0.09166666666666666 and Accuracy for txts = 0.325 
test Loss: 0.0315 Img2Txt: 0.1621  Txt2Img: 0.1514

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.26624737945492666 and Accuracy for txts = 0.28511530398322854 
train Loss: 0.0309 Img2Txt: 0.1530  Txt2Img: 0.1494
test
Accuracy for imgs = 0.11666666666666667 and Accuracy for txts = 0.4083333333333333 
test Loss: 0.0311 Img2Txt: 0.1683  Txt2Img: 0.1573

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.2893081761006289 and Accuracy for txts = 0.350104821802935 
train Loss: 0.0302 Img2Txt: 0.1602  Txt2Img: 0.1506
test
Accuracy for imgs = 0.11666666666666667 and Accuracy for txts = 0.4583333333333333 
test Loss: 0.0307 Img2Txt: 0.1747  Txt2Img: 0.1631

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.33752620545073375 and Accuracy for txts = 0.39412997903563946 
train Loss: 0.0295 Img2Txt: 0.1641  Txt2Img: 0.1623
test
Accuracy for imgs = 0.125 and Accuracy for txts = 0.49166666666666664 
test Loss: 0.0305 Img2Txt: 0.1840  Txt2Img: 0.1597

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.37106918238993714 and Accuracy for txts = 0.44025157232704404 
train Loss: 0.0288 Img2Txt: 0.1708  Txt2Img: 0.1669
test
Accuracy for imgs = 0.15833333333333333 and Accuracy for txts = 0.525 
test Loss: 0.0303 Img2Txt: 0.1896  Txt2Img: 0.1680

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.41928721174004197 and Accuracy for txts = 0.46540880503144655 
train Loss: 0.0282 Img2Txt: 0.1798  Txt2Img: 0.1637
test
Accuracy for imgs = 0.2 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0300 Img2Txt: 0.2092  Txt2Img: 0.1770

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.4423480083857443 and Accuracy for txts = 0.4863731656184487 
train Loss: 0.0277 Img2Txt: 0.2044  Txt2Img: 0.1767
test
Accuracy for imgs = 0.2 and Accuracy for txts = 0.55 
test Loss: 0.0298 Img2Txt: 0.2200  Txt2Img: 0.1795

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.49056603773584906 and Accuracy for txts = 0.5094339622641509 
train Loss: 0.0270 Img2Txt: 0.2102  Txt2Img: 0.1820
test
Accuracy for imgs = 0.21666666666666667 and Accuracy for txts = 0.5583333333333333 
test Loss: 0.0297 Img2Txt: 0.2294  Txt2Img: 0.1855

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.5471698113207547 and Accuracy for txts = 0.5199161425576521 
train Loss: 0.0264 Img2Txt: 0.2134  Txt2Img: 0.1750
test
Accuracy for imgs = 0.20833333333333334 and Accuracy for txts = 0.5583333333333333 
test Loss: 0.0295 Img2Txt: 0.2260  Txt2Img: 0.1825

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.5513626834381552 and Accuracy for txts = 0.5241090146750524 
train Loss: 0.0258 Img2Txt: 0.2089  Txt2Img: 0.1820
test
Accuracy for imgs = 0.23333333333333334 and Accuracy for txts = 0.55 
test Loss: 0.0294 Img2Txt: 0.2249  Txt2Img: 0.1883

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.5723270440251572 and Accuracy for txts = 0.5303983228511531 
train Loss: 0.0253 Img2Txt: 0.2172  Txt2Img: 0.1941
test
Accuracy for imgs = 0.25 and Accuracy for txts = 0.55 
test Loss: 0.0291 Img2Txt: 0.2413  Txt2Img: 0.1930

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.6058700209643606 and Accuracy for txts = 0.5366876310272537 
train Loss: 0.0247 Img2Txt: 0.2212  Txt2Img: 0.1939
test
Accuracy for imgs = 0.275 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0292 Img2Txt: 0.2410  Txt2Img: 0.1965

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.6331236897274634 and Accuracy for txts = 0.5471698113207547 
train Loss: 0.0243 Img2Txt: 0.2199  Txt2Img: 0.1896
test
Accuracy for imgs = 0.2916666666666667 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0291 Img2Txt: 0.2521  Txt2Img: 0.1985

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.6373165618448637 and Accuracy for txts = 0.5576519916142558 
train Loss: 0.0239 Img2Txt: 0.2445  Txt2Img: 0.2111
test
Accuracy for imgs = 0.275 and Accuracy for txts = 0.55 
test Loss: 0.0287 Img2Txt: 0.2602  Txt2Img: 0.2141

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.6687631027253669 and Accuracy for txts = 0.5639412997903565 
train Loss: 0.0234 Img2Txt: 0.2356  Txt2Img: 0.1993
test
Accuracy for imgs = 0.30833333333333335 and Accuracy for txts = 0.55 
test Loss: 0.0286 Img2Txt: 0.2569  Txt2Img: 0.2140

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.6855345911949686 and Accuracy for txts = 0.5744234800838575 
train Loss: 0.0230 Img2Txt: 0.2433  Txt2Img: 0.2183
test
Accuracy for imgs = 0.30833333333333335 and Accuracy for txts = 0.55 
test Loss: 0.0285 Img2Txt: 0.2619  Txt2Img: 0.2127

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.6918238993710693 and Accuracy for txts = 0.5828092243186583 
train Loss: 0.0226 Img2Txt: 0.2647  Txt2Img: 0.2278
test
Accuracy for imgs = 0.3333333333333333 and Accuracy for txts = 0.55 
test Loss: 0.0285 Img2Txt: 0.2834  Txt2Img: 0.2249

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.7169811320754718 and Accuracy for txts = 0.5911949685534591 
train Loss: 0.0223 Img2Txt: 0.2553  Txt2Img: 0.2343
test
Accuracy for imgs = 0.3416666666666667 and Accuracy for txts = 0.55 
test Loss: 0.0281 Img2Txt: 0.2821  Txt2Img: 0.2456

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.7505241090146751 and Accuracy for txts = 0.6016771488469602 
train Loss: 0.0219 Img2Txt: 0.2563  Txt2Img: 0.2277
test
Accuracy for imgs = 0.35 and Accuracy for txts = 0.55 
test Loss: 0.0278 Img2Txt: 0.2905  Txt2Img: 0.2406

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.7421383647798743 and Accuracy for txts = 0.6100628930817611 
train Loss: 0.0216 Img2Txt: 0.2627  Txt2Img: 0.2354
test
Accuracy for imgs = 0.3333333333333333 and Accuracy for txts = 0.55 
test Loss: 0.0280 Img2Txt: 0.2821  Txt2Img: 0.2410

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.7672955974842768 and Accuracy for txts = 0.6163522012578617 
train Loss: 0.0213 Img2Txt: 0.2750  Txt2Img: 0.2465
test
Accuracy for imgs = 0.36666666666666664 and Accuracy for txts = 0.55 
test Loss: 0.0278 Img2Txt: 0.2922  Txt2Img: 0.2501

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.7882599580712789 and Accuracy for txts = 0.6205450733752621 
train Loss: 0.0209 Img2Txt: 0.2804  Txt2Img: 0.2382
test
Accuracy for imgs = 0.35833333333333334 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0277 Img2Txt: 0.3054  Txt2Img: 0.2558

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.8008385744234802 and Accuracy for txts = 0.6226415094339623 
train Loss: 0.0206 Img2Txt: 0.2678  Txt2Img: 0.2531
test
Accuracy for imgs = 0.3333333333333333 and Accuracy for txts = 0.5666666666666667 
test Loss: 0.0277 Img2Txt: 0.2850  Txt2Img: 0.2563

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.7819706498951783 and Accuracy for txts = 0.6247379454926625 
train Loss: 0.0204 Img2Txt: 0.2749  Txt2Img: 0.2512
test
Accuracy for imgs = 0.31666666666666665 and Accuracy for txts = 0.5666666666666667 
test Loss: 0.0275 Img2Txt: 0.3036  Txt2Img: 0.2628

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.8092243186582809 and Accuracy for txts = 0.628930817610063 
train Loss: 0.0201 Img2Txt: 0.2721  Txt2Img: 0.2608
test
Accuracy for imgs = 0.35833333333333334 and Accuracy for txts = 0.5666666666666667 
test Loss: 0.0276 Img2Txt: 0.2850  Txt2Img: 0.2610

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.8113207547169812 and Accuracy for txts = 0.6331236897274634 
train Loss: 0.0198 Img2Txt: 0.2752  Txt2Img: 0.2422
test
Accuracy for imgs = 0.35833333333333334 and Accuracy for txts = 0.5583333333333333 
test Loss: 0.0275 Img2Txt: 0.2939  Txt2Img: 0.2682

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.8155136268343816 and Accuracy for txts = 0.6352201257861636 
train Loss: 0.0196 Img2Txt: 0.2785  Txt2Img: 0.2629
test
Accuracy for imgs = 0.30833333333333335 and Accuracy for txts = 0.55 
test Loss: 0.0275 Img2Txt: 0.2927  Txt2Img: 0.2687

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.8113207547169812 and Accuracy for txts = 0.639412997903564 
train Loss: 0.0193 Img2Txt: 0.2881  Txt2Img: 0.2635
test
Accuracy for imgs = 0.35833333333333334 and Accuracy for txts = 0.55 
test Loss: 0.0274 Img2Txt: 0.3076  Txt2Img: 0.2755

Training complete in 19m 25s
Best average mAP: 0.291524
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2343  Txt2Img: 0.2505
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2291  Txt2Img: 0.2028
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.3053  Txt2Img: 0.2929
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1718  Txt2Img: 0.1443
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2525  Txt2Img: 0.2218
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2308  Txt2Img: 0.2092
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2095  Txt2Img: 0.1891
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.1798  Txt2Img: 0.1664
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.3155  Txt2Img: 0.2934
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2939  Txt2Img: 0.2439
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.4467  Txt2Img: 0.4188
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.2072  Txt2Img: 0.2060
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.3076  Txt2Img: 0.2755
Testing Done...............
Selected dataset for training is 14..........
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Training for dataset 14 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.08559498956158663 and Accuracy for txts = 0.12734864300626303 
train Loss: 0.0357 Img2Txt: 0.2287  Txt2Img: 0.1944
test
Accuracy for imgs = 0.225 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0305 Img2Txt: 0.2493  Txt2Img: 0.2004

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.1753653444676409 and Accuracy for txts = 0.45093945720250517 
train Loss: 0.0305 Img2Txt: 0.2860  Txt2Img: 0.2570
test
Accuracy for imgs = 0.3 and Accuracy for txts = 0.7333333333333333 
test Loss: 0.0270 Img2Txt: 0.3064  Txt2Img: 0.2684

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.2567849686847599 and Accuracy for txts = 0.6597077244258872 
train Loss: 0.0274 Img2Txt: 0.3509  Txt2Img: 0.3163
test
Accuracy for imgs = 0.35 and Accuracy for txts = 0.7833333333333333 
test Loss: 0.0255 Img2Txt: 0.3702  Txt2Img: 0.3037

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.30480167014613774 and Accuracy for txts = 0.7160751565762004 
train Loss: 0.0258 Img2Txt: 0.3707  Txt2Img: 0.3447
test
Accuracy for imgs = 0.36666666666666664 and Accuracy for txts = 0.85 
test Loss: 0.0251 Img2Txt: 0.4115  Txt2Img: 0.3351

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.36743215031315235 and Accuracy for txts = 0.7828810020876826 
train Loss: 0.0243 Img2Txt: 0.3997  Txt2Img: 0.3522
test
Accuracy for imgs = 0.4083333333333333 and Accuracy for txts = 0.8666666666666667 
test Loss: 0.0242 Img2Txt: 0.4456  Txt2Img: 0.3755

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.4154488517745302 and Accuracy for txts = 0.7933194154488517 
train Loss: 0.0233 Img2Txt: 0.4258  Txt2Img: 0.4071
test
Accuracy for imgs = 0.4 and Accuracy for txts = 0.8666666666666667 
test Loss: 0.0241 Img2Txt: 0.4503  Txt2Img: 0.4093

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.4822546972860125 and Accuracy for txts = 0.8183716075156575 
train Loss: 0.0223 Img2Txt: 0.4214  Txt2Img: 0.3974
test
Accuracy for imgs = 0.425 and Accuracy for txts = 0.875 
test Loss: 0.0232 Img2Txt: 0.4638  Txt2Img: 0.4292

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.4843423799582463 and Accuracy for txts = 0.8267223382045928 
train Loss: 0.0217 Img2Txt: 0.4606  Txt2Img: 0.4673
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.875 
test Loss: 0.0235 Img2Txt: 0.4866  Txt2Img: 0.4690

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.5511482254697285 and Accuracy for txts = 0.8308977035490605 
train Loss: 0.0208 Img2Txt: 0.4781  Txt2Img: 0.4730
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.8666666666666667 
test Loss: 0.0228 Img2Txt: 0.5206  Txt2Img: 0.4969

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.6221294363256784 and Accuracy for txts = 0.8496868475991648 
train Loss: 0.0202 Img2Txt: 0.5178  Txt2Img: 0.5133
test
Accuracy for imgs = 0.55 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0224 Img2Txt: 0.5620  Txt2Img: 0.5252

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.6534446764091857 and Accuracy for txts = 0.8559498956158663 
train Loss: 0.0193 Img2Txt: 0.5472  Txt2Img: 0.5604
test
Accuracy for imgs = 0.5916666666666667 and Accuracy for txts = 0.875 
test Loss: 0.0219 Img2Txt: 0.5847  Txt2Img: 0.5696

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.6722338204592901 and Accuracy for txts = 0.8622129436325677 
train Loss: 0.0189 Img2Txt: 0.5834  Txt2Img: 0.5640
test
Accuracy for imgs = 0.6083333333333333 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0214 Img2Txt: 0.6231  Txt2Img: 0.5886

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.6805845511482254 and Accuracy for txts = 0.8622129436325677 
train Loss: 0.0184 Img2Txt: 0.5743  Txt2Img: 0.5758
test
Accuracy for imgs = 0.65 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0214 Img2Txt: 0.6320  Txt2Img: 0.6156

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.7181628392484342 and Accuracy for txts = 0.8747390396659707 
train Loss: 0.0177 Img2Txt: 0.5799  Txt2Img: 0.5809
test
Accuracy for imgs = 0.6 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0213 Img2Txt: 0.6270  Txt2Img: 0.6135

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.7244258872651357 and Accuracy for txts = 0.8684759916492693 
train Loss: 0.0172 Img2Txt: 0.6453  Txt2Img: 0.6241
test
Accuracy for imgs = 0.6833333333333333 and Accuracy for txts = 0.8916666666666666 
test Loss: 0.0205 Img2Txt: 0.6828  Txt2Img: 0.6456

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.766179540709812 and Accuracy for txts = 0.8810020876826722 
train Loss: 0.0166 Img2Txt: 0.6052  Txt2Img: 0.6007
test
Accuracy for imgs = 0.65 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0206 Img2Txt: 0.6672  Txt2Img: 0.6490

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.766179540709812 and Accuracy for txts = 0.8768267223382045 
train Loss: 0.0160 Img2Txt: 0.6508  Txt2Img: 0.6470
test
Accuracy for imgs = 0.6916666666666667 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0203 Img2Txt: 0.6870  Txt2Img: 0.6539

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.7745302713987473 and Accuracy for txts = 0.8872651356993736 
train Loss: 0.0157 Img2Txt: 0.6061  Txt2Img: 0.5921
test
Accuracy for imgs = 0.675 and Accuracy for txts = 0.875 
test Loss: 0.0206 Img2Txt: 0.6666  Txt2Img: 0.6449

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.8058455114822546 and Accuracy for txts = 0.8851774530271398 
train Loss: 0.0151 Img2Txt: 0.6226  Txt2Img: 0.6375
test
Accuracy for imgs = 0.6916666666666667 and Accuracy for txts = 0.875 
test Loss: 0.0201 Img2Txt: 0.6664  Txt2Img: 0.6714

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.801670146137787 and Accuracy for txts = 0.8914405010438412 
train Loss: 0.0147 Img2Txt: 0.6128  Txt2Img: 0.6125
test
Accuracy for imgs = 0.7 and Accuracy for txts = 0.875 
test Loss: 0.0202 Img2Txt: 0.6962  Txt2Img: 0.6854

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.8141962421711899 and Accuracy for txts = 0.883089770354906 
train Loss: 0.0147 Img2Txt: 0.5946  Txt2Img: 0.6174
test
Accuracy for imgs = 0.6666666666666666 and Accuracy for txts = 0.875 
test Loss: 0.0205 Img2Txt: 0.6657  Txt2Img: 0.6669

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.824634655532359 and Accuracy for txts = 0.8872651356993736 
train Loss: 0.0140 Img2Txt: 0.6155  Txt2Img: 0.6124
test
Accuracy for imgs = 0.6583333333333333 and Accuracy for txts = 0.875 
test Loss: 0.0196 Img2Txt: 0.6757  Txt2Img: 0.6707

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.8392484342379958 and Accuracy for txts = 0.8893528183716074 
train Loss: 0.0138 Img2Txt: 0.6497  Txt2Img: 0.6263
test
Accuracy for imgs = 0.7083333333333334 and Accuracy for txts = 0.875 
test Loss: 0.0199 Img2Txt: 0.6983  Txt2Img: 0.6676

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.8350730688935281 and Accuracy for txts = 0.8914405010438412 
train Loss: 0.0135 Img2Txt: 0.5976  Txt2Img: 0.6135
test
Accuracy for imgs = 0.6666666666666666 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0197 Img2Txt: 0.6705  Txt2Img: 0.6799

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.8413361169102296 and Accuracy for txts = 0.8893528183716074 
train Loss: 0.0136 Img2Txt: 0.6135  Txt2Img: 0.6464
test
Accuracy for imgs = 0.675 and Accuracy for txts = 0.875 
test Loss: 0.0199 Img2Txt: 0.6604  Txt2Img: 0.6777

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.8580375782881001 and Accuracy for txts = 0.8956158663883089 
train Loss: 0.0134 Img2Txt: 0.5829  Txt2Img: 0.5743
test
Accuracy for imgs = 0.6083333333333333 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0201 Img2Txt: 0.6496  Txt2Img: 0.6701

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.8580375782881001 and Accuracy for txts = 0.8914405010438412 
train Loss: 0.0135 Img2Txt: 0.6167  Txt2Img: 0.6141
test
Accuracy for imgs = 0.7416666666666667 and Accuracy for txts = 0.8916666666666666 
test Loss: 0.0198 Img2Txt: 0.6953  Txt2Img: 0.6875

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.8684759916492693 and Accuracy for txts = 0.8977035490605427 
train Loss: 0.0125 Img2Txt: 0.5765  Txt2Img: 0.6417
test
Accuracy for imgs = 0.5916666666666667 and Accuracy for txts = 0.875 
test Loss: 0.0194 Img2Txt: 0.6430  Txt2Img: 0.7012

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.8684759916492693 and Accuracy for txts = 0.8997912317327765 
train Loss: 0.0128 Img2Txt: 0.6441  Txt2Img: 0.6245
test
Accuracy for imgs = 0.675 and Accuracy for txts = 0.8833333333333333 
test Loss: 0.0200 Img2Txt: 0.6813  Txt2Img: 0.6701

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.8684759916492693 and Accuracy for txts = 0.8997912317327765 
train Loss: 0.0126 Img2Txt: 0.6072  Txt2Img: 0.6365
test
Accuracy for imgs = 0.6333333333333333 and Accuracy for txts = 0.8916666666666666 
test Loss: 0.0191 Img2Txt: 0.6590  Txt2Img: 0.6918

Training complete in 19m 41s
Best average mAP: 0.691431
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2576  Txt2Img: 0.2381
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.3092  Txt2Img: 0.2743
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2294  Txt2Img: 0.2242
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2135  Txt2Img: 0.2119
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.3052  Txt2Img: 0.2697
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2278  Txt2Img: 0.1943
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2273  Txt2Img: 0.2177
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2081  Txt2Img: 0.1820
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2721  Txt2Img: 0.2544
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.3146  Txt2Img: 0.2790
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.4619  Txt2Img: 0.3895
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.2252  Txt2Img: 0.2055
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1732  Txt2Img: 0.1667
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.6590  Txt2Img: 0.6918
Testing Done...............
Selected dataset for training is 15..........
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Training for dataset 15 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.09205020920502091 and Accuracy for txts = 0.006276150627615062 
train Loss: 0.0370 Img2Txt: 0.1823  Txt2Img: 0.1995
test
Accuracy for imgs = 0.14285714285714285 and Accuracy for txts = 0.25210084033613445 
test Loss: 0.0331 Img2Txt: 0.2125  Txt2Img: 0.1890

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.12761506276150628 and Accuracy for txts = 0.19665271966527195 
train Loss: 0.0323 Img2Txt: 0.1873  Txt2Img: 0.2313
test
Accuracy for imgs = 0.25210084033613445 and Accuracy for txts = 0.453781512605042 
test Loss: 0.0301 Img2Txt: 0.2058  Txt2Img: 0.2375

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.20502092050209203 and Accuracy for txts = 0.37866108786610875 
train Loss: 0.0302 Img2Txt: 0.2454  Txt2Img: 0.2451
test
Accuracy for imgs = 0.3025210084033613 and Accuracy for txts = 0.49579831932773105 
test Loss: 0.0290 Img2Txt: 0.2706  Txt2Img: 0.2530

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.2719665271966527 and Accuracy for txts = 0.4476987447698744 
train Loss: 0.0287 Img2Txt: 0.2993  Txt2Img: 0.2575
test
Accuracy for imgs = 0.29411764705882354 and Accuracy for txts = 0.5210084033613445 
test Loss: 0.0282 Img2Txt: 0.3109  Txt2Img: 0.2828

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.33682008368200833 and Accuracy for txts = 0.48953974895397484 
train Loss: 0.0273 Img2Txt: 0.3212  Txt2Img: 0.2742
test
Accuracy for imgs = 0.36134453781512604 and Accuracy for txts = 0.5714285714285714 
test Loss: 0.0276 Img2Txt: 0.3451  Txt2Img: 0.3101

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.38702928870292885 and Accuracy for txts = 0.5188284518828451 
train Loss: 0.0262 Img2Txt: 0.3301  Txt2Img: 0.3022
test
Accuracy for imgs = 0.31092436974789917 and Accuracy for txts = 0.5714285714285714 
test Loss: 0.0274 Img2Txt: 0.3451  Txt2Img: 0.3184

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.43096234309623427 and Accuracy for txts = 0.5502092050209204 
train Loss: 0.0253 Img2Txt: 0.3386  Txt2Img: 0.3547
test
Accuracy for imgs = 0.31932773109243695 and Accuracy for txts = 0.5882352941176471 
test Loss: 0.0274 Img2Txt: 0.3543  Txt2Img: 0.3384

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.47698744769874474 and Accuracy for txts = 0.5585774058577405 
train Loss: 0.0247 Img2Txt: 0.3590  Txt2Img: 0.3526
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.6050420168067226 
test Loss: 0.0267 Img2Txt: 0.3744  Txt2Img: 0.3761

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.49790794979079495 and Accuracy for txts = 0.5794979079497907 
train Loss: 0.0237 Img2Txt: 0.3741  Txt2Img: 0.4023
test
Accuracy for imgs = 0.3949579831932773 and Accuracy for txts = 0.6554621848739496 
test Loss: 0.0265 Img2Txt: 0.3745  Txt2Img: 0.3712

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.5543933054393305 and Accuracy for txts = 0.5920502092050208 
train Loss: 0.0230 Img2Txt: 0.3943  Txt2Img: 0.4009
test
Accuracy for imgs = 0.4369747899159664 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0258 Img2Txt: 0.4152  Txt2Img: 0.4221

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.5920502092050208 and Accuracy for txts = 0.6192468619246861 
train Loss: 0.0222 Img2Txt: 0.4012  Txt2Img: 0.4188
test
Accuracy for imgs = 0.4453781512605042 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0259 Img2Txt: 0.4077  Txt2Img: 0.4159

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.610878661087866 and Accuracy for txts = 0.6297071129707112 
train Loss: 0.0217 Img2Txt: 0.4313  Txt2Img: 0.4426
test
Accuracy for imgs = 0.42857142857142855 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0264 Img2Txt: 0.4309  Txt2Img: 0.4392

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.6506276150627615 and Accuracy for txts = 0.6338912133891212 
train Loss: 0.0213 Img2Txt: 0.4426  Txt2Img: 0.4160
test
Accuracy for imgs = 0.453781512605042 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0252 Img2Txt: 0.4453  Txt2Img: 0.4382

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.6589958158995816 and Accuracy for txts = 0.6401673640167364 
train Loss: 0.0207 Img2Txt: 0.4596  Txt2Img: 0.4488
test
Accuracy for imgs = 0.47058823529411764 and Accuracy for txts = 0.6722689075630252 
test Loss: 0.0257 Img2Txt: 0.4556  Txt2Img: 0.4343

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.6841004184100418 and Accuracy for txts = 0.6464435146443515 
train Loss: 0.0205 Img2Txt: 0.4720  Txt2Img: 0.4675
test
Accuracy for imgs = 0.5126050420168067 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0250 Img2Txt: 0.4705  Txt2Img: 0.4635

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.6882845188284519 and Accuracy for txts = 0.6485355648535565 
train Loss: 0.0199 Img2Txt: 0.4595  Txt2Img: 0.4527
test
Accuracy for imgs = 0.5042016806722689 and Accuracy for txts = 0.6722689075630252 
test Loss: 0.0253 Img2Txt: 0.4739  Txt2Img: 0.4584

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.7280334728033472 and Accuracy for txts = 0.6548117154811715 
train Loss: 0.0195 Img2Txt: 0.4722  Txt2Img: 0.4561
test
Accuracy for imgs = 0.5210084033613445 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0247 Img2Txt: 0.4941  Txt2Img: 0.4712

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.7301255230125523 and Accuracy for txts = 0.6589958158995816 
train Loss: 0.0191 Img2Txt: 0.4452  Txt2Img: 0.4450
test
Accuracy for imgs = 0.48739495798319327 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0247 Img2Txt: 0.4646  Txt2Img: 0.4589

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.7405857740585774 and Accuracy for txts = 0.6652719665271966 
train Loss: 0.0189 Img2Txt: 0.4796  Txt2Img: 0.4595
test
Accuracy for imgs = 0.5126050420168067 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0246 Img2Txt: 0.4928  Txt2Img: 0.4682

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.7615062761506276 and Accuracy for txts = 0.6589958158995816 
train Loss: 0.0187 Img2Txt: 0.4663  Txt2Img: 0.4496
test
Accuracy for imgs = 0.47058823529411764 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0260 Img2Txt: 0.4600  Txt2Img: 0.4495

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.7635983263598326 and Accuracy for txts = 0.6820083682008368 
train Loss: 0.0185 Img2Txt: 0.4760  Txt2Img: 0.4788
test
Accuracy for imgs = 0.5210084033613445 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0243 Img2Txt: 0.5016  Txt2Img: 0.4892

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.7635983263598326 and Accuracy for txts = 0.6903765690376569 
train Loss: 0.0183 Img2Txt: 0.4699  Txt2Img: 0.4592
test
Accuracy for imgs = 0.5210084033613445 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0243 Img2Txt: 0.4872  Txt2Img: 0.4747

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.7761506276150627 and Accuracy for txts = 0.6882845188284519 
train Loss: 0.0176 Img2Txt: 0.4706  Txt2Img: 0.4624
test
Accuracy for imgs = 0.5378151260504201 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0242 Img2Txt: 0.5032  Txt2Img: 0.4958

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.7782426778242677 and Accuracy for txts = 0.698744769874477 
train Loss: 0.0175 Img2Txt: 0.4544  Txt2Img: 0.4435
test
Accuracy for imgs = 0.49579831932773105 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0250 Img2Txt: 0.4820  Txt2Img: 0.4574

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.7782426778242677 and Accuracy for txts = 0.700836820083682 
train Loss: 0.0174 Img2Txt: 0.4489  Txt2Img: 0.4531
test
Accuracy for imgs = 0.5126050420168067 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0247 Img2Txt: 0.4838  Txt2Img: 0.4710

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.7866108786610878 and Accuracy for txts = 0.705020920502092 
train Loss: 0.0169 Img2Txt: 0.4609  Txt2Img: 0.4957
test
Accuracy for imgs = 0.5546218487394958 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0239 Img2Txt: 0.4856  Txt2Img: 0.4926

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.7928870292887029 and Accuracy for txts = 0.698744769874477 
train Loss: 0.0173 Img2Txt: 0.4786  Txt2Img: 0.4651
test
Accuracy for imgs = 0.5210084033613445 and Accuracy for txts = 0.6974789915966386 
test Loss: 0.0245 Img2Txt: 0.5040  Txt2Img: 0.4771

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.8033472803347279 and Accuracy for txts = 0.7112970711297071 
train Loss: 0.0167 Img2Txt: 0.4490  Txt2Img: 0.4735
test
Accuracy for imgs = 0.5462184873949579 and Accuracy for txts = 0.6722689075630252 
test Loss: 0.0241 Img2Txt: 0.4913  Txt2Img: 0.4903

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.811715481171548 and Accuracy for txts = 0.7154811715481171 
train Loss: 0.0170 Img2Txt: 0.5161  Txt2Img: 0.4919
test
Accuracy for imgs = 0.5378151260504201 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0241 Img2Txt: 0.5142  Txt2Img: 0.4910

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.8242677824267781 and Accuracy for txts = 0.7133891213389121 
train Loss: 0.0161 Img2Txt: 0.4646  Txt2Img: 0.4875
test
Accuracy for imgs = 0.5126050420168067 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0239 Img2Txt: 0.5017  Txt2Img: 0.4902

Training complete in 19m 4s
Best average mAP: 0.502605
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2182  Txt2Img: 0.1925
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2940  Txt2Img: 0.2690
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2950  Txt2Img: 0.2457
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.2019  Txt2Img: 0.1842
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2876  Txt2Img: 0.2870
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2255  Txt2Img: 0.2109
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2019  Txt2Img: 0.1820
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2144  Txt2Img: 0.2119
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2187  Txt2Img: 0.2131
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2666  Txt2Img: 0.2353
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.3394  Txt2Img: 0.3183
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.1862  Txt2Img: 0.1741
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1735  Txt2Img: 0.1680
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.4152  Txt2Img: 0.3821
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.5017  Txt2Img: 0.4902
Testing Done...............
Selected dataset for training is 16..........
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Training for dataset 16 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.09361702127659574 and Accuracy for txts = 0.08297872340425531 
train Loss: 0.0360 Img2Txt: 0.1767  Txt2Img: 0.1801
test
Accuracy for imgs = 0.11864406779661017 and Accuracy for txts = 0.3728813559322034 
test Loss: 0.0320 Img2Txt: 0.1816  Txt2Img: 0.1783

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.1276595744680851 and Accuracy for txts = 0.31063829787234043 
train Loss: 0.0320 Img2Txt: 0.1829  Txt2Img: 0.2001
test
Accuracy for imgs = 0.15254237288135594 and Accuracy for txts = 0.5677966101694916 
test Loss: 0.0299 Img2Txt: 0.1906  Txt2Img: 0.1847

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.14042553191489363 and Accuracy for txts = 0.5468085106382978 
train Loss: 0.0300 Img2Txt: 0.1924  Txt2Img: 0.2042
test
Accuracy for imgs = 0.211864406779661 and Accuracy for txts = 0.5847457627118644 
test Loss: 0.0287 Img2Txt: 0.1989  Txt2Img: 0.2064

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.17659574468085107 and Accuracy for txts = 0.597872340425532 
train Loss: 0.0288 Img2Txt: 0.1894  Txt2Img: 0.2143
test
Accuracy for imgs = 0.23728813559322035 and Accuracy for txts = 0.6101694915254238 
test Loss: 0.0281 Img2Txt: 0.2117  Txt2Img: 0.2204

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.20851063829787234 and Accuracy for txts = 0.6382978723404256 
train Loss: 0.0279 Img2Txt: 0.2130  Txt2Img: 0.2146
test
Accuracy for imgs = 0.2627118644067797 and Accuracy for txts = 0.6271186440677966 
test Loss: 0.0276 Img2Txt: 0.2371  Txt2Img: 0.2449

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.2042553191489362 and Accuracy for txts = 0.6680851063829787 
train Loss: 0.0273 Img2Txt: 0.2461  Txt2Img: 0.2512
test
Accuracy for imgs = 0.288135593220339 and Accuracy for txts = 0.6440677966101694 
test Loss: 0.0272 Img2Txt: 0.2622  Txt2Img: 0.2658

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.25106382978723407 and Accuracy for txts = 0.6957446808510639 
train Loss: 0.0267 Img2Txt: 0.2569  Txt2Img: 0.2641
test
Accuracy for imgs = 0.2966101694915254 and Accuracy for txts = 0.6440677966101694 
test Loss: 0.0269 Img2Txt: 0.2785  Txt2Img: 0.2727

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.2680851063829787 and Accuracy for txts = 0.7170212765957447 
train Loss: 0.0262 Img2Txt: 0.2749  Txt2Img: 0.2635
test
Accuracy for imgs = 0.2966101694915254 and Accuracy for txts = 0.6610169491525424 
test Loss: 0.0267 Img2Txt: 0.2965  Txt2Img: 0.2909

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.2914893617021277 and Accuracy for txts = 0.7212765957446808 
train Loss: 0.0258 Img2Txt: 0.3094  Txt2Img: 0.2828
test
Accuracy for imgs = 0.3220338983050847 and Accuracy for txts = 0.652542372881356 
test Loss: 0.0264 Img2Txt: 0.3169  Txt2Img: 0.2944

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.35319148936170214 and Accuracy for txts = 0.7404255319148936 
train Loss: 0.0253 Img2Txt: 0.3340  Txt2Img: 0.3331
test
Accuracy for imgs = 0.3389830508474576 and Accuracy for txts = 0.6610169491525424 
test Loss: 0.0262 Img2Txt: 0.3427  Txt2Img: 0.3150

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.3851063829787234 and Accuracy for txts = 0.7595744680851064 
train Loss: 0.0247 Img2Txt: 0.3352  Txt2Img: 0.3202
test
Accuracy for imgs = 0.3389830508474576 and Accuracy for txts = 0.6779661016949152 
test Loss: 0.0261 Img2Txt: 0.3531  Txt2Img: 0.3255

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.41914893617021276 and Accuracy for txts = 0.7595744680851064 
train Loss: 0.0241 Img2Txt: 0.3645  Txt2Img: 0.3242
test
Accuracy for imgs = 0.3644067796610169 and Accuracy for txts = 0.7033898305084746 
test Loss: 0.0260 Img2Txt: 0.3799  Txt2Img: 0.3394

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.41914893617021276 and Accuracy for txts = 0.774468085106383 
train Loss: 0.0237 Img2Txt: 0.3437  Txt2Img: 0.3277
test
Accuracy for imgs = 0.3644067796610169 and Accuracy for txts = 0.7033898305084746 
test Loss: 0.0258 Img2Txt: 0.3751  Txt2Img: 0.3558

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.4574468085106383 and Accuracy for txts = 0.7787234042553192 
train Loss: 0.0230 Img2Txt: 0.3687  Txt2Img: 0.3271
test
Accuracy for imgs = 0.3898305084745763 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0258 Img2Txt: 0.3776  Txt2Img: 0.3638

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.48085106382978726 and Accuracy for txts = 0.7893617021276595 
train Loss: 0.0227 Img2Txt: 0.3573  Txt2Img: 0.3388
test
Accuracy for imgs = 0.3898305084745763 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0256 Img2Txt: 0.3924  Txt2Img: 0.3845

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.5 and Accuracy for txts = 0.7978723404255319 
train Loss: 0.0223 Img2Txt: 0.3762  Txt2Img: 0.3727
test
Accuracy for imgs = 0.4152542372881356 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0256 Img2Txt: 0.3869  Txt2Img: 0.3858

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.5127659574468085 and Accuracy for txts = 0.8021276595744681 
train Loss: 0.0218 Img2Txt: 0.3828  Txt2Img: 0.3868
test
Accuracy for imgs = 0.4491525423728814 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0253 Img2Txt: 0.4099  Txt2Img: 0.4263

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.551063829787234 and Accuracy for txts = 0.8212765957446808 
train Loss: 0.0214 Img2Txt: 0.3974  Txt2Img: 0.3765
test
Accuracy for imgs = 0.4491525423728814 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0253 Img2Txt: 0.4213  Txt2Img: 0.4289

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.5404255319148936 and Accuracy for txts = 0.8170212765957447 
train Loss: 0.0210 Img2Txt: 0.3738  Txt2Img: 0.3753
test
Accuracy for imgs = 0.4491525423728814 and Accuracy for txts = 0.711864406779661 
test Loss: 0.0251 Img2Txt: 0.3966  Txt2Img: 0.4293

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.5680851063829787 and Accuracy for txts = 0.8276595744680851 
train Loss: 0.0207 Img2Txt: 0.3801  Txt2Img: 0.3650
test
Accuracy for imgs = 0.4830508474576271 and Accuracy for txts = 0.6949152542372882 
test Loss: 0.0249 Img2Txt: 0.4191  Txt2Img: 0.4211

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.574468085106383 and Accuracy for txts = 0.825531914893617 
train Loss: 0.0204 Img2Txt: 0.3807  Txt2Img: 0.4187
test
Accuracy for imgs = 0.4491525423728814 and Accuracy for txts = 0.7288135593220338 
test Loss: 0.0247 Img2Txt: 0.4010  Txt2Img: 0.4274

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.574468085106383 and Accuracy for txts = 0.8340425531914893 
train Loss: 0.0199 Img2Txt: 0.3828  Txt2Img: 0.3968
test
Accuracy for imgs = 0.4661016949152542 and Accuracy for txts = 0.7033898305084746 
test Loss: 0.0248 Img2Txt: 0.4120  Txt2Img: 0.4409

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.5872340425531914 and Accuracy for txts = 0.8361702127659575 
train Loss: 0.0196 Img2Txt: 0.3949  Txt2Img: 0.3975
test
Accuracy for imgs = 0.4661016949152542 and Accuracy for txts = 0.711864406779661 
test Loss: 0.0247 Img2Txt: 0.4166  Txt2Img: 0.4321

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.6 and Accuracy for txts = 0.8319148936170213 
train Loss: 0.0194 Img2Txt: 0.4102  Txt2Img: 0.4103
test
Accuracy for imgs = 0.4745762711864407 and Accuracy for txts = 0.7203389830508474 
test Loss: 0.0246 Img2Txt: 0.4366  Txt2Img: 0.4372

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.6021276595744681 and Accuracy for txts = 0.8340425531914893 
train Loss: 0.0193 Img2Txt: 0.3713  Txt2Img: 0.3858
test
Accuracy for imgs = 0.4830508474576271 and Accuracy for txts = 0.7203389830508474 
test Loss: 0.0245 Img2Txt: 0.4010  Txt2Img: 0.4385

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.6127659574468085 and Accuracy for txts = 0.8382978723404255 
train Loss: 0.0188 Img2Txt: 0.4191  Txt2Img: 0.4287
test
Accuracy for imgs = 0.4406779661016949 and Accuracy for txts = 0.7203389830508474 
test Loss: 0.0246 Img2Txt: 0.4397  Txt2Img: 0.4426

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.6127659574468085 and Accuracy for txts = 0.8425531914893617 
train Loss: 0.0186 Img2Txt: 0.3998  Txt2Img: 0.4110
test
Accuracy for imgs = 0.5084745762711864 and Accuracy for txts = 0.711864406779661 
test Loss: 0.0242 Img2Txt: 0.4337  Txt2Img: 0.4507

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.6148936170212767 and Accuracy for txts = 0.8404255319148937 
train Loss: 0.0183 Img2Txt: 0.3987  Txt2Img: 0.4065
test
Accuracy for imgs = 0.4915254237288136 and Accuracy for txts = 0.7288135593220338 
test Loss: 0.0243 Img2Txt: 0.4370  Txt2Img: 0.4373

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.6382978723404256 and Accuracy for txts = 0.851063829787234 
train Loss: 0.0180 Img2Txt: 0.4050  Txt2Img: 0.4152
test
Accuracy for imgs = 0.4745762711864407 and Accuracy for txts = 0.7033898305084746 
test Loss: 0.0245 Img2Txt: 0.4315  Txt2Img: 0.4413

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.6319148936170212 and Accuracy for txts = 0.8446808510638298 
train Loss: 0.0178 Img2Txt: 0.4371  Txt2Img: 0.4082
test
Accuracy for imgs = 0.5 and Accuracy for txts = 0.7288135593220338 
test Loss: 0.0247 Img2Txt: 0.4542  Txt2Img: 0.4377

Training complete in 18m 51s
Best average mAP: 0.445905
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2008  Txt2Img: 0.1757
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2289  Txt2Img: 0.2023
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2651  Txt2Img: 0.2300
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1996  Txt2Img: 0.1965
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.3211  Txt2Img: 0.2646
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2896  Txt2Img: 0.2421
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.1783  Txt2Img: 0.1653
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2132  Txt2Img: 0.1873
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2970  Txt2Img: 0.2197
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2696  Txt2Img: 0.2342
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.2931  Txt2Img: 0.2278
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.1649  Txt2Img: 0.1715
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1575  Txt2Img: 0.1540
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.3126  Txt2Img: 0.2934
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.3052  Txt2Img: 0.2912
Testing Done...............
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Testing on test dataset of dataset 16......................
mAP on test set of dataset 16 -->  Img2Txt: 0.4542  Txt2Img: 0.4377
Testing Done...............
Selected dataset for training is 17..........
Starting preparing dataloader for dataset 17............
Done preparing dataloader for dataset 17
Training for dataset 17 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.11530398322851154 and Accuracy for txts = 0.10901467505241091 
train Loss: 0.0359 Img2Txt: 0.1688  Txt2Img: 0.1817
test
Accuracy for imgs = 0.13333333333333333 and Accuracy for txts = 0.30833333333333335 
test Loss: 0.0316 Img2Txt: 0.1877  Txt2Img: 0.1877

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.18238993710691825 and Accuracy for txts = 0.2809224318658281 
train Loss: 0.0316 Img2Txt: 0.1938  Txt2Img: 0.1996
test
Accuracy for imgs = 0.14166666666666666 and Accuracy for txts = 0.5416666666666666 
test Loss: 0.0296 Img2Txt: 0.1982  Txt2Img: 0.2057

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.2389937106918239 and Accuracy for txts = 0.4716981132075472 
train Loss: 0.0294 Img2Txt: 0.1955  Txt2Img: 0.2288
test
Accuracy for imgs = 0.16666666666666666 and Accuracy for txts = 0.5583333333333333 
test Loss: 0.0288 Img2Txt: 0.2159  Txt2Img: 0.2315

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.25995807127882603 and Accuracy for txts = 0.5660377358490566 
train Loss: 0.0283 Img2Txt: 0.2074  Txt2Img: 0.2373
test
Accuracy for imgs = 0.21666666666666667 and Accuracy for txts = 0.6416666666666666 
test Loss: 0.0281 Img2Txt: 0.2269  Txt2Img: 0.2466

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.28511530398322854 and Accuracy for txts = 0.6184486373165619 
train Loss: 0.0275 Img2Txt: 0.2373  Txt2Img: 0.2581
test
Accuracy for imgs = 0.225 and Accuracy for txts = 0.675 
test Loss: 0.0275 Img2Txt: 0.2504  Txt2Img: 0.2720

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.31865828092243187 and Accuracy for txts = 0.649895178197065 
train Loss: 0.0265 Img2Txt: 0.2564  Txt2Img: 0.2716
test
Accuracy for imgs = 0.25 and Accuracy for txts = 0.7 
test Loss: 0.0271 Img2Txt: 0.2734  Txt2Img: 0.2892

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.35429769392033544 and Accuracy for txts = 0.6771488469601677 
train Loss: 0.0258 Img2Txt: 0.2799  Txt2Img: 0.2970
test
Accuracy for imgs = 0.2833333333333333 and Accuracy for txts = 0.7 
test Loss: 0.0266 Img2Txt: 0.2935  Txt2Img: 0.2998

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.4004192872117401 and Accuracy for txts = 0.6876310272536688 
train Loss: 0.0250 Img2Txt: 0.2806  Txt2Img: 0.2932
test
Accuracy for imgs = 0.2833333333333333 and Accuracy for txts = 0.7333333333333333 
test Loss: 0.0263 Img2Txt: 0.3072  Txt2Img: 0.3019

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.4507337526205451 and Accuracy for txts = 0.7106918238993711 
train Loss: 0.0244 Img2Txt: 0.2774  Txt2Img: 0.2694
test
Accuracy for imgs = 0.30833333333333335 and Accuracy for txts = 0.725 
test Loss: 0.0261 Img2Txt: 0.3260  Txt2Img: 0.3143

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.4591194968553459 and Accuracy for txts = 0.7274633123689728 
train Loss: 0.0239 Img2Txt: 0.3045  Txt2Img: 0.3207
test
Accuracy for imgs = 0.3 and Accuracy for txts = 0.7666666666666666 
test Loss: 0.0256 Img2Txt: 0.3382  Txt2Img: 0.3308

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.48846960167714887 and Accuracy for txts = 0.7505241090146751 
train Loss: 0.0232 Img2Txt: 0.3365  Txt2Img: 0.3426
test
Accuracy for imgs = 0.35833333333333334 and Accuracy for txts = 0.7666666666666666 
test Loss: 0.0251 Img2Txt: 0.3563  Txt2Img: 0.3462

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.49895178197064993 and Accuracy for txts = 0.7568134171907758 
train Loss: 0.0227 Img2Txt: 0.3347  Txt2Img: 0.3561
test
Accuracy for imgs = 0.3416666666666667 and Accuracy for txts = 0.7916666666666666 
test Loss: 0.0250 Img2Txt: 0.3632  Txt2Img: 0.3542

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.5136268343815514 and Accuracy for txts = 0.7672955974842768 
train Loss: 0.0221 Img2Txt: 0.3266  Txt2Img: 0.3365
test
Accuracy for imgs = 0.3833333333333333 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0248 Img2Txt: 0.3649  Txt2Img: 0.3594

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.5555555555555556 and Accuracy for txts = 0.769392033542977 
train Loss: 0.0216 Img2Txt: 0.3698  Txt2Img: 0.3583
test
Accuracy for imgs = 0.3833333333333333 and Accuracy for txts = 0.8 
test Loss: 0.0246 Img2Txt: 0.3889  Txt2Img: 0.3631

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.5786163522012578 and Accuracy for txts = 0.7882599580712789 
train Loss: 0.0212 Img2Txt: 0.3635  Txt2Img: 0.3746
test
Accuracy for imgs = 0.4166666666666667 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0244 Img2Txt: 0.3932  Txt2Img: 0.3783

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.5932914046121593 and Accuracy for txts = 0.790356394129979 
train Loss: 0.0205 Img2Txt: 0.3870  Txt2Img: 0.3545
test
Accuracy for imgs = 0.425 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0242 Img2Txt: 0.4110  Txt2Img: 0.3712

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.6331236897274634 and Accuracy for txts = 0.7945492662473795 
train Loss: 0.0202 Img2Txt: 0.4091  Txt2Img: 0.3913
test
Accuracy for imgs = 0.475 and Accuracy for txts = 0.825 
test Loss: 0.0239 Img2Txt: 0.4292  Txt2Img: 0.3928

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.639412997903564 and Accuracy for txts = 0.7945492662473795 
train Loss: 0.0197 Img2Txt: 0.3787  Txt2Img: 0.3929
test
Accuracy for imgs = 0.45 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0239 Img2Txt: 0.4300  Txt2Img: 0.3960

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.6666666666666667 and Accuracy for txts = 0.7945492662473795 
train Loss: 0.0192 Img2Txt: 0.4033  Txt2Img: 0.3688
test
Accuracy for imgs = 0.475 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0236 Img2Txt: 0.4387  Txt2Img: 0.3999

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.6666666666666667 and Accuracy for txts = 0.7987421383647799 
train Loss: 0.0189 Img2Txt: 0.4043  Txt2Img: 0.4244
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0234 Img2Txt: 0.4388  Txt2Img: 0.4072

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.70020964360587 and Accuracy for txts = 0.8071278825995808 
train Loss: 0.0185 Img2Txt: 0.4147  Txt2Img: 0.4076
test
Accuracy for imgs = 0.43333333333333335 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0234 Img2Txt: 0.4388  Txt2Img: 0.4131

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.7023060796645703 and Accuracy for txts = 0.8029350104821803 
train Loss: 0.0181 Img2Txt: 0.4137  Txt2Img: 0.4271
test
Accuracy for imgs = 0.49166666666666664 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0235 Img2Txt: 0.4416  Txt2Img: 0.4280

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.7023060796645703 and Accuracy for txts = 0.8155136268343816 
train Loss: 0.0179 Img2Txt: 0.4257  Txt2Img: 0.3936
test
Accuracy for imgs = 0.475 and Accuracy for txts = 0.8083333333333333 
test Loss: 0.0232 Img2Txt: 0.4590  Txt2Img: 0.4144

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.7379454926624738 and Accuracy for txts = 0.8155136268343816 
train Loss: 0.0175 Img2Txt: 0.4230  Txt2Img: 0.4329
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0230 Img2Txt: 0.4506  Txt2Img: 0.4336

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.7190775681341719 and Accuracy for txts = 0.8280922431865828 
train Loss: 0.0173 Img2Txt: 0.4234  Txt2Img: 0.3986
test
Accuracy for imgs = 0.49166666666666664 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0228 Img2Txt: 0.4656  Txt2Img: 0.4315

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.7358490566037736 and Accuracy for txts = 0.8259958071278827 
train Loss: 0.0171 Img2Txt: 0.4075  Txt2Img: 0.4525
test
Accuracy for imgs = 0.475 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0231 Img2Txt: 0.4542  Txt2Img: 0.4296

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.7253668763102725 and Accuracy for txts = 0.8343815513626834 
train Loss: 0.0169 Img2Txt: 0.4321  Txt2Img: 0.4128
test
Accuracy for imgs = 0.5 and Accuracy for txts = 0.8333333333333334 
test Loss: 0.0227 Img2Txt: 0.4608  Txt2Img: 0.4337

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.7253668763102725 and Accuracy for txts = 0.8343815513626834 
train Loss: 0.0166 Img2Txt: 0.4471  Txt2Img: 0.4626
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.825 
test Loss: 0.0228 Img2Txt: 0.4565  Txt2Img: 0.4392

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.7379454926624738 and Accuracy for txts = 0.8364779874213837 
train Loss: 0.0163 Img2Txt: 0.4251  Txt2Img: 0.4510
test
Accuracy for imgs = 0.5083333333333333 and Accuracy for txts = 0.8166666666666667 
test Loss: 0.0227 Img2Txt: 0.4584  Txt2Img: 0.4478

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.7379454926624738 and Accuracy for txts = 0.8364779874213837 
train Loss: 0.0161 Img2Txt: 0.4195  Txt2Img: 0.4395
test
Accuracy for imgs = 0.5333333333333333 and Accuracy for txts = 0.825 
test Loss: 0.0225 Img2Txt: 0.4617  Txt2Img: 0.4383

Training complete in 19m 16s
Best average mAP: 0.453090
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2009  Txt2Img: 0.1688
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2954  Txt2Img: 0.2476
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.1995  Txt2Img: 0.1976
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1573  Txt2Img: 0.1567
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2584  Txt2Img: 0.2091
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2236  Txt2Img: 0.2236
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.2203  Txt2Img: 0.1898
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2504  Txt2Img: 0.2254
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2782  Txt2Img: 0.2618
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2831  Txt2Img: 0.2573
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.3150  Txt2Img: 0.2513
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.2303  Txt2Img: 0.2056
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1683  Txt2Img: 0.1502
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.2825  Txt2Img: 0.2626
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.2500  Txt2Img: 0.2209
Testing Done...............
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Testing on test dataset of dataset 16......................
mAP on test set of dataset 16 -->  Img2Txt: 0.2873  Txt2Img: 0.2839
Testing Done...............
Starting preparing dataloader for dataset 17............
Done preparing dataloader for dataset 17
Testing on test dataset of dataset 17......................
mAP on test set of dataset 17 -->  Img2Txt: 0.4617  Txt2Img: 0.4383
Testing Done...............
Selected dataset for training is 18..........
Starting preparing dataloader for dataset 18............
Done preparing dataloader for dataset 18
Training for dataset 18 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.07773109243697479 and Accuracy for txts = 0.06092436974789916 
train Loss: 0.0368 Img2Txt: 0.1622  Txt2Img: 0.1704
test
Accuracy for imgs = 0.18487394957983191 and Accuracy for txts = 0.1680672268907563 
test Loss: 0.0330 Img2Txt: 0.1774  Txt2Img: 0.1707

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.1134453781512605 and Accuracy for txts = 0.17016806722689076 
train Loss: 0.0326 Img2Txt: 0.1891  Txt2Img: 0.2042
test
Accuracy for imgs = 0.24369747899159663 and Accuracy for txts = 0.4621848739495798 
test Loss: 0.0303 Img2Txt: 0.2088  Txt2Img: 0.2035

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.1722689075630252 and Accuracy for txts = 0.3907563025210084 
train Loss: 0.0305 Img2Txt: 0.2076  Txt2Img: 0.2147
test
Accuracy for imgs = 0.24369747899159663 and Accuracy for txts = 0.5966386554621849 
test Loss: 0.0290 Img2Txt: 0.2370  Txt2Img: 0.2345

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.1995798319327731 and Accuracy for txts = 0.4978991596638655 
train Loss: 0.0291 Img2Txt: 0.2413  Txt2Img: 0.2287
test
Accuracy for imgs = 0.25210084033613445 and Accuracy for txts = 0.6638655462184874 
test Loss: 0.0283 Img2Txt: 0.2602  Txt2Img: 0.2464

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.2310924369747899 and Accuracy for txts = 0.5903361344537815 
train Loss: 0.0280 Img2Txt: 0.2397  Txt2Img: 0.2412
test
Accuracy for imgs = 0.2689075630252101 and Accuracy for txts = 0.680672268907563 
test Loss: 0.0276 Img2Txt: 0.2760  Txt2Img: 0.2735

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.2647058823529412 and Accuracy for txts = 0.6197478991596639 
train Loss: 0.0270 Img2Txt: 0.2410  Txt2Img: 0.2489
test
Accuracy for imgs = 0.2689075630252101 and Accuracy for txts = 0.6890756302521008 
test Loss: 0.0270 Img2Txt: 0.2859  Txt2Img: 0.2822

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.2815126050420168 and Accuracy for txts = 0.6449579831932772 
train Loss: 0.0260 Img2Txt: 0.2712  Txt2Img: 0.2576
test
Accuracy for imgs = 0.29411764705882354 and Accuracy for txts = 0.6974789915966386 
test Loss: 0.0267 Img2Txt: 0.3026  Txt2Img: 0.2945

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.3088235294117647 and Accuracy for txts = 0.657563025210084 
train Loss: 0.0254 Img2Txt: 0.2557  Txt2Img: 0.2434
test
Accuracy for imgs = 0.29411764705882354 and Accuracy for txts = 0.7142857142857143 
test Loss: 0.0265 Img2Txt: 0.3124  Txt2Img: 0.2910

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.34663865546218486 and Accuracy for txts = 0.6617647058823529 
train Loss: 0.0248 Img2Txt: 0.2959  Txt2Img: 0.3014
test
Accuracy for imgs = 0.2857142857142857 and Accuracy for txts = 0.7478991596638656 
test Loss: 0.0262 Img2Txt: 0.3140  Txt2Img: 0.2932

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.38865546218487396 and Accuracy for txts = 0.676470588235294 
train Loss: 0.0242 Img2Txt: 0.2998  Txt2Img: 0.2896
test
Accuracy for imgs = 0.31932773109243695 and Accuracy for txts = 0.7563025210084033 
test Loss: 0.0261 Img2Txt: 0.3199  Txt2Img: 0.3035

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.40126050420168063 and Accuracy for txts = 0.6827731092436975 
train Loss: 0.0237 Img2Txt: 0.2848  Txt2Img: 0.2861
test
Accuracy for imgs = 0.29411764705882354 and Accuracy for txts = 0.7563025210084033 
test Loss: 0.0258 Img2Txt: 0.3203  Txt2Img: 0.3144

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.42016806722689076 and Accuracy for txts = 0.703781512605042 
train Loss: 0.0233 Img2Txt: 0.2830  Txt2Img: 0.2911
test
Accuracy for imgs = 0.3277310924369748 and Accuracy for txts = 0.7647058823529411 
test Loss: 0.0255 Img2Txt: 0.3275  Txt2Img: 0.3263

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.45588235294117646 and Accuracy for txts = 0.7079831932773109 
train Loss: 0.0227 Img2Txt: 0.2891  Txt2Img: 0.2838
test
Accuracy for imgs = 0.3361344537815126 and Accuracy for txts = 0.7563025210084033 
test Loss: 0.0253 Img2Txt: 0.3360  Txt2Img: 0.3296

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.4621848739495798 and Accuracy for txts = 0.7184873949579832 
train Loss: 0.0224 Img2Txt: 0.2878  Txt2Img: 0.3263
test
Accuracy for imgs = 0.3445378151260504 and Accuracy for txts = 0.7563025210084033 
test Loss: 0.0250 Img2Txt: 0.3417  Txt2Img: 0.3416

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.4663865546218487 and Accuracy for txts = 0.7436974789915967 
train Loss: 0.0221 Img2Txt: 0.2860  Txt2Img: 0.3038
test
Accuracy for imgs = 0.3445378151260504 and Accuracy for txts = 0.7731092436974789 
test Loss: 0.0249 Img2Txt: 0.3438  Txt2Img: 0.3412

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.49159663865546216 and Accuracy for txts = 0.7542016806722689 
train Loss: 0.0217 Img2Txt: 0.2917  Txt2Img: 0.3355
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0248 Img2Txt: 0.3422  Txt2Img: 0.3390

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.46008403361344535 and Accuracy for txts = 0.7584033613445378 
train Loss: 0.0216 Img2Txt: 0.3035  Txt2Img: 0.3246
test
Accuracy for imgs = 0.3529411764705882 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0247 Img2Txt: 0.3494  Txt2Img: 0.3441

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.51890756302521 and Accuracy for txts = 0.7647058823529411 
train Loss: 0.0210 Img2Txt: 0.3128  Txt2Img: 0.3193
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0245 Img2Txt: 0.3583  Txt2Img: 0.3659

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.5210084033613445 and Accuracy for txts = 0.7668067226890756 
train Loss: 0.0207 Img2Txt: 0.3073  Txt2Img: 0.3320
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.7815126050420168 
test Loss: 0.0243 Img2Txt: 0.3679  Txt2Img: 0.3683

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.5588235294117647 and Accuracy for txts = 0.76890756302521 
train Loss: 0.0203 Img2Txt: 0.2949  Txt2Img: 0.3412
test
Accuracy for imgs = 0.3529411764705882 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0242 Img2Txt: 0.3503  Txt2Img: 0.3619

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.5483193277310924 and Accuracy for txts = 0.76890756302521 
train Loss: 0.0201 Img2Txt: 0.3348  Txt2Img: 0.3703
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0243 Img2Txt: 0.3755  Txt2Img: 0.3663

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.5714285714285714 and Accuracy for txts = 0.7836134453781513 
train Loss: 0.0198 Img2Txt: 0.3109  Txt2Img: 0.3344
test
Accuracy for imgs = 0.3277310924369748 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0243 Img2Txt: 0.3555  Txt2Img: 0.3587

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.5777310924369747 and Accuracy for txts = 0.7794117647058824 
train Loss: 0.0198 Img2Txt: 0.3324  Txt2Img: 0.3441
test
Accuracy for imgs = 0.36134453781512604 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0239 Img2Txt: 0.3752  Txt2Img: 0.3814

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.592436974789916 and Accuracy for txts = 0.7836134453781513 
train Loss: 0.0194 Img2Txt: 0.3231  Txt2Img: 0.3611
test
Accuracy for imgs = 0.3445378151260504 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0241 Img2Txt: 0.3786  Txt2Img: 0.3786

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.5987394957983193 and Accuracy for txts = 0.7836134453781513 
train Loss: 0.0192 Img2Txt: 0.3078  Txt2Img: 0.3392
test
Accuracy for imgs = 0.3529411764705882 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0238 Img2Txt: 0.3447  Txt2Img: 0.3766

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.5903361344537815 and Accuracy for txts = 0.7857142857142857 
train Loss: 0.0192 Img2Txt: 0.3266  Txt2Img: 0.3490
test
Accuracy for imgs = 0.38655462184873945 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0245 Img2Txt: 0.3885  Txt2Img: 0.3806

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.6008403361344538 and Accuracy for txts = 0.7815126050420168 
train Loss: 0.0188 Img2Txt: 0.3196  Txt2Img: 0.3268
test
Accuracy for imgs = 0.3529411764705882 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0239 Img2Txt: 0.3763  Txt2Img: 0.3664

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.5945378151260504 and Accuracy for txts = 0.792016806722689 
train Loss: 0.0187 Img2Txt: 0.3378  Txt2Img: 0.3441
test
Accuracy for imgs = 0.36974789915966383 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0238 Img2Txt: 0.3658  Txt2Img: 0.3690

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.6239495798319328 and Accuracy for txts = 0.7878151260504201 
train Loss: 0.0185 Img2Txt: 0.3229  Txt2Img: 0.3415
test
Accuracy for imgs = 0.3529411764705882 and Accuracy for txts = 0.7899159663865546 
test Loss: 0.0240 Img2Txt: 0.3738  Txt2Img: 0.3647

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.6218487394957983 and Accuracy for txts = 0.8004201680672268 
train Loss: 0.0183 Img2Txt: 0.3469  Txt2Img: 0.3133
test
Accuracy for imgs = 0.42857142857142855 and Accuracy for txts = 0.7983193277310924 
test Loss: 0.0247 Img2Txt: 0.3997  Txt2Img: 0.3623

Training complete in 19m 28s
Best average mAP: 0.384579
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2604  Txt2Img: 0.2091
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2547  Txt2Img: 0.2468
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2079  Txt2Img: 0.1733
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1538  Txt2Img: 0.1469
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2126  Txt2Img: 0.1872
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2604  Txt2Img: 0.2226
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.1928  Txt2Img: 0.1638
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.1773  Txt2Img: 0.1653
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2481  Txt2Img: 0.1962
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2340  Txt2Img: 0.2216
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.1868  Txt2Img: 0.1529
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.1492  Txt2Img: 0.1456
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1579  Txt2Img: 0.1533
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.2999  Txt2Img: 0.2596
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.1985  Txt2Img: 0.1691
Testing Done...............
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Testing on test dataset of dataset 16......................
mAP on test set of dataset 16 -->  Img2Txt: 0.2468  Txt2Img: 0.2431
Testing Done...............
Starting preparing dataloader for dataset 17............
Done preparing dataloader for dataset 17
Testing on test dataset of dataset 17......................
mAP on test set of dataset 17 -->  Img2Txt: 0.2773  Txt2Img: 0.2345
Testing Done...............
Starting preparing dataloader for dataset 18............
Done preparing dataloader for dataset 18
Testing on test dataset of dataset 18......................
mAP on test set of dataset 18 -->  Img2Txt: 0.3997  Txt2Img: 0.3623
Testing Done...............
Selected dataset for training is 19..........
Starting preparing dataloader for dataset 19............
Done preparing dataloader for dataset 19
Training for dataset 19 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.1276595744680851 and Accuracy for txts = 0.019148936170212766 
train Loss: 0.0377 Img2Txt: 0.1762  Txt2Img: 0.1449
test
Accuracy for imgs = 0.15384615384615385 and Accuracy for txts = 0.35897435897435903 
test Loss: 0.0323 Img2Txt: 0.1784  Txt2Img: 0.1517

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.16808510638297872 and Accuracy for txts = 0.2957446808510638 
train Loss: 0.0318 Img2Txt: 0.1767  Txt2Img: 0.1758
test
Accuracy for imgs = 0.13675213675213677 and Accuracy for txts = 0.7179487179487181 
test Loss: 0.0294 Img2Txt: 0.2054  Txt2Img: 0.1859

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.20638297872340425 and Accuracy for txts = 0.674468085106383 
train Loss: 0.0291 Img2Txt: 0.1974  Txt2Img: 0.1854
test
Accuracy for imgs = 0.20512820512820515 and Accuracy for txts = 0.7435897435897436 
test Loss: 0.0279 Img2Txt: 0.2180  Txt2Img: 0.2299

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.2297872340425532 and Accuracy for txts = 0.723404255319149 
train Loss: 0.0274 Img2Txt: 0.2137  Txt2Img: 0.2266
test
Accuracy for imgs = 0.2136752136752137 and Accuracy for txts = 0.7948717948717949 
test Loss: 0.0269 Img2Txt: 0.2440  Txt2Img: 0.2609

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.25106382978723407 and Accuracy for txts = 0.7787234042553192 
train Loss: 0.0260 Img2Txt: 0.2131  Txt2Img: 0.2229
test
Accuracy for imgs = 0.2136752136752137 and Accuracy for txts = 0.7948717948717949 
test Loss: 0.0264 Img2Txt: 0.2552  Txt2Img: 0.2697

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.2680851063829787 and Accuracy for txts = 0.7872340425531915 
train Loss: 0.0252 Img2Txt: 0.2619  Txt2Img: 0.2695
test
Accuracy for imgs = 0.2820512820512821 and Accuracy for txts = 0.8290598290598291 
test Loss: 0.0256 Img2Txt: 0.2888  Txt2Img: 0.3089

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.32127659574468087 and Accuracy for txts = 0.8085106382978724 
train Loss: 0.0245 Img2Txt: 0.2773  Txt2Img: 0.2992
test
Accuracy for imgs = 0.2905982905982906 and Accuracy for txts = 0.8205128205128206 
test Loss: 0.0255 Img2Txt: 0.3095  Txt2Img: 0.3120

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.3425531914893617 and Accuracy for txts = 0.8276595744680851 
train Loss: 0.0238 Img2Txt: 0.2901  Txt2Img: 0.3062
test
Accuracy for imgs = 0.25641025641025644 and Accuracy for txts = 0.8290598290598291 
test Loss: 0.0254 Img2Txt: 0.3387  Txt2Img: 0.3387

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.37446808510638296 and Accuracy for txts = 0.8319148936170213 
train Loss: 0.0232 Img2Txt: 0.2950  Txt2Img: 0.3170
test
Accuracy for imgs = 0.3076923076923077 and Accuracy for txts = 0.8376068376068377 
test Loss: 0.0249 Img2Txt: 0.3499  Txt2Img: 0.3373

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.4085106382978724 and Accuracy for txts = 0.8404255319148937 
train Loss: 0.0224 Img2Txt: 0.3314  Txt2Img: 0.3411
test
Accuracy for imgs = 0.27350427350427353 and Accuracy for txts = 0.8461538461538463 
test Loss: 0.0247 Img2Txt: 0.3774  Txt2Img: 0.3541

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.44042553191489364 and Accuracy for txts = 0.8553191489361702 
train Loss: 0.0218 Img2Txt: 0.3413  Txt2Img: 0.3407
test
Accuracy for imgs = 0.3418803418803419 and Accuracy for txts = 0.8547008547008548 
test Loss: 0.0241 Img2Txt: 0.3822  Txt2Img: 0.3643

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.4574468085106383 and Accuracy for txts = 0.8617021276595744 
train Loss: 0.0211 Img2Txt: 0.3739  Txt2Img: 0.3700
test
Accuracy for imgs = 0.3076923076923077 and Accuracy for txts = 0.8376068376068377 
test Loss: 0.0242 Img2Txt: 0.3979  Txt2Img: 0.3714

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.49148936170212765 and Accuracy for txts = 0.8680851063829788 
train Loss: 0.0207 Img2Txt: 0.3676  Txt2Img: 0.3840
test
Accuracy for imgs = 0.3760683760683761 and Accuracy for txts = 0.8803418803418804 
test Loss: 0.0237 Img2Txt: 0.4139  Txt2Img: 0.3974

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.5042553191489362 and Accuracy for txts = 0.874468085106383 
train Loss: 0.0200 Img2Txt: 0.3819  Txt2Img: 0.3728
test
Accuracy for imgs = 0.33333333333333337 and Accuracy for txts = 0.8461538461538463 
test Loss: 0.0239 Img2Txt: 0.4003  Txt2Img: 0.3781

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.5212765957446809 and Accuracy for txts = 0.8787234042553191 
train Loss: 0.0197 Img2Txt: 0.3959  Txt2Img: 0.4000
test
Accuracy for imgs = 0.3760683760683761 and Accuracy for txts = 0.888888888888889 
test Loss: 0.0239 Img2Txt: 0.4472  Txt2Img: 0.4143

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.5595744680851064 and Accuracy for txts = 0.8787234042553191 
train Loss: 0.0193 Img2Txt: 0.3732  Txt2Img: 0.3709
test
Accuracy for imgs = 0.3760683760683761 and Accuracy for txts = 0.8632478632478633 
test Loss: 0.0237 Img2Txt: 0.4136  Txt2Img: 0.3875

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.5425531914893618 and Accuracy for txts = 0.8851063829787235 
train Loss: 0.0189 Img2Txt: 0.4152  Txt2Img: 0.4271
test
Accuracy for imgs = 0.3760683760683761 and Accuracy for txts = 0.9059829059829061 
test Loss: 0.0236 Img2Txt: 0.4461  Txt2Img: 0.4226

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.5617021276595745 and Accuracy for txts = 0.8914893617021277 
train Loss: 0.0187 Img2Txt: 0.4041  Txt2Img: 0.4330
test
Accuracy for imgs = 0.4017094017094017 and Accuracy for txts = 0.8547008547008548 
test Loss: 0.0230 Img2Txt: 0.4363  Txt2Img: 0.4384

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.5765957446808511 and Accuracy for txts = 0.8978723404255319 
train Loss: 0.0182 Img2Txt: 0.4469  Txt2Img: 0.4502
test
Accuracy for imgs = 0.3931623931623932 and Accuracy for txts = 0.8974358974358976 
test Loss: 0.0237 Img2Txt: 0.4594  Txt2Img: 0.4269

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.597872340425532 and Accuracy for txts = 0.8978723404255319 
train Loss: 0.0180 Img2Txt: 0.4630  Txt2Img: 0.4515
test
Accuracy for imgs = 0.41880341880341887 and Accuracy for txts = 0.8547008547008548 
test Loss: 0.0226 Img2Txt: 0.4864  Txt2Img: 0.4548

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.6212765957446809 and Accuracy for txts = 0.9 
train Loss: 0.0175 Img2Txt: 0.4735  Txt2Img: 0.4823
test
Accuracy for imgs = 0.45299145299145305 and Accuracy for txts = 0.8974358974358976 
test Loss: 0.0227 Img2Txt: 0.5101  Txt2Img: 0.4599

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.6340425531914894 and Accuracy for txts = 0.902127659574468 
train Loss: 0.0173 Img2Txt: 0.4629  Txt2Img: 0.4619
test
Accuracy for imgs = 0.46153846153846156 and Accuracy for txts = 0.888888888888889 
test Loss: 0.0223 Img2Txt: 0.5014  Txt2Img: 0.4680

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.6276595744680851 and Accuracy for txts = 0.9085106382978724 
train Loss: 0.0170 Img2Txt: 0.4844  Txt2Img: 0.5159
test
Accuracy for imgs = 0.47008547008547014 and Accuracy for txts = 0.9059829059829061 
test Loss: 0.0226 Img2Txt: 0.5125  Txt2Img: 0.4783

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.6468085106382979 and Accuracy for txts = 0.9042553191489362 
train Loss: 0.0166 Img2Txt: 0.4735  Txt2Img: 0.4677
test
Accuracy for imgs = 0.4786324786324787 and Accuracy for txts = 0.8632478632478633 
test Loss: 0.0219 Img2Txt: 0.5298  Txt2Img: 0.5028

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.6468085106382979 and Accuracy for txts = 0.902127659574468 
train Loss: 0.0164 Img2Txt: 0.5100  Txt2Img: 0.5305
test
Accuracy for imgs = 0.4786324786324787 and Accuracy for txts = 0.888888888888889 
test Loss: 0.0222 Img2Txt: 0.5211  Txt2Img: 0.4907

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.6553191489361703 and Accuracy for txts = 0.9212765957446809 
train Loss: 0.0161 Img2Txt: 0.4895  Txt2Img: 0.4932
test
Accuracy for imgs = 0.4871794871794872 and Accuracy for txts = 0.8632478632478633 
test Loss: 0.0219 Img2Txt: 0.5415  Txt2Img: 0.5055

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.6595744680851064 and Accuracy for txts = 0.9127659574468086 
train Loss: 0.0159 Img2Txt: 0.5090  Txt2Img: 0.4959
test
Accuracy for imgs = 0.5042735042735044 and Accuracy for txts = 0.888888888888889 
test Loss: 0.0222 Img2Txt: 0.5387  Txt2Img: 0.5225

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.6680851063829787 and Accuracy for txts = 0.9255319148936171 
train Loss: 0.0156 Img2Txt: 0.5012  Txt2Img: 0.5242
test
Accuracy for imgs = 0.4957264957264958 and Accuracy for txts = 0.8803418803418804 
test Loss: 0.0218 Img2Txt: 0.5300  Txt2Img: 0.5059

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.6872340425531915 and Accuracy for txts = 0.9170212765957447 
train Loss: 0.0153 Img2Txt: 0.5263  Txt2Img: 0.5677
test
Accuracy for imgs = 0.5299145299145299 and Accuracy for txts = 0.8632478632478633 
test Loss: 0.0210 Img2Txt: 0.5566  Txt2Img: 0.5535

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.6851063829787234 and Accuracy for txts = 0.9255319148936171 
train Loss: 0.0155 Img2Txt: 0.5146  Txt2Img: 0.5030
test
Accuracy for imgs = 0.5811965811965812 and Accuracy for txts = 0.8803418803418804 
test Loss: 0.0219 Img2Txt: 0.5751  Txt2Img: 0.5460

Training complete in 19m 4s
Best average mAP: 0.560517
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2169  Txt2Img: 0.1761
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2577  Txt2Img: 0.2001
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2250  Txt2Img: 0.2085
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1961  Txt2Img: 0.1720
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2585  Txt2Img: 0.2185
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2485  Txt2Img: 0.2061
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.1636  Txt2Img: 0.1555
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.1994  Txt2Img: 0.1852
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2535  Txt2Img: 0.2062
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2751  Txt2Img: 0.1911
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.3842  Txt2Img: 0.2815
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.1954  Txt2Img: 0.1906
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1544  Txt2Img: 0.1434
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.2917  Txt2Img: 0.2080
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.2500  Txt2Img: 0.2109
Testing Done...............
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Testing on test dataset of dataset 16......................
mAP on test set of dataset 16 -->  Img2Txt: 0.2002  Txt2Img: 0.1877
Testing Done...............
Starting preparing dataloader for dataset 17............
Done preparing dataloader for dataset 17
Testing on test dataset of dataset 17......................
mAP on test set of dataset 17 -->  Img2Txt: 0.2438  Txt2Img: 0.2123
Testing Done...............
Starting preparing dataloader for dataset 18............
Done preparing dataloader for dataset 18
Testing on test dataset of dataset 18......................
mAP on test set of dataset 18 -->  Img2Txt: 0.2155  Txt2Img: 0.2008
Testing Done...............
Starting preparing dataloader for dataset 19............
Done preparing dataloader for dataset 19
Testing on test dataset of dataset 19......................
mAP on test set of dataset 19 -->  Img2Txt: 0.5751  Txt2Img: 0.5460
Testing Done...............
Selected dataset for training is 20..........
Starting preparing dataloader for dataset 20............
Done preparing dataloader for dataset 20
Training for dataset 20 ..............
Epoch 1/30
--------------------
train
Accuracy for imgs = 0.07515657620041753 and Accuracy for txts = 0.043841336116910226 
train Loss: 0.0371 Img2Txt: 0.1506  Txt2Img: 0.1518
test
Accuracy for imgs = 0.05 and Accuracy for txts = 0.31666666666666665 
test Loss: 0.0331 Img2Txt: 0.1559  Txt2Img: 0.1514

Epoch 2/30
--------------------
train
Accuracy for imgs = 0.11064718162839247 and Accuracy for txts = 0.2797494780793319 
train Loss: 0.0321 Img2Txt: 0.1543  Txt2Img: 0.1261
test
Accuracy for imgs = 0.05 and Accuracy for txts = 0.5083333333333333 
test Loss: 0.0306 Img2Txt: 0.1532  Txt2Img: 0.1261

Epoch 3/30
--------------------
train
Accuracy for imgs = 0.15866388308977034 and Accuracy for txts = 0.45929018789144044 
train Loss: 0.0296 Img2Txt: 0.1758  Txt2Img: 0.1625
test
Accuracy for imgs = 0.08333333333333333 and Accuracy for txts = 0.575 
test Loss: 0.0296 Img2Txt: 0.1627  Txt2Img: 0.1463

Epoch 4/30
--------------------
train
Accuracy for imgs = 0.20459290187891438 and Accuracy for txts = 0.5302713987473904 
train Loss: 0.0287 Img2Txt: 0.1900  Txt2Img: 0.1520
test
Accuracy for imgs = 0.14166666666666666 and Accuracy for txts = 0.5916666666666667 
test Loss: 0.0287 Img2Txt: 0.1794  Txt2Img: 0.1362

Epoch 5/30
--------------------
train
Accuracy for imgs = 0.24217118997912315 and Accuracy for txts = 0.580375782881002 
train Loss: 0.0276 Img2Txt: 0.1951  Txt2Img: 0.1894
test
Accuracy for imgs = 0.13333333333333333 and Accuracy for txts = 0.575 
test Loss: 0.0284 Img2Txt: 0.1780  Txt2Img: 0.1647

Epoch 6/30
--------------------
train
Accuracy for imgs = 0.27139874739039666 and Accuracy for txts = 0.5970772442588725 
train Loss: 0.0271 Img2Txt: 0.2083  Txt2Img: 0.1937
test
Accuracy for imgs = 0.19166666666666665 and Accuracy for txts = 0.5916666666666667 
test Loss: 0.0277 Img2Txt: 0.1987  Txt2Img: 0.1684

Epoch 7/30
--------------------
train
Accuracy for imgs = 0.2881002087682672 and Accuracy for txts = 0.6096033402922755 
train Loss: 0.0262 Img2Txt: 0.2107  Txt2Img: 0.2216
test
Accuracy for imgs = 0.18333333333333332 and Accuracy for txts = 0.5833333333333334 
test Loss: 0.0274 Img2Txt: 0.2064  Txt2Img: 0.2105

Epoch 8/30
--------------------
train
Accuracy for imgs = 0.3695198329853862 and Accuracy for txts = 0.6263048016701461 
train Loss: 0.0261 Img2Txt: 0.2139  Txt2Img: 0.2412
test
Accuracy for imgs = 0.24166666666666667 and Accuracy for txts = 0.5916666666666667 
test Loss: 0.0268 Img2Txt: 0.2235  Txt2Img: 0.2494

Epoch 9/30
--------------------
train
Accuracy for imgs = 0.3778705636743215 and Accuracy for txts = 0.6513569937369519 
train Loss: 0.0251 Img2Txt: 0.2908  Txt2Img: 0.3365
test
Accuracy for imgs = 0.3416666666666667 and Accuracy for txts = 0.6083333333333333 
test Loss: 0.0257 Img2Txt: 0.3190  Txt2Img: 0.3151

Epoch 10/30
--------------------
train
Accuracy for imgs = 0.40501043841336115 and Accuracy for txts = 0.6659707724425886 
train Loss: 0.0246 Img2Txt: 0.3712  Txt2Img: 0.3520
test
Accuracy for imgs = 0.39166666666666666 and Accuracy for txts = 0.625 
test Loss: 0.0253 Img2Txt: 0.3864  Txt2Img: 0.3216

Epoch 11/30
--------------------
train
Accuracy for imgs = 0.45720250521920663 and Accuracy for txts = 0.6847599164926931 
train Loss: 0.0238 Img2Txt: 0.4090  Txt2Img: 0.3716
test
Accuracy for imgs = 0.4583333333333333 and Accuracy for txts = 0.625 
test Loss: 0.0250 Img2Txt: 0.4340  Txt2Img: 0.3623

Epoch 12/30
--------------------
train
Accuracy for imgs = 0.5093945720250521 and Accuracy for txts = 0.6910229645093945 
train Loss: 0.0230 Img2Txt: 0.3940  Txt2Img: 0.3554
test
Accuracy for imgs = 0.45 and Accuracy for txts = 0.6416666666666666 
test Loss: 0.0243 Img2Txt: 0.4258  Txt2Img: 0.3741

Epoch 13/30
--------------------
train
Accuracy for imgs = 0.5281837160751566 and Accuracy for txts = 0.6931106471816283 
train Loss: 0.0227 Img2Txt: 0.4534  Txt2Img: 0.3869
test
Accuracy for imgs = 0.49166666666666664 and Accuracy for txts = 0.6416666666666666 
test Loss: 0.0246 Img2Txt: 0.4539  Txt2Img: 0.3766

Epoch 14/30
--------------------
train
Accuracy for imgs = 0.5678496868475991 and Accuracy for txts = 0.697286012526096 
train Loss: 0.0220 Img2Txt: 0.4276  Txt2Img: 0.3932
test
Accuracy for imgs = 0.48333333333333334 and Accuracy for txts = 0.65 
test Loss: 0.0234 Img2Txt: 0.4534  Txt2Img: 0.3968

Epoch 15/30
--------------------
train
Accuracy for imgs = 0.5678496868475991 and Accuracy for txts = 0.7014613778705636 
train Loss: 0.0215 Img2Txt: 0.4569  Txt2Img: 0.4310
test
Accuracy for imgs = 0.49166666666666664 and Accuracy for txts = 0.6583333333333333 
test Loss: 0.0240 Img2Txt: 0.4619  Txt2Img: 0.3979

Epoch 16/30
--------------------
train
Accuracy for imgs = 0.5887265135699373 and Accuracy for txts = 0.7035490605427974 
train Loss: 0.0213 Img2Txt: 0.4674  Txt2Img: 0.4496
test
Accuracy for imgs = 0.5166666666666666 and Accuracy for txts = 0.675 
test Loss: 0.0230 Img2Txt: 0.4646  Txt2Img: 0.4170

Epoch 17/30
--------------------
train
Accuracy for imgs = 0.6263048016701461 and Accuracy for txts = 0.7098121085594988 
train Loss: 0.0208 Img2Txt: 0.4703  Txt2Img: 0.4533
test
Accuracy for imgs = 0.5 and Accuracy for txts = 0.6833333333333333 
test Loss: 0.0232 Img2Txt: 0.4754  Txt2Img: 0.4230

Epoch 18/30
--------------------
train
Accuracy for imgs = 0.6116910229645093 and Accuracy for txts = 0.707724425887265 
train Loss: 0.0206 Img2Txt: 0.4379  Txt2Img: 0.4318
test
Accuracy for imgs = 0.5083333333333333 and Accuracy for txts = 0.7083333333333334 
test Loss: 0.0226 Img2Txt: 0.4676  Txt2Img: 0.4256

Epoch 19/30
--------------------
train
Accuracy for imgs = 0.6346555323590813 and Accuracy for txts = 0.7160751565762004 
train Loss: 0.0200 Img2Txt: 0.5166  Txt2Img: 0.5031
test
Accuracy for imgs = 0.5416666666666666 and Accuracy for txts = 0.7 
test Loss: 0.0228 Img2Txt: 0.4976  Txt2Img: 0.4685

Epoch 20/30
--------------------
train
Accuracy for imgs = 0.6555323590814196 and Accuracy for txts = 0.7160751565762004 
train Loss: 0.0196 Img2Txt: 0.4778  Txt2Img: 0.4753
test
Accuracy for imgs = 0.5333333333333333 and Accuracy for txts = 0.7166666666666667 
test Loss: 0.0219 Img2Txt: 0.5058  Txt2Img: 0.4653

Epoch 21/30
--------------------
train
Accuracy for imgs = 0.6659707724425886 and Accuracy for txts = 0.720250521920668 
train Loss: 0.0192 Img2Txt: 0.5135  Txt2Img: 0.5102
test
Accuracy for imgs = 0.5416666666666666 and Accuracy for txts = 0.7333333333333333 
test Loss: 0.0223 Img2Txt: 0.5194  Txt2Img: 0.4799

Epoch 22/30
--------------------
train
Accuracy for imgs = 0.6847599164926931 and Accuracy for txts = 0.7244258872651357 
train Loss: 0.0190 Img2Txt: 0.4752  Txt2Img: 0.4749
test
Accuracy for imgs = 0.5416666666666666 and Accuracy for txts = 0.725 
test Loss: 0.0222 Img2Txt: 0.5080  Txt2Img: 0.4975

Epoch 23/30
--------------------
train
Accuracy for imgs = 0.6805845511482254 and Accuracy for txts = 0.7327766179540709 
train Loss: 0.0187 Img2Txt: 0.5198  Txt2Img: 0.5011
test
Accuracy for imgs = 0.5416666666666666 and Accuracy for txts = 0.7333333333333333 
test Loss: 0.0225 Img2Txt: 0.5383  Txt2Img: 0.4910

Epoch 24/30
--------------------
train
Accuracy for imgs = 0.6910229645093945 and Accuracy for txts = 0.7306889352818371 
train Loss: 0.0184 Img2Txt: 0.4913  Txt2Img: 0.5114
test
Accuracy for imgs = 0.55 and Accuracy for txts = 0.7416666666666667 
test Loss: 0.0218 Img2Txt: 0.5193  Txt2Img: 0.5026

Epoch 25/30
--------------------
train
Accuracy for imgs = 0.7014613778705636 and Accuracy for txts = 0.7348643006263047 
train Loss: 0.0181 Img2Txt: 0.5182  Txt2Img: 0.5068
test
Accuracy for imgs = 0.5416666666666666 and Accuracy for txts = 0.7416666666666667 
test Loss: 0.0220 Img2Txt: 0.5288  Txt2Img: 0.4876

Epoch 26/30
--------------------
train
Accuracy for imgs = 0.7244258872651357 and Accuracy for txts = 0.7390396659707724 
train Loss: 0.0177 Img2Txt: 0.5393  Txt2Img: 0.5201
test
Accuracy for imgs = 0.55 and Accuracy for txts = 0.7583333333333333 
test Loss: 0.0214 Img2Txt: 0.5663  Txt2Img: 0.5261

Epoch 27/30
--------------------
train
Accuracy for imgs = 0.7286012526096033 and Accuracy for txts = 0.7411273486430062 
train Loss: 0.0178 Img2Txt: 0.5312  Txt2Img: 0.5163
test
Accuracy for imgs = 0.575 and Accuracy for txts = 0.7583333333333333 
test Loss: 0.0219 Img2Txt: 0.5490  Txt2Img: 0.4950

Epoch 28/30
--------------------
train
Accuracy for imgs = 0.7286012526096033 and Accuracy for txts = 0.7494780793319414 
train Loss: 0.0175 Img2Txt: 0.5481  Txt2Img: 0.5386
test
Accuracy for imgs = 0.5666666666666667 and Accuracy for txts = 0.75 
test Loss: 0.0212 Img2Txt: 0.5750  Txt2Img: 0.5222

Epoch 29/30
--------------------
train
Accuracy for imgs = 0.7181628392484342 and Accuracy for txts = 0.755741127348643 
train Loss: 0.0175 Img2Txt: 0.5508  Txt2Img: 0.5294
test
Accuracy for imgs = 0.5666666666666667 and Accuracy for txts = 0.7583333333333333 
test Loss: 0.0216 Img2Txt: 0.5649  Txt2Img: 0.5189

Epoch 30/30
--------------------
train
Accuracy for imgs = 0.7327766179540709 and Accuracy for txts = 0.7599164926931106 
train Loss: 0.0170 Img2Txt: 0.5816  Txt2Img: 0.5650
test
Accuracy for imgs = 0.6083333333333333 and Accuracy for txts = 0.7666666666666666 
test Loss: 0.0215 Img2Txt: 0.5816  Txt2Img: 0.5355

Training complete in 19m 42s
Best average mAP: 0.558548
Starting testing on datasets trained till now..............
Starting preparing dataloader for dataset 1............
Done preparing dataloader for dataset 1
Testing on test dataset of dataset 1......................
mAP on test set of dataset 1 -->  Img2Txt: 0.2388  Txt2Img: 0.1775
Testing Done...............
Starting preparing dataloader for dataset 2............
Done preparing dataloader for dataset 2
Testing on test dataset of dataset 2......................
mAP on test set of dataset 2 -->  Img2Txt: 0.2563  Txt2Img: 0.2192
Testing Done...............
Starting preparing dataloader for dataset 3............
Done preparing dataloader for dataset 3
Testing on test dataset of dataset 3......................
mAP on test set of dataset 3 -->  Img2Txt: 0.2618  Txt2Img: 0.2202
Testing Done...............
Starting preparing dataloader for dataset 4............
Done preparing dataloader for dataset 4
Testing on test dataset of dataset 4......................
mAP on test set of dataset 4 -->  Img2Txt: 0.1736  Txt2Img: 0.1529
Testing Done...............
Starting preparing dataloader for dataset 5............
Done preparing dataloader for dataset 5
Testing on test dataset of dataset 5......................
mAP on test set of dataset 5 -->  Img2Txt: 0.2565  Txt2Img: 0.1795
Testing Done...............
Starting preparing dataloader for dataset 6............
Done preparing dataloader for dataset 6
Testing on test dataset of dataset 6......................
mAP on test set of dataset 6 -->  Img2Txt: 0.2335  Txt2Img: 0.2054
Testing Done...............
Starting preparing dataloader for dataset 7............
Done preparing dataloader for dataset 7
Testing on test dataset of dataset 7......................
mAP on test set of dataset 7 -->  Img2Txt: 0.1583  Txt2Img: 0.1474
Testing Done...............
Starting preparing dataloader for dataset 8............
Done preparing dataloader for dataset 8
Testing on test dataset of dataset 8......................
mAP on test set of dataset 8 -->  Img2Txt: 0.2056  Txt2Img: 0.1839
Testing Done...............
Starting preparing dataloader for dataset 9............
Done preparing dataloader for dataset 9
Testing on test dataset of dataset 9......................
mAP on test set of dataset 9 -->  Img2Txt: 0.2897  Txt2Img: 0.2240
Testing Done...............
Starting preparing dataloader for dataset 10............
Done preparing dataloader for dataset 10
Testing on test dataset of dataset 10......................
mAP on test set of dataset 10 -->  Img2Txt: 0.2935  Txt2Img: 0.2458
Testing Done...............
Starting preparing dataloader for dataset 11............
Done preparing dataloader for dataset 11
Testing on test dataset of dataset 11......................
mAP on test set of dataset 11 -->  Img2Txt: 0.3381  Txt2Img: 0.2792
Testing Done...............
Starting preparing dataloader for dataset 12............
Done preparing dataloader for dataset 12
Testing on test dataset of dataset 12......................
mAP on test set of dataset 12 -->  Img2Txt: 0.1693  Txt2Img: 0.1795
Testing Done...............
Starting preparing dataloader for dataset 13............
Done preparing dataloader for dataset 13
Testing on test dataset of dataset 13......................
mAP on test set of dataset 13 -->  Img2Txt: 0.1357  Txt2Img: 0.1325
Testing Done...............
Starting preparing dataloader for dataset 14............
Done preparing dataloader for dataset 14
Testing on test dataset of dataset 14......................
mAP on test set of dataset 14 -->  Img2Txt: 0.2842  Txt2Img: 0.2120
Testing Done...............
Starting preparing dataloader for dataset 15............
Done preparing dataloader for dataset 15
Testing on test dataset of dataset 15......................
mAP on test set of dataset 15 -->  Img2Txt: 0.1971  Txt2Img: 0.1895
Testing Done...............
Starting preparing dataloader for dataset 16............
Done preparing dataloader for dataset 16
Testing on test dataset of dataset 16......................
mAP on test set of dataset 16 -->  Img2Txt: 0.2012  Txt2Img: 0.1756
Testing Done...............
Starting preparing dataloader for dataset 17............
Done preparing dataloader for dataset 17
Testing on test dataset of dataset 17......................
mAP on test set of dataset 17 -->  Img2Txt: 0.1780  Txt2Img: 0.1513
Testing Done...............
Starting preparing dataloader for dataset 18............
Done preparing dataloader for dataset 18
Testing on test dataset of dataset 18......................
mAP on test set of dataset 18 -->  Img2Txt: 0.2025  Txt2Img: 0.1837
Testing Done...............
Starting preparing dataloader for dataset 19............
Done preparing dataloader for dataset 19
Testing on test dataset of dataset 19......................
mAP on test set of dataset 19 -->  Img2Txt: 0.3236  Txt2Img: 0.2683
Testing Done...............
Starting preparing dataloader for dataset 20............
Done preparing dataloader for dataset 20
Testing on test dataset of dataset 20......................
mAP on test set of dataset 20 -->  Img2Txt: 0.5816  Txt2Img: 0.5355
Testing Done...............
........................Training is completed...............................
.....well!!!! done
